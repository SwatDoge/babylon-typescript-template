(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{14:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var r,n=i(0),o=i(13),a=i(24),s=i(25),c=i(4),h=function(){function t(t,e,i){this.name=t,this.from=e,this.to=i}return t.prototype.clone=function(){return new t(this.name,this.from,this.to)},t}();(function(){function t(t,e,i){this.frame=t,this.action=e,this.onlyOnce=i,this.isDone=!1}t.prototype._clone=function(){return new t(this.frame,this.action,this.onlyOnce)}})(),function(){function t(t){this.path=t,this._onchange=new Array,this.value=0,this.animations=new Array}t.prototype.getPoint=function(){var t=this.path.getPointAtLengthPosition(this.value);return new n.Vector3(t.x,0,t.y)},t.prototype.moveAhead=function(t){return void 0===t&&(t=.002),this.move(t),this},t.prototype.moveBack=function(t){return void 0===t&&(t=.002),this.move(-t),this},t.prototype.move=function(t){if(Math.abs(t)>1)throw"step size should be less than 1.";return this.value+=t,this.ensureLimits(),this.raiseOnChange(),this},t.prototype.ensureLimits=function(){for(;this.value>1;)this.value-=1;for(;this.value<0;)this.value+=1;return this},t.prototype.raiseOnChange=function(){var t=this;return this._onchange.forEach(function(e){return e(t)}),this},t.prototype.onchange=function(t){return this._onchange.push(t),this}}();!function(t){t[t.STEP=1]="STEP"}(r||(r={}));var u=function(){function t(e,i,r,n,o,a){this.name=e,this.targetProperty=i,this.framePerSecond=r,this.dataType=n,this.loopMode=o,this.enableBlending=a,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=i.split("."),this.dataType=n,this.loopMode=void 0===o?t.ANIMATIONLOOPMODE_CYCLE:o}return t._PrepareAnimation=function(e,i,r,o,a,s,c,h){var u=void 0;if(!isNaN(parseFloat(a))&&isFinite(a)?u=t.ANIMATIONTYPE_FLOAT:a instanceof n.Quaternion?u=t.ANIMATIONTYPE_QUATERNION:a instanceof n.Vector3?u=t.ANIMATIONTYPE_VECTOR3:a instanceof n.Vector2?u=t.ANIMATIONTYPE_VECTOR2:a instanceof n.Color3?u=t.ANIMATIONTYPE_COLOR3:a instanceof n.Size&&(u=t.ANIMATIONTYPE_SIZE),null==u)return null;var l=new t(e,i,r,u,c),p=[{frame:0,value:a},{frame:o,value:s}];return l.setKeys(p),void 0!==h&&l.setEasingFunction(h),l},t.CreateAnimation=function(e,i,r,n){var o=new t(e+"Animation",e,r,i,t.ANIMATIONLOOPMODE_CONSTANT);return o.setEasingFunction(n),o},t.CreateAndStartAnimation=function(e,i,r,n,o,a,s,c,h,u){var l=t._PrepareAnimation(e,r,n,o,a,s,c,h);return l?i.getScene().beginDirectAnimation(i,[l],0,o,1===l.loopMode,1,u):null},t.CreateAndStartHierarchyAnimation=function(e,i,r,n,o,a,s,c,h,u,l){var p=t._PrepareAnimation(e,n,o,a,s,c,h,u);return p?i.getScene().beginDirectHierarchyAnimation(i,r,[p],0,a,1===p.loopMode,1,l):null},t.CreateMergeAndStartAnimation=function(e,i,r,n,o,a,s,c,h,u){var l=t._PrepareAnimation(e,r,n,o,a,s,c,h);return l?(i.animations.push(l),i.getScene().beginAnimation(i,0,o,1===l.loopMode,1,u)):null},t.TransitionTo=function(t,e,i,r,n,o,a,s){if(void 0===s&&(s=null),a<=0)return i[t]=e,s&&s(),null;var c=n*(a/1e3);o.setKeys([{frame:0,value:i[t].clone?i[t].clone():i[t]},{frame:c,value:e}]),i.animations||(i.animations=[]),i.animations.push(o);var h=r.beginAnimation(i,0,c,!1);return h.onAnimationEnd=s,h},Object.defineProperty(t.prototype,"runtimeAnimations",{get:function(){return this._runtimeAnimations},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasRunningRuntimeAnimations",{get:function(){for(var t=0,e=this._runtimeAnimations;t<e.length;t++){if(!e[t].isStopped)return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){var e="Name: "+this.name+", property: "+this.targetProperty;if(e+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],e+=", nKeys: "+(this._keys?this._keys.length:"none"),e+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),t){e+=", Ranges: {";var i=!0;for(var r in this._ranges)i&&(e+=", ",i=!1),e+=r;e+="}"}return e},t.prototype.addEvent=function(t){this._events.push(t)},t.prototype.removeEvents=function(t){for(var e=0;e<this._events.length;e++)this._events[e].frame===t&&(this._events.splice(e,1),e--)},t.prototype.getEvents=function(){return this._events},t.prototype.createRange=function(t,e,i){this._ranges[t]||(this._ranges[t]=new h(t,e,i))},t.prototype.deleteRange=function(t,e){void 0===e&&(e=!0);var i=this._ranges[t];if(i){if(e)for(var r=i.from,n=i.to,o=this._keys.length-1;o>=0;o--)this._keys[o].frame>=r&&this._keys[o].frame<=n&&this._keys.splice(o,1);this._ranges[t]=null}},t.prototype.getRange=function(t){return this._ranges[t]},t.prototype.getKeys=function(){return this._keys},t.prototype.getHighestFrame=function(){for(var t=0,e=0,i=this._keys.length;e<i;e++)t<this._keys[e].frame&&(t=this._keys[e].frame);return t},t.prototype.getEasingFunction=function(){return this._easingFunction},t.prototype.setEasingFunction=function(t){this._easingFunction=t},t.prototype.floatInterpolateFunction=function(t,e,i){return o.a.Lerp(t,e,i)},t.prototype.floatInterpolateFunctionWithTangents=function(t,e,i,r,n){return o.a.Hermite(t,e,i,r,n)},t.prototype.quaternionInterpolateFunction=function(t,e,i){return n.Quaternion.Slerp(t,e,i)},t.prototype.quaternionInterpolateFunctionWithTangents=function(t,e,i,r,o){return n.Quaternion.Hermite(t,e,i,r,o).normalize()},t.prototype.vector3InterpolateFunction=function(t,e,i){return n.Vector3.Lerp(t,e,i)},t.prototype.vector3InterpolateFunctionWithTangents=function(t,e,i,r,o){return n.Vector3.Hermite(t,e,i,r,o)},t.prototype.vector2InterpolateFunction=function(t,e,i){return n.Vector2.Lerp(t,e,i)},t.prototype.vector2InterpolateFunctionWithTangents=function(t,e,i,r,o){return n.Vector2.Hermite(t,e,i,r,o)},t.prototype.sizeInterpolateFunction=function(t,e,i){return n.Size.Lerp(t,e,i)},t.prototype.color3InterpolateFunction=function(t,e,i){return n.Color3.Lerp(t,e,i)},t.prototype._getKeyValue=function(t){return"function"==typeof t?t():t},t.prototype._interpolate=function(e,i,n,o,a,s){if(o===t.ANIMATIONLOOPMODE_CONSTANT&&i>0)return s.clone?s.clone():s;var c=this.getKeys(),h=Math.max(0,Math.min(c.length-1,Math.floor(c.length*(e-c[0].frame)/(c[c.length-1].frame-c[0].frame))-1));if(c[h].frame>=e)for(;h-1>=0&&c[h].frame>=e;)h--;for(var u=h;u<c.length;u++){var l=c[u+1];if(l.frame>=e){var p=c[u],_=this._getKeyValue(p.value);if(p.interpolation===r.STEP)return _;var m=this._getKeyValue(l.value),d=void 0!==p.outTangent&&void 0!==l.inTangent,f=l.frame-p.frame,g=(e-p.frame)/f,y=this.getEasingFunction();switch(null!=y&&(g=y.ease(g)),this.dataType){case t.ANIMATIONTYPE_FLOAT:var v=d?this.floatInterpolateFunctionWithTangents(_,p.outTangent*f,m,l.inTangent*f,g):this.floatInterpolateFunction(_,m,g);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return v;case t.ANIMATIONLOOPMODE_RELATIVE:return a*i+v}break;case t.ANIMATIONTYPE_QUATERNION:var b=d?this.quaternionInterpolateFunctionWithTangents(_,p.outTangent.scale(f),m,l.inTangent.scale(f),g):this.quaternionInterpolateFunction(_,m,g);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return b;case t.ANIMATIONLOOPMODE_RELATIVE:return b.addInPlace(a.scale(i))}return b;case t.ANIMATIONTYPE_VECTOR3:var T=d?this.vector3InterpolateFunctionWithTangents(_,p.outTangent.scale(f),m,l.inTangent.scale(f),g):this.vector3InterpolateFunction(_,m,g);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return T;case t.ANIMATIONLOOPMODE_RELATIVE:return T.add(a.scale(i))}case t.ANIMATIONTYPE_VECTOR2:var O=d?this.vector2InterpolateFunctionWithTangents(_,p.outTangent.scale(f),m,l.inTangent.scale(f),g):this.vector2InterpolateFunction(_,m,g);switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return O;case t.ANIMATIONLOOPMODE_RELATIVE:return O.add(a.scale(i))}case t.ANIMATIONTYPE_SIZE:switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(_,m,g);case t.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(_,m,g).add(a.scale(i))}case t.ANIMATIONTYPE_COLOR3:switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:return this.color3InterpolateFunction(_,m,g);case t.ANIMATIONLOOPMODE_RELATIVE:return this.color3InterpolateFunction(_,m,g).add(a.scale(i))}case t.ANIMATIONTYPE_MATRIX:switch(o){case t.ANIMATIONLOOPMODE_CYCLE:case t.ANIMATIONLOOPMODE_CONSTANT:if(t.AllowMatricesInterpolation)return this.matrixInterpolateFunction(_,m,g,n);case t.ANIMATIONLOOPMODE_RELATIVE:return _}}break}}return this._getKeyValue(c[c.length-1].value)},t.prototype.matrixInterpolateFunction=function(e,i,r,o){return t.AllowMatrixDecomposeForInterpolation?o?(n.Matrix.DecomposeLerpToRef(e,i,r,o),o):n.Matrix.DecomposeLerp(e,i,r):o?(n.Matrix.LerpToRef(e,i,r,o),o):n.Matrix.Lerp(e,i,r)},t.prototype.clone=function(){var e=new t(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed,this._keys&&e.setKeys(this._keys),this._ranges)for(var i in e._ranges={},this._ranges){var r=this._ranges[i];r&&(e._ranges[i]=r.clone())}return e},t.prototype.setKeys=function(t){this._keys=t.slice(0)},t.prototype.serialize=function(){var e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode,e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed;var i=this.dataType;e.keys=[];for(var r=this.getKeys(),n=0;n<r.length;n++){var o=r[n],a={};switch(a.frame=o.frame,i){case t.ANIMATIONTYPE_FLOAT:a.values=[o.value];break;case t.ANIMATIONTYPE_QUATERNION:case t.ANIMATIONTYPE_MATRIX:case t.ANIMATIONTYPE_VECTOR3:case t.ANIMATIONTYPE_COLOR3:a.values=o.value.asArray()}e.keys.push(a)}for(var s in e.ranges=[],this._ranges){var c=this._ranges[s];if(c){var h={};h.name=s,h.from=c.from,h.to=c.to,e.ranges.push(h)}}return e},Object.defineProperty(t,"ANIMATIONTYPE_FLOAT",{get:function(){return t._ANIMATIONTYPE_FLOAT},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_VECTOR3",{get:function(){return t._ANIMATIONTYPE_VECTOR3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_VECTOR2",{get:function(){return t._ANIMATIONTYPE_VECTOR2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_SIZE",{get:function(){return t._ANIMATIONTYPE_SIZE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_QUATERNION",{get:function(){return t._ANIMATIONTYPE_QUATERNION},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_MATRIX",{get:function(){return t._ANIMATIONTYPE_MATRIX},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONTYPE_COLOR3",{get:function(){return t._ANIMATIONTYPE_COLOR3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_RELATIVE",{get:function(){return t._ANIMATIONLOOPMODE_RELATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_CYCLE",{get:function(){return t._ANIMATIONLOOPMODE_CYCLE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ANIMATIONLOOPMODE_CONSTANT",{get:function(){return t._ANIMATIONLOOPMODE_CONSTANT},enumerable:!0,configurable:!0}),t._UniversalLerp=function(t,e,i){var r=t.constructor;return r.Lerp?r.Lerp(t,e,i):r.Slerp?r.Slerp(t,e,i):t.toFixed?t*(1-i)+i*e:e},t.Parse=function(e){var i,r,o=new t(e.name,e.property,e.framePerSecond,e.dataType,e.loopBehavior),a=e.dataType,s=[];for(e.enableBlending&&(o.enableBlending=e.enableBlending),e.blendingSpeed&&(o.blendingSpeed=e.blendingSpeed),r=0;r<e.keys.length;r++){var c,h,u=e.keys[r];switch(a){case t.ANIMATIONTYPE_FLOAT:i=u.values[0],u.values.length>=1&&(c=u.values[1]),u.values.length>=2&&(h=u.values[2]);break;case t.ANIMATIONTYPE_QUATERNION:if(i=n.Quaternion.FromArray(u.values),u.values.length>=8){var l=n.Quaternion.FromArray(u.values.slice(4,8));l.equals(n.Quaternion.Zero())||(c=l)}if(u.values.length>=12){var p=n.Quaternion.FromArray(u.values.slice(8,12));p.equals(n.Quaternion.Zero())||(h=p)}break;case t.ANIMATIONTYPE_MATRIX:i=n.Matrix.FromArray(u.values);break;case t.ANIMATIONTYPE_COLOR3:i=n.Color3.FromArray(u.values);break;case t.ANIMATIONTYPE_VECTOR3:default:i=n.Vector3.FromArray(u.values)}var _={};_.frame=u.frame,_.value=i,null!=c&&(_.inTangent=c),null!=h&&(_.outTangent=h),s.push(_)}if(o.setKeys(s),e.ranges)for(r=0;r<e.ranges.length;r++)i=e.ranges[r],o.createRange(i.name,i.from,i.to);return o},t.AppendSerializedAnimations=function(t,e){c.a.AppendSerializedAnimations(t,e)},t.AllowMatricesInterpolation=!1,t.AllowMatrixDecomposeForInterpolation=!0,t._ANIMATIONTYPE_FLOAT=0,t._ANIMATIONTYPE_VECTOR3=1,t._ANIMATIONTYPE_QUATERNION=2,t._ANIMATIONTYPE_MATRIX=3,t._ANIMATIONTYPE_COLOR3=4,t._ANIMATIONTYPE_VECTOR2=5,t._ANIMATIONTYPE_SIZE=6,t._ANIMATIONLOOPMODE_RELATIVE=0,t._ANIMATIONLOOPMODE_CYCLE=1,t._ANIMATIONLOOPMODE_CONSTANT=2,t}();s.a._AnimationParser=u.Parse,a.a._AnimationRangeFactory=function(t,e,i){return new h(t,e,i)}},17:function(t,e,i){"use strict";var r=i(1),n=i(4),o=i(22),a=i(7),s=i(5),c=i(0),h=i(24),u=i(32),l=i(51),p=i(75),_=i(76),m=i(59),d=i(14),f=function(){function t(){this.compensateDistortion=!0}return Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.hResolution/(2*this.vResolution)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aspectRatioFov",{get:function(){return 2*Math.atan(this.postProcessScaleFactor*this.vScreenSize/(2*this.eyeToScreenDistance))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftHMatrix",{get:function(){var t=4*(this.hScreenSize/4-this.lensSeparationDistance/2)/this.hScreenSize;return c.Matrix.Translation(t,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightHMatrix",{get:function(){var t=4*(this.hScreenSize/4-this.lensSeparationDistance/2)/this.hScreenSize;return c.Matrix.Translation(-t,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftPreViewMatrix",{get:function(){return c.Matrix.Translation(.5*this.interpupillaryDistance,0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightPreViewMatrix",{get:function(){return c.Matrix.Translation(-.5*this.interpupillaryDistance,0,0)},enumerable:!0,configurable:!0}),t.GetDefault=function(){var e=new t;return e.hResolution=1280,e.vResolution=800,e.hScreenSize=.149759993,e.vScreenSize=.0935999975,e.vScreenCenter=.0467999987,e.eyeToScreenDistance=.0410000011,e.lensSeparationDistance=.063500002,e.interpupillaryDistance=.064000003,e.distortionK=[1,.219999999,.239999995,0],e.chromaAbCorrection=[.995999992,-.00400000019,1.01400006,0],e.postProcessScaleFactor=1.714605507808412,e.lensCenterOffset=.151976421,e},t}(),g=i(9);i.d(e,"a",function(){return y});var y=function(t){function e(i,r,n,a){void 0===a&&(a=!0);var h=t.call(this,i,n)||this;return h.upVector=c.Vector3.Up(),h.orthoLeft=null,h.orthoRight=null,h.orthoBottom=null,h.orthoTop=null,h.fov=.8,h.minZ=1,h.maxZ=1e4,h.inertia=.9,h.mode=e.PERSPECTIVE_CAMERA,h.isIntermediate=!1,h.viewport=new c.Viewport(0,0,1,1),h.layerMask=268435455,h.fovMode=e.FOVMODE_VERTICAL_FIXED,h.cameraRigMode=e.RIG_MODE_NONE,h.customRenderTargets=new Array,h.outputRenderTarget=null,h.onViewMatrixChangedObservable=new s.a,h.onProjectionMatrixChangedObservable=new s.a,h.onAfterCheckInputsObservable=new s.a,h.onRestoreStateObservable=new s.a,h._rigCameras=new Array,h._webvrViewMatrix=c.Matrix.Identity(),h._skipRendering=!1,h._projectionMatrix=new c.Matrix,h._postProcesses=new Array,h._activeMeshes=new o.a(256),h._globalPosition=c.Vector3.Zero(),h._computedViewMatrix=c.Matrix.Identity(),h._doNotComputeProjectionMatrix=!1,h._transformMatrix=c.Matrix.Zero(),h._refreshFrustumPlanes=!0,h._isCamera=!0,h.getScene().addCamera(h),a&&!h.getScene().activeCamera&&(h.getScene().activeCamera=h),h.position=r,h}return r.c(e,t),e.prototype.storeState=function(){return this._stateStored=!0,this._storedFov=this.fov,this},e.prototype._restoreStateValues=function(){return!!this._stateStored&&(this.fov=this._storedFov,!0)},e.prototype.restoreState=function(){return!!this._restoreStateValues()&&(this.onRestoreStateObservable.notifyObservers(this),!0)},e.prototype.getClassName=function(){return"Camera"},e.prototype.toString=function(t){var e="Name: "+this.name;if(e+=", type: "+this.getClassName(),this.animations)for(var i=0;i<this.animations.length;i++)e+=", animation[0]: "+this.animations[i].toString(t);return e},Object.defineProperty(e.prototype,"globalPosition",{get:function(){return this._globalPosition},enumerable:!0,configurable:!0}),e.prototype.getActiveMeshes=function(){return this._activeMeshes},e.prototype.isActiveMesh=function(t){return-1!==this._activeMeshes.indexOf(t)},e.prototype.isReady=function(e){if(void 0===e&&(e=!1),e)for(var i=0,r=this._postProcesses;i<r.length;i++){var n=r[i];if(n&&!n.isReady())return!1}return t.prototype.isReady.call(this,e)},e.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.position=new c.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new c.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0},e.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)},e.prototype._isSynchronized=function(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()},e.prototype._isSynchronizedViewMatrix=function(){return!!t.prototype._isSynchronized.call(this)&&(this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent())},e.prototype._isSynchronizedProjectionMatrix=function(){var t=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!t)return!1;var i=this.getEngine();return t=this.mode===e.PERSPECTIVE_CAMERA?this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===i.getAspectRatio(this):this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===i.getRenderWidth()&&this._cache.renderHeight===i.getRenderHeight()},e.prototype.attachControl=function(t,e){},e.prototype.detachControl=function(t){},e.prototype.update=function(){this._checkInputs(),this.cameraRigMode!==e.RIG_MODE_NONE&&this._updateRigCameras()},e.prototype._checkInputs=function(){this.onAfterCheckInputsObservable.notifyObservers(this)},Object.defineProperty(e.prototype,"rigCameras",{get:function(){return this._rigCameras},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rigPostProcess",{get:function(){return this._rigPostProcess},enumerable:!0,configurable:!0}),e.prototype._getFirstPostProcess=function(){for(var t=0;t<this._postProcesses.length;t++)if(null!==this._postProcesses[t])return this._postProcesses[t];return null},e.prototype._cascadePostProcessesToRigCams=function(){var t=this._getFirstPostProcess();t&&t.markTextureDirty();for(var e=0,i=this._rigCameras.length;e<i;e++){var r=this._rigCameras[e],n=r._rigPostProcess;if(n)n instanceof l.a&&(r.isIntermediate=0===this._postProcesses.length),r._postProcesses=this._postProcesses.slice(0).concat(n),n.markTextureDirty();else r._postProcesses=this._postProcesses.slice(0)}},e.prototype.attachPostProcess=function(t,e){return void 0===e&&(e=null),!t.isReusable()&&this._postProcesses.indexOf(t)>-1?(g.a.Error("You're trying to reuse a post process not defined as reusable."),0):(null==e||e<0?this._postProcesses.push(t):null===this._postProcesses[e]?this._postProcesses[e]=t:this._postProcesses.splice(e,0,t),this._cascadePostProcessesToRigCams(),this._postProcesses.indexOf(t))},e.prototype.detachPostProcess=function(t){var e=this._postProcesses.indexOf(t);-1!==e&&(this._postProcesses[e]=null),this._cascadePostProcessesToRigCams()},e.prototype.getWorldMatrix=function(){return this._isSynchronizedViewMatrix()?this._worldMatrix:(this.getViewMatrix(),this._worldMatrix)},e.prototype._getViewMatrix=function(){return c.Matrix.Identity()},e.prototype.getViewMatrix=function(t){return!t&&this._isSynchronizedViewMatrix()?this._computedViewMatrix:(this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childRenderId=this._currentRenderId,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix),this._computedViewMatrix)},e.prototype.freezeProjectionMatrix=function(t){this._doNotComputeProjectionMatrix=!0,void 0!==t&&(this._projectionMatrix=t)},e.prototype.unfreezeProjectionMatrix=function(){this._doNotComputeProjectionMatrix=!1},e.prototype.getProjectionMatrix=function(t){if(this._doNotComputeProjectionMatrix||!t&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;var i=this.getEngine(),r=this.getScene();if(this.mode===e.PERSPECTIVE_CAMERA)this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=i.getAspectRatio(this),this.minZ<=0&&(this.minZ=.1),r.useRightHandedSystem?c.Matrix.PerspectiveFovRHToRef(this.fov,i.getAspectRatio(this),this.minZ,this.maxZ,this._projectionMatrix,this.fovMode===e.FOVMODE_VERTICAL_FIXED):c.Matrix.PerspectiveFovLHToRef(this.fov,i.getAspectRatio(this),this.minZ,this.maxZ,this._projectionMatrix,this.fovMode===e.FOVMODE_VERTICAL_FIXED);else{var n=i.getRenderWidth()/2,o=i.getRenderHeight()/2;r.useRightHandedSystem?c.Matrix.OrthoOffCenterRHToRef(this.orthoLeft||-n,this.orthoRight||n,this.orthoBottom||-o,this.orthoTop||o,this.minZ,this.maxZ,this._projectionMatrix):c.Matrix.OrthoOffCenterLHToRef(this.orthoLeft||-n,this.orthoRight||n,this.orthoBottom||-o,this.orthoTop||o,this.minZ,this.maxZ,this._projectionMatrix),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.renderWidth=i.getRenderWidth(),this._cache.renderHeight=i.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix},e.prototype.getTransformationMatrix=function(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix},e.prototype._updateFrustumPlanes=function(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?c.Frustum.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=c.Frustum.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)},e.prototype.isInFrustum=function(t){return this._updateFrustumPlanes(),t.isInFrustum(this._frustumPlanes)},e.prototype.isCompletelyInFrustum=function(t){return this._updateFrustumPlanes(),t.isCompletelyInFrustum(this._frustumPlanes)},e.prototype.getForwardRay=function(t,e,i){void 0===t&&(t=100),e||(e=this.getWorldMatrix()),i||(i=this.position);var r=this._scene.useRightHandedSystem?new c.Vector3(0,0,-1):new c.Vector3(0,0,1),n=c.Vector3.TransformNormal(r,e),o=c.Vector3.Normalize(n);return new u.a(i,o,t)},e.prototype.dispose=function(i,r){for(void 0===r&&(r=!1),this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){var n=this._rigCameras.pop();n&&n.dispose()}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses=[];else if(this.cameraRigMode!==e.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses=[];else for(var o=this._postProcesses.length;--o>=0;){var a=this._postProcesses[o];a&&a.dispose(this)}for(o=this.customRenderTargets.length;--o>=0;)this.customRenderTargets[o].dispose();this.customRenderTargets=[],this._activeMeshes.dispose(),t.prototype.dispose.call(this,i,r)},Object.defineProperty(e.prototype,"leftCamera",{get:function(){return this._rigCameras.length<1?null:this._rigCameras[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightCamera",{get:function(){return this._rigCameras.length<2?null:this._rigCameras[1]},enumerable:!0,configurable:!0}),e.prototype.getLeftTarget=function(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()},e.prototype.getRightTarget=function(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()},e.prototype.setCameraRigMode=function(t,i){if(this.cameraRigMode!==t){for(;this._rigCameras.length>0;){var r=this._rigCameras.pop();r&&r.dispose()}if(this.cameraRigMode=t,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=i.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=a.c.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==e.RIG_MODE_NONE){var n=this.createRigCamera(this.name+"_L",0),o=this.createRigCamera(this.name+"_R",1);n&&o&&(this._rigCameras.push(n),this._rigCameras.push(o))}switch(this.cameraRigMode){case e.RIG_MODE_STEREOSCOPIC_ANAGLYPH:this._rigCameras[0]._rigPostProcess=new l.a(this.name+"_passthru",1,this._rigCameras[0]),this._rigCameras[1]._rigPostProcess=new p.a(this.name+"_anaglyph",1,this._rigCameras);break;case e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case e.RIG_MODE_STEREOSCOPIC_OVERUNDER:var s=this.cameraRigMode===e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL||this.cameraRigMode===e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED;this._rigCameras[0]._rigPostProcess=new l.a(this.name+"_passthru",1,this._rigCameras[0]),this._rigCameras[1]._rigPostProcess=new _.a(this.name+"_stereoInterlace",this._rigCameras,s);break;case e.RIG_MODE_VR:var h=i.vrCameraMetrics||f.GetDefault();this._rigCameras[0]._cameraRigParams.vrMetrics=h,this._rigCameras[0].viewport=new c.Viewport(0,0,.5,1),this._rigCameras[0]._cameraRigParams.vrWorkMatrix=new c.Matrix,this._rigCameras[0]._cameraRigParams.vrHMatrix=h.leftHMatrix,this._rigCameras[0]._cameraRigParams.vrPreViewMatrix=h.leftPreViewMatrix,this._rigCameras[0].getProjectionMatrix=this._rigCameras[0]._getVRProjectionMatrix,this._rigCameras[1]._cameraRigParams.vrMetrics=h,this._rigCameras[1].viewport=new c.Viewport(.5,0,.5,1),this._rigCameras[1]._cameraRigParams.vrWorkMatrix=new c.Matrix,this._rigCameras[1]._cameraRigParams.vrHMatrix=h.rightHMatrix,this._rigCameras[1]._cameraRigParams.vrPreViewMatrix=h.rightPreViewMatrix,this._rigCameras[1].getProjectionMatrix=this._rigCameras[1]._getVRProjectionMatrix,h.compensateDistortion&&(this._rigCameras[0]._rigPostProcess=new m.a("VR_Distort_Compensation_Left",this._rigCameras[0],!1,h),this._rigCameras[1]._rigPostProcess=new m.a("VR_Distort_Compensation_Right",this._rigCameras[1],!0,h));break;case e.RIG_MODE_WEBVR:if(i.vrDisplay){var u=i.vrDisplay.getEyeParameters("left"),d=i.vrDisplay.getEyeParameters("right");this._rigCameras[0].viewport=new c.Viewport(0,0,.5,1),this._rigCameras[0].setCameraRigParameter("left",!0),this._rigCameras[0].setCameraRigParameter("specs",i.specs),this._rigCameras[0].setCameraRigParameter("eyeParameters",u),this._rigCameras[0].setCameraRigParameter("frameData",i.frameData),this._rigCameras[0].setCameraRigParameter("parentCamera",i.parentCamera),this._rigCameras[0]._cameraRigParams.vrWorkMatrix=new c.Matrix,this._rigCameras[0].getProjectionMatrix=this._getWebVRProjectionMatrix,this._rigCameras[0].parent=this,this._rigCameras[0]._getViewMatrix=this._getWebVRViewMatrix,this._rigCameras[1].viewport=new c.Viewport(.5,0,.5,1),this._rigCameras[1].setCameraRigParameter("eyeParameters",d),this._rigCameras[1].setCameraRigParameter("specs",i.specs),this._rigCameras[1].setCameraRigParameter("frameData",i.frameData),this._rigCameras[1].setCameraRigParameter("parentCamera",i.parentCamera),this._rigCameras[1]._cameraRigParams.vrWorkMatrix=new c.Matrix,this._rigCameras[1].getProjectionMatrix=this._getWebVRProjectionMatrix,this._rigCameras[1].parent=this,this._rigCameras[1]._getViewMatrix=this._getWebVRViewMatrix,e.UseAlternateWebVRRendering&&(this._rigCameras[1]._skipRendering=!0,this._rigCameras[0]._alternateCamera=this._rigCameras[1])}}this._cascadePostProcessesToRigCams(),this.update()}},e.prototype._getVRProjectionMatrix=function(){return c.Matrix.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix},e.prototype._updateCameraRotationMatrix=function(){},e.prototype._updateWebVRCameraRotationMatrix=function(){},e.prototype._getWebVRProjectionMatrix=function(){return c.Matrix.Identity()},e.prototype._getWebVRViewMatrix=function(){return c.Matrix.Identity()},e.prototype.setCameraRigParameter=function(t,e){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[t]=e,"interaxialDistance"===t&&(this._cameraRigParams.stereoHalfAngle=a.c.ToRadians(e/.0637))},e.prototype.createRigCamera=function(t,e){return null},e.prototype._updateRigCameras=function(){for(var t=0;t<this._rigCameras.length;t++)this._rigCameras[t].minZ=this.minZ,this._rigCameras[t].maxZ=this.maxZ,this._rigCameras[t].fov=this.fov,this._rigCameras[t].upVector.copyFrom(this.upVector);this.cameraRigMode===e.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)},e.prototype._setupInputs=function(){},e.prototype.serialize=function(){var t=n.a.Serialize(this);return t.type=this.getClassName(),this.parent&&(t.parentId=this.parent.id),this.inputs&&this.inputs.serialize(t),n.a.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t},e.prototype.clone=function(t){return n.a.Clone(e.GetConstructorFromName(this.getClassName(),t,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this)},e.prototype.getDirection=function(t){var e=c.Vector3.Zero();return this.getDirectionToRef(t,e),e},e.prototype.getDirectionToRef=function(t,e){c.Vector3.TransformNormalToRef(t,this.getWorldMatrix(),e)},e.GetConstructorFromName=function(t,i,r,n,o){void 0===n&&(n=0),void 0===o&&(o=!0);var a=h.a.Construct(t,i,r,{interaxial_distance:n,isStereoscopicSideBySide:o});return a||function(){return e._createDefaultParsedCamera(i,r)}},e.prototype.computeWorldMatrix=function(){return this.getWorldMatrix()},e.Parse=function(t,i){var r=t.type,o=e.GetConstructorFromName(r,t.name,i,t.interaxial_distance,t.isStereoscopicSideBySide),a=n.a.Parse(o,t,i);if(t.parentId&&(a._waitingParentId=t.parentId),a.inputs&&(a.inputs.parse(t),a._setupInputs()),a.setPosition&&(a.position.copyFromFloats(0,0,0),a.setPosition(c.Vector3.FromArray(t.position))),t.target&&a.setTarget&&a.setTarget(c.Vector3.FromArray(t.target)),t.cameraRigMode){var s=t.interaxial_distance?{interaxialDistance:t.interaxial_distance}:{};a.setCameraRigMode(t.cameraRigMode,s)}if(t.animations){for(var u=0;u<t.animations.length;u++){var l=t.animations[u];a.animations.push(d.a.Parse(l))}h.a.ParseAnimationRanges(a,t,i)}return t.autoAnimate&&i.beginAnimation(a,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),a},e._createDefaultParsedCamera=function(t,e){throw"UniversalCamera needs to be imported before deserialization can create a default camera."},e.PERSPECTIVE_CAMERA=0,e.ORTHOGRAPHIC_CAMERA=1,e.FOVMODE_VERTICAL_FIXED=0,e.FOVMODE_HORIZONTAL_FIXED=1,e.RIG_MODE_NONE=0,e.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,e.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,e.RIG_MODE_VR=20,e.RIG_MODE_WEBVR=21,e.RIG_MODE_CUSTOM=22,e.ForceAttachControlToAlwaysPreventDefault=!1,e.UseAlternateWebVRRendering=!1,r.b([Object(n.k)()],e.prototype,"position",void 0),r.b([Object(n.k)()],e.prototype,"upVector",void 0),r.b([Object(n.c)()],e.prototype,"orthoLeft",void 0),r.b([Object(n.c)()],e.prototype,"orthoRight",void 0),r.b([Object(n.c)()],e.prototype,"orthoBottom",void 0),r.b([Object(n.c)()],e.prototype,"orthoTop",void 0),r.b([Object(n.c)()],e.prototype,"fov",void 0),r.b([Object(n.c)()],e.prototype,"minZ",void 0),r.b([Object(n.c)()],e.prototype,"maxZ",void 0),r.b([Object(n.c)()],e.prototype,"inertia",void 0),r.b([Object(n.c)()],e.prototype,"mode",void 0),r.b([Object(n.c)()],e.prototype,"layerMask",void 0),r.b([Object(n.c)()],e.prototype,"fovMode",void 0),r.b([Object(n.c)()],e.prototype,"cameraRigMode",void 0),r.b([Object(n.c)()],e.prototype,"interaxialDistance",void 0),r.b([Object(n.c)()],e.prototype,"isStereoscopicSideBySide",void 0),e}(h.a)},28:function(t,e,i){"use strict";var r=i(21),n=i(0),o=i(3),a=function(){function t(t,e,i){this.vectors=r.a.BuildArray(8,n.Vector3.Zero),this.center=n.Vector3.Zero(),this.centerWorld=n.Vector3.Zero(),this.extendSize=n.Vector3.Zero(),this.extendSizeWorld=n.Vector3.Zero(),this.directions=r.a.BuildArray(3,n.Vector3.Zero),this.vectorsWorld=r.a.BuildArray(8,n.Vector3.Zero),this.minimumWorld=n.Vector3.Zero(),this.maximumWorld=n.Vector3.Zero(),this.minimum=n.Vector3.Zero(),this.maximum=n.Vector3.Zero(),this.reConstruct(t,e,i)}return t.prototype.reConstruct=function(t,e,i){var r=t.x,o=t.y,a=t.z,s=e.x,c=e.y,h=e.z,u=this.vectors;this.minimum.copyFromFloats(r,o,a),this.maximum.copyFromFloats(s,c,h),u[0].copyFromFloats(r,o,a),u[1].copyFromFloats(s,c,h),u[2].copyFromFloats(s,o,a),u[3].copyFromFloats(r,c,a),u[4].copyFromFloats(r,o,h),u[5].copyFromFloats(s,c,a),u[6].copyFromFloats(r,c,h),u[7].copyFromFloats(s,o,h),e.addToRef(t,this.center).scaleInPlace(.5),e.subtractToRef(t,this.extendSize).scaleInPlace(.5),this._update(i||n.Matrix.IdentityReadOnly)},t.prototype.scale=function(e){var i=t.TmpVector3,r=this.maximum.subtractToRef(this.minimum,i[0]),n=r.length();r.normalizeFromLength(n);var o=n*e,a=r.scaleInPlace(.5*o),s=this.center.subtractToRef(a,i[1]),c=this.center.addToRef(a,i[2]);return this.reConstruct(s,c,this._worldMatrix),this},t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(t){var e=this.minimumWorld,i=this.maximumWorld,r=this.directions,o=this.vectorsWorld,a=this.vectors;if(t.isIdentity()){e.copyFrom(this.minimum),i.copyFrom(this.maximum);for(s=0;s<8;++s)o[s].copyFrom(a[s]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{e.setAll(Number.MAX_VALUE),i.setAll(-Number.MAX_VALUE);for(var s=0;s<8;++s){var c=o[s];n.Vector3.TransformCoordinatesToRef(a[s],t,c),e.minimizeInPlace(c),i.maximizeInPlace(c)}i.subtractToRef(e,this.extendSizeWorld).scaleInPlace(.5),i.addToRef(e,this.centerWorld).scaleInPlace(.5)}n.Vector3.FromArrayToRef(t.m,0,r[0]),n.Vector3.FromArrayToRef(t.m,4,r[1]),n.Vector3.FromArrayToRef(t.m,8,r[2]),this._worldMatrix=t},t.prototype.isInFrustum=function(e){return t.IsInFrustum(this.vectorsWorld,e)},t.prototype.isCompletelyInFrustum=function(e){return t.IsCompletelyInFrustum(this.vectorsWorld,e)},t.prototype.intersectsPoint=function(t){var e=this.minimumWorld,i=this.maximumWorld,r=e.x,o=e.y,a=e.z,s=i.x,c=i.y,h=i.z,u=t.x,l=t.y,p=t.z,_=-n.Epsilon;return!(s-u<_||_>u-r)&&(!(c-l<_||_>l-o)&&!(h-p<_||_>p-a))},t.prototype.intersectsSphere=function(e){return t.IntersectsSphere(this.minimumWorld,this.maximumWorld,e.centerWorld,e.radiusWorld)},t.prototype.intersectsMinMax=function(t,e){var i=this.minimumWorld,r=this.maximumWorld,n=i.x,o=i.y,a=i.z,s=r.x,c=r.y,h=r.z,u=t.x,l=t.y,p=t.z,_=e.x,m=e.y,d=e.z;return!(s<u||n>_)&&(!(c<l||o>m)&&!(h<p||a>d))},t.Intersects=function(t,e){return t.intersectsMinMax(e.minimumWorld,e.maximumWorld)},t.IntersectsSphere=function(e,i,r,o){var a=t.TmpVector3[0];return n.Vector3.ClampToRef(r,e,i,a),n.Vector3.DistanceSquared(r,a)<=o*o},t.IsCompletelyInFrustum=function(t,e){for(var i=0;i<6;++i)for(var r=e[i],n=0;n<8;++n)if(r.dotCoordinate(t[n])<0)return!1;return!0},t.IsInFrustum=function(t,e){for(var i=0;i<6;++i){for(var r=!0,n=e[i],o=0;o<8;++o)if(n.dotCoordinate(t[o])>=0){r=!1;break}if(r)return!1}return!0},t.TmpVector3=r.a.BuildArray(3,n.Vector3.Zero),t}(),s=function(){function t(t,e,i){this.center=n.Vector3.Zero(),this.centerWorld=n.Vector3.Zero(),this.minimum=n.Vector3.Zero(),this.maximum=n.Vector3.Zero(),this.reConstruct(t,e,i)}return t.prototype.reConstruct=function(t,e,i){this.minimum.copyFrom(t),this.maximum.copyFrom(e);var r=n.Vector3.Distance(t,e);e.addToRef(t,this.center).scaleInPlace(.5),this.radius=.5*r,this._update(i||n.Matrix.IdentityReadOnly)},t.prototype.scale=function(e){var i=this.radius*e,r=t.TmpVector3,n=r[0].setAll(i),o=this.center.subtractToRef(n,r[1]),a=this.center.addToRef(n,r[2]);return this.reConstruct(o,a,this._worldMatrix),this},t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(e){if(e.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{n.Vector3.TransformCoordinatesToRef(this.center,e,this.centerWorld);var i=t.TmpVector3[0];n.Vector3.TransformNormalFromFloatsToRef(1,1,1,e,i),this.radiusWorld=Math.max(Math.abs(i.x),Math.abs(i.y),Math.abs(i.z))*this.radius}},t.prototype.isInFrustum=function(t){for(var e=this.centerWorld,i=this.radiusWorld,r=0;r<6;r++)if(t[r].dotCoordinate(e)<=-i)return!1;return!0},t.prototype.isCenterInFrustum=function(t){for(var e=this.centerWorld,i=0;i<6;i++)if(t[i].dotCoordinate(e)<0)return!1;return!0},t.prototype.intersectsPoint=function(t){var e=n.Vector3.DistanceSquared(this.centerWorld,t);return!(this.radiusWorld*this.radiusWorld<e)},t.Intersects=function(t,e){var i=n.Vector3.DistanceSquared(t.centerWorld,e.centerWorld),r=t.radiusWorld+e.radiusWorld;return!(r*r<i)},t.TmpVector3=r.a.BuildArray(3,n.Vector3.Zero),t}();i.d(e,"a",function(){return p});var c={min:0,max:0},h={min:0,max:0},u=function(t,e,i){var r=n.Vector3.Dot(e.centerWorld,t),o=Math.abs(n.Vector3.Dot(e.directions[0],t))*e.extendSize.x+Math.abs(n.Vector3.Dot(e.directions[1],t))*e.extendSize.y+Math.abs(n.Vector3.Dot(e.directions[2],t))*e.extendSize.z;i.min=r-o,i.max=r+o},l=function(t,e,i){return u(t,e,c),u(t,i,h),!(c.min>h.max||h.min>c.max)},p=function(){function t(t,e,i){this._isLocked=!1,this.boundingBox=new a(t,e,i),this.boundingSphere=new s(t,e,i)}return t.prototype.reConstruct=function(t,e,i){this.boundingBox.reConstruct(t,e,i),this.boundingSphere.reConstruct(t,e,i)},Object.defineProperty(t.prototype,"minimum",{get:function(){return this.boundingBox.minimum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this.boundingBox.maximum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLocked",{get:function(){return this._isLocked},set:function(t){this._isLocked=t},enumerable:!0,configurable:!0}),t.prototype.update=function(t){this._isLocked||(this.boundingBox._update(t),this.boundingSphere._update(t))},t.prototype.centerOn=function(e,i){var r=t.TmpVector3[0].copyFrom(e).subtractInPlace(i),n=t.TmpVector3[1].copyFrom(e).addInPlace(i);return this.boundingBox.reConstruct(r,n,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(r,n,this.boundingBox.getWorldMatrix()),this},t.prototype.scale=function(t){return this.boundingBox.scale(t),this.boundingSphere.scale(t),this},t.prototype.isInFrustum=function(t,e){return void 0===e&&(e=o.a.MESHES_CULLINGSTRATEGY_STANDARD),!(e!==o.a.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION&&e!==o.a.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY||!this.boundingSphere.isCenterInFrustum(t))||!!this.boundingSphere.isInFrustum(t)&&(!(e!==o.a.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY&&e!==o.a.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY)||this.boundingBox.isInFrustum(t))},Object.defineProperty(t.prototype,"diagonalLength",{get:function(){var e=this.boundingBox;return e.maximumWorld.subtractToRef(e.minimumWorld,t.TmpVector3[0]).length()},enumerable:!0,configurable:!0}),t.prototype.isCompletelyInFrustum=function(t){return this.boundingBox.isCompletelyInFrustum(t)},t.prototype._checkCollision=function(t){return t._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)},t.prototype.intersectsPoint=function(t){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(t)&&!!this.boundingBox.intersectsPoint(t))},t.prototype.intersects=function(t,e){if(!s.Intersects(this.boundingSphere,t.boundingSphere))return!1;if(!a.Intersects(this.boundingBox,t.boundingBox))return!1;if(!e)return!0;var i=this.boundingBox,r=t.boundingBox;return!!l(i.directions[0],i,r)&&(!!l(i.directions[1],i,r)&&(!!l(i.directions[2],i,r)&&(!!l(r.directions[0],i,r)&&(!!l(r.directions[1],i,r)&&(!!l(r.directions[2],i,r)&&(!!l(n.Vector3.Cross(i.directions[0],r.directions[0]),i,r)&&(!!l(n.Vector3.Cross(i.directions[0],r.directions[1]),i,r)&&(!!l(n.Vector3.Cross(i.directions[0],r.directions[2]),i,r)&&(!!l(n.Vector3.Cross(i.directions[1],r.directions[0]),i,r)&&(!!l(n.Vector3.Cross(i.directions[1],r.directions[1]),i,r)&&(!!l(n.Vector3.Cross(i.directions[1],r.directions[2]),i,r)&&(!!l(n.Vector3.Cross(i.directions[2],r.directions[0]),i,r)&&(!!l(n.Vector3.Cross(i.directions[2],r.directions[1]),i,r)&&!!l(n.Vector3.Cross(i.directions[2],r.directions[2]),i,r))))))))))))))},t.TmpVector3=r.a.BuildArray(2,n.Vector3.Zero),t}()},29:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var r=function(){function t(t,e,i,r,n,o){this.source=t,this.pointerX=e,this.pointerY=i,this.meshUnderPointer=r,this.sourceEvent=n,this.additionalData=o}return t.CreateNew=function(e,i,r){var n=e.getScene();return new t(e,n.pointerX,n.pointerY,n.meshUnderPointer,i,r)},t.CreateNewFromSprite=function(e,i,r,n){return new t(e,i.pointerX,i.pointerY,i.meshUnderPointer,r,n)},t.CreateNewFromScene=function(e,i){return new t(null,e.pointerX,e.pointerY,e.meshUnderPointer,i)},t.CreateNewFromPrimitive=function(e,i,r,n){return new t(e,i.x,i.y,null,r,n)},t}()},32:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var r=i(21),n=i(0),o=i(45),a=function(){function t(t,e,i){void 0===i&&(i=Number.MAX_VALUE),this.origin=t,this.direction=e,this.length=i}return t.prototype.intersectsBoxMinMax=function(e,i,r){void 0===r&&(r=0);var n,o,a,s,c=t.TmpVector3[0].copyFromFloats(e.x-r,e.y-r,e.z-r),h=t.TmpVector3[1].copyFromFloats(i.x+r,i.y+r,i.z+r),u=0,l=Number.MAX_VALUE;if(Math.abs(this.direction.x)<1e-7){if(this.origin.x<c.x||this.origin.x>h.x)return!1}else if(n=1/this.direction.x,o=(c.x-this.origin.x)*n,(a=(h.x-this.origin.x)*n)===-1/0&&(a=1/0),o>a&&(s=o,o=a,a=s),(u=Math.max(o,u))>(l=Math.min(a,l)))return!1;if(Math.abs(this.direction.y)<1e-7){if(this.origin.y<c.y||this.origin.y>h.y)return!1}else if(n=1/this.direction.y,o=(c.y-this.origin.y)*n,(a=(h.y-this.origin.y)*n)===-1/0&&(a=1/0),o>a&&(s=o,o=a,a=s),(u=Math.max(o,u))>(l=Math.min(a,l)))return!1;if(Math.abs(this.direction.z)<1e-7){if(this.origin.z<c.z||this.origin.z>h.z)return!1}else if(n=1/this.direction.z,o=(c.z-this.origin.z)*n,(a=(h.z-this.origin.z)*n)===-1/0&&(a=1/0),o>a&&(s=o,o=a,a=s),(u=Math.max(o,u))>(l=Math.min(a,l)))return!1;return!0},t.prototype.intersectsBox=function(t,e){return void 0===e&&(e=0),this.intersectsBoxMinMax(t.minimum,t.maximum,e)},t.prototype.intersectsSphere=function(t,e){void 0===e&&(e=0);var i=t.center.x-this.origin.x,r=t.center.y-this.origin.y,n=t.center.z-this.origin.z,o=i*i+r*r+n*n,a=t.radius+e,s=a*a;if(o<=s)return!0;var c=i*this.direction.x+r*this.direction.y+n*this.direction.z;return!(c<0)&&o-c*c<=s},t.prototype.intersectsTriangle=function(e,i,r){var a=t.TmpVector3[0],s=t.TmpVector3[1],c=t.TmpVector3[2],h=t.TmpVector3[3],u=t.TmpVector3[4];i.subtractToRef(e,a),r.subtractToRef(e,s),n.Vector3.CrossToRef(this.direction,s,c);var l=n.Vector3.Dot(a,c);if(0===l)return null;var p=1/l;this.origin.subtractToRef(e,h);var _=n.Vector3.Dot(h,c)*p;if(_<0||_>1)return null;n.Vector3.CrossToRef(h,a,u);var m=n.Vector3.Dot(this.direction,u)*p;if(m<0||_+m>1)return null;var d=n.Vector3.Dot(s,u)*p;return d>this.length?null:new o.a(_,m,d)},t.prototype.intersectsPlane=function(t){var e,i=n.Vector3.Dot(t.normal,this.direction);if(Math.abs(i)<9.99999997475243e-7)return null;var r=n.Vector3.Dot(t.normal,this.origin);return(e=(-t.d-r)/i)<0?e<-9.99999997475243e-7?null:0:e},t.prototype.intersectsMesh=function(e,i){var r=n.Tmp.Matrix[0];return e.getWorldMatrix().invertToRef(r),this._tmpRay?t.TransformToRef(this,r,this._tmpRay):this._tmpRay=t.Transform(this,r),e.intersects(this._tmpRay,i)},t.prototype.intersectsMeshes=function(t,e,i){i?i.length=0:i=[];for(var r=0;r<t.length;r++){var n=this.intersectsMesh(t[r],e);n.hit&&i.push(n)}return i.sort(this._comparePickingInfo),i},t.prototype._comparePickingInfo=function(t,e){return t.distance<e.distance?-1:t.distance>e.distance?1:0},t.prototype.intersectionSegment=function(e,i,r){var o=this.origin,a=n.Tmp.Vector3[0],s=n.Tmp.Vector3[1],c=n.Tmp.Vector3[2],h=n.Tmp.Vector3[3];i.subtractToRef(e,a),this.direction.scaleToRef(t.rayl,c),o.addToRef(c,s),e.subtractToRef(o,h);var u,l,p,_,m=n.Vector3.Dot(a,a),d=n.Vector3.Dot(a,c),f=n.Vector3.Dot(c,c),g=n.Vector3.Dot(a,h),y=n.Vector3.Dot(c,h),v=m*f-d*d,b=v,T=v;v<t.smallnum?(l=0,b=1,_=y,T=f):(_=m*y-d*g,(l=d*y-f*g)<0?(l=0,_=y,T=f):l>b&&(l=b,_=y+d,T=f)),_<0?(_=0,-g<0?l=0:-g>m?l=b:(l=-g,b=m)):_>T&&(_=T,-g+d<0?l=0:-g+d>m?l=b:(l=-g+d,b=m)),u=Math.abs(l)<t.smallnum?0:l/b,p=Math.abs(_)<t.smallnum?0:_/T;var O=n.Tmp.Vector3[4];c.scaleToRef(p,O);var P=n.Tmp.Vector3[5];a.scaleToRef(u,P),P.addInPlace(h);var A=n.Tmp.Vector3[6];return P.subtractToRef(O,A),p>0&&p<=this.length&&A.lengthSquared()<r*r?P.length():-1},t.prototype.update=function(t,e,i,r,n,o,a){return this.unprojectRayToRef(t,e,i,r,n,o,a),this},t.Zero=function(){return new t(n.Vector3.Zero(),n.Vector3.Zero())},t.CreateNew=function(e,i,r,n,o,a,s){return t.Zero().update(e,i,r,n,o,a,s)},t.CreateNewFromTo=function(e,i,r){void 0===r&&(r=n.Matrix.IdentityReadOnly);var o=i.subtract(e),a=Math.sqrt(o.x*o.x+o.y*o.y+o.z*o.z);return o.normalize(),t.Transform(new t(e,o,a),r)},t.Transform=function(e,i){var r=new t(new n.Vector3(0,0,0),new n.Vector3(0,0,0));return t.TransformToRef(e,i,r),r},t.TransformToRef=function(t,e,i){n.Vector3.TransformCoordinatesToRef(t.origin,e,i.origin),n.Vector3.TransformNormalToRef(t.direction,e,i.direction),i.length=t.length;var r=i.direction,o=r.length();if(0!==o&&1!==o){var a=1/o;r.x*=a,r.y*=a,r.z*=a,i.length*=o}},t.prototype.unprojectRayToRef=function(t,e,i,r,o,a,s){var c=n.Tmp.Matrix[0];o.multiplyToRef(a,c),c.multiplyToRef(s,c),c.invert();var h=n.Tmp.Vector3[0];h.x=t/i*2-1,h.y=-(e/r*2-1),h.z=-1;var u=n.Tmp.Vector3[1].copyFromFloats(h.x,h.y,1),l=n.Tmp.Vector3[2],p=n.Tmp.Vector3[3];n.Vector3._UnprojectFromInvertedMatrixToRef(h,c,l),n.Vector3._UnprojectFromInvertedMatrixToRef(u,c,p),this.origin.copyFrom(l),p.subtractToRef(l,this.direction),this.direction.normalize()},t.TmpVector3=r.a.BuildArray(6,n.Vector3.Zero),t.smallnum=1e-8,t.rayl=1e9,t}()},39:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var r=i(0),n=i(2),o=function(){function t(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshId=0,this.pickedSprite=null,this.originMesh=null,this.ray=null}return t.prototype.getNormal=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!0),!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(n.b.NormalKind))return null;var i,o=this.pickedMesh.getIndices();if(!o)return null;if(e){var a=this.pickedMesh.getVerticesData(n.b.NormalKind),s=r.Vector3.FromArray(a,3*o[3*this.faceId]),c=r.Vector3.FromArray(a,3*o[3*this.faceId+1]),h=r.Vector3.FromArray(a,3*o[3*this.faceId+2]);s=s.scale(this.bu),c=c.scale(this.bv),h=h.scale(1-this.bu-this.bv),i=new r.Vector3(s.x+c.x+h.x,s.y+c.y+h.y,s.z+c.z+h.z)}else{var u=this.pickedMesh.getVerticesData(n.b.PositionKind),l=r.Vector3.FromArray(u,3*o[3*this.faceId]),p=r.Vector3.FromArray(u,3*o[3*this.faceId+1]),_=r.Vector3.FromArray(u,3*o[3*this.faceId+2]),m=l.subtract(p),d=_.subtract(p);i=r.Vector3.Cross(m,d)}if(t){var f=this.pickedMesh.getWorldMatrix();this.pickedMesh.nonUniformScaling&&(r.Tmp.Matrix[0].copyFrom(f),(f=r.Tmp.Matrix[0]).setTranslationFromFloats(0,0,0),f.invert(),f.transposeToRef(r.Tmp.Matrix[1]),f=r.Tmp.Matrix[1]),i=r.Vector3.TransformNormal(i,f)}return i.normalize(),i},t.prototype.getTextureCoordinates=function(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(n.b.UVKind))return null;var t=this.pickedMesh.getIndices();if(!t)return null;var e=this.pickedMesh.getVerticesData(n.b.UVKind);if(!e)return null;var i=r.Vector2.FromArray(e,2*t[3*this.faceId]),o=r.Vector2.FromArray(e,2*t[3*this.faceId+1]),a=r.Vector2.FromArray(e,2*t[3*this.faceId+2]);return i=i.scale(1-this.bu-this.bv),o=o.scale(this.bu),a=a.scale(this.bv),new r.Vector2(i.x+o.x+a.x,i.y+o.y+a.y)},t}()},44:function(t,e,i){"use strict";var r=i(0),n=i(1),o=i(5),a=i(20),s=function(){function t(t,e){this.triggerOptions=t,this.onBeforeExecuteObservable=new o.a,t.parameter?(this.trigger=t.trigger,this._triggerParameter=t.parameter):t.trigger?this.trigger=t.trigger:this.trigger=t,this._nextActiveAction=this,this._condition=e}return t.prototype._prepare=function(){},t.prototype.getTriggerParameter=function(){return this._triggerParameter},t.prototype._executeCurrent=function(t){if(this._nextActiveAction._condition){var e=this._nextActiveAction._condition,i=this._actionManager.getScene().getRenderId();if(e._evaluationId===i){if(!e._currentResult)return}else{if(e._evaluationId=i,!e.isValid())return void(e._currentResult=!1);e._currentResult=!0}}this.onBeforeExecuteObservable.notifyObservers(this),this._nextActiveAction.execute(t),this.skipToNextActiveAction()},t.prototype.execute=function(t){},t.prototype.skipToNextActiveAction=function(){this._nextActiveAction._child?(this._nextActiveAction._child._actionManager||(this._nextActiveAction._child._actionManager=this._actionManager),this._nextActiveAction=this._nextActiveAction._child):this._nextActiveAction=this},t.prototype.then=function(t){return this._child=t,t._actionManager=this._actionManager,t._prepare(),t},t.prototype._getProperty=function(t){return this._actionManager._getProperty(t)},t.prototype._getEffectiveTarget=function(t,e){return this._actionManager._getEffectiveTarget(t,e)},t.prototype.serialize=function(t){},t.prototype._serialize=function(t,e){var i={type:1,children:[],name:t.name,properties:t.properties||[]};if(this._child&&this._child.serialize(i),this._condition){var r=this._condition.serialize();return r.children.push(i),e&&e.children.push(r),r}return e&&e.children.push(i),i},t._SerializeValueAsString=function(t){return"number"==typeof t?t.toString():"boolean"==typeof t?t?"true":"false":t instanceof r.Vector2?t.x+", "+t.y:t instanceof r.Vector3?t.x+", "+t.y+", "+t.z:t instanceof r.Color3?t.r+", "+t.g+", "+t.b:t instanceof r.Color4?t.r+", "+t.g+", "+t.b+", "+t.a:t},t._GetTargetProperty=function(t){return{name:"target",targetType:t._isMesh?"MeshProperties":t._isLight?"LightProperties":t._isCamera?"CameraProperties":"SceneProperties",value:t._isScene?"Scene":t.name}},t}();a.a.RegisteredTypes["BABYLON.Action"]=s;var c=function(){function t(t){this._actionManager=t}return t.prototype.isValid=function(){return!0},t.prototype._getProperty=function(t){return this._actionManager._getProperty(t)},t.prototype._getEffectiveTarget=function(t,e){return this._actionManager._getEffectiveTarget(t,e)},t.prototype.serialize=function(){},t.prototype._serialize=function(t){return{type:2,children:[],name:t.name,properties:t.properties}},t}(),h=function(t){function e(i,r,n,o,a){void 0===a&&(a=e.IsEqual);var s=t.call(this,i)||this;return s.propertyPath=n,s.value=o,s.operator=a,s._target=r,s._effectiveTarget=s._getEffectiveTarget(r,s.propertyPath),s._property=s._getProperty(s.propertyPath),s}return n.c(e,t),Object.defineProperty(e,"IsEqual",{get:function(){return e._IsEqual},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsDifferent",{get:function(){return e._IsDifferent},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsGreater",{get:function(){return e._IsGreater},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsLesser",{get:function(){return e._IsLesser},enumerable:!0,configurable:!0}),e.prototype.isValid=function(){switch(this.operator){case e.IsGreater:return this._effectiveTarget[this._property]>this.value;case e.IsLesser:return this._effectiveTarget[this._property]<this.value;case e.IsEqual:case e.IsDifferent:var t;return t=this.value.equals?this.value.equals(this._effectiveTarget[this._property]):this.value===this._effectiveTarget[this._property],this.operator===e.IsEqual?t:!t}return!1},e.prototype.serialize=function(){return this._serialize({name:"ValueCondition",properties:[s._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:s._SerializeValueAsString(this.value)},{name:"operator",value:e.GetOperatorName(this.operator)}]})},e.GetOperatorName=function(t){switch(t){case e._IsEqual:return"IsEqual";case e._IsDifferent:return"IsDifferent";case e._IsGreater:return"IsGreater";case e._IsLesser:return"IsLesser";default:return""}},e._IsEqual=0,e._IsDifferent=1,e._IsGreater=2,e._IsLesser=3,e}(c),u=function(t){function e(e,i){var r=t.call(this,e)||this;return r.predicate=i,r}return n.c(e,t),e.prototype.isValid=function(){return this.predicate()},e}(c),l=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.value=r,n._target=i,n}return n.c(e,t),e.prototype.isValid=function(){return this._target.state===this.value},e.prototype.serialize=function(){return this._serialize({name:"StateCondition",properties:[s._GetTargetProperty(this._target),{name:"value",value:this.value}]})},e}(c);a.a.RegisteredTypes["BABYLON.ValueCondition"]=h,a.a.RegisteredTypes["BABYLON.PredicateCondition"]=u,a.a.RegisteredTypes["BABYLON.StateCondition"]=l;var p=i(9),_=i(3),m=(function(t){function e(e,i,r,n){var o=t.call(this,e,n)||this;return o.propertyPath=r,o._target=o._effectiveTarget=i,o}n.c(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},e.prototype.execute=function(){this._effectiveTarget[this._property]=!this._effectiveTarget[this._property]},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SwitchBooleanAction",properties:[s._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath}]},e)}}(s),function(t){function e(e,i,r,n){var o=t.call(this,e,n)||this;return o.value=r,o._target=i,o}return n.c(e,t),e.prototype.execute=function(){this._target.state=this.value},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SetStateAction",properties:[s._GetTargetProperty(this._target),{name:"value",value:this.value}]},e)},e}(s)),d=function(t){function e(e,i,r,n,o){var a=t.call(this,e,o)||this;return a.propertyPath=r,a.value=n,a._target=a._effectiveTarget=i,a}return n.c(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath)},e.prototype.execute=function(){this._effectiveTarget[this._property]=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SetValueAction",properties:[s._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:s._SerializeValueAsString(this.value)}]},e)},e}(s),f=function(t){function e(e,i,r,n,o){var a=t.call(this,e,o)||this;return a.propertyPath=r,a.value=n,a._target=a._effectiveTarget=i,a}return n.c(e,t),e.prototype._prepare=function(){this._effectiveTarget=this._getEffectiveTarget(this._effectiveTarget,this.propertyPath),this._property=this._getProperty(this.propertyPath),"number"!=typeof this._effectiveTarget[this._property]&&p.a.Warn("Warning: IncrementValueAction can only be used with number values")},e.prototype.execute=function(){this._effectiveTarget[this._property]+=this.value,this._target.markAsDirty&&this._target.markAsDirty(this._property)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"IncrementValueAction",properties:[s._GetTargetProperty(this._target),{name:"propertyPath",value:this.propertyPath},{name:"value",value:s._SerializeValueAsString(this.value)}]},e)},e}(s),g=function(t){function e(e,i,r,n,o,a){var s=t.call(this,e,a)||this;return s.from=r,s.to=n,s.loop=o,s._target=i,s}return n.c(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){this._actionManager.getScene().beginAnimation(this._target,this.from,this.to,this.loop)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"PlayAnimationAction",properties:[s._GetTargetProperty(this._target),{name:"from",value:String(this.from)},{name:"to",value:String(this.to)},{name:"loop",value:s._SerializeValueAsString(this.loop)||!1}]},e)},e}(s),y=function(t){function e(e,i,r){var n=t.call(this,e,r)||this;return n._target=i,n}return n.c(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){this._actionManager.getScene().stopAnimation(this._target)},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"StopAnimationAction",properties:[s._GetTargetProperty(this._target)]},e)},e}(s),v=function(t){function e(e,i){return void 0===e&&(e=_.a.ACTION_NothingTrigger),t.call(this,e,i)||this}return n.c(e,t),e.prototype.execute=function(){},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"DoNothingAction",properties:[]},e)},e}(s),b=(function(t){function e(e,i,r){var n=t.call(this,e,r)||this;return n.children=i,n}n.c(e,t),e.prototype._prepare=function(){for(var t=0;t<this.children.length;t++)this.children[t]._actionManager=this._actionManager,this.children[t]._prepare()},e.prototype.execute=function(t){for(var e=0;e<this.children.length;e++)this.children[e].execute(t)},e.prototype.serialize=function(e){for(var i=t.prototype._serialize.call(this,{name:"CombineAction",properties:[],combine:[]},e),r=0;r<this.children.length;r++)i.combine.push(this.children[r].serialize(null));return i}}(s),function(t){function e(e,i,r){var n=t.call(this,e,r)||this;return n.func=i,n}return n.c(e,t),e.prototype.execute=function(t){this.func(t)},e}(s)),T=function(t){function e(e,i,r,n){var o=t.call(this,e,n)||this;return o._target=i,o._parent=r,o}return n.c(e,t),e.prototype._prepare=function(){},e.prototype.execute=function(){if(this._target.parent!==this._parent){var t=this._parent.getWorldMatrix().clone();t.invert(),this._target.position=r.Vector3.TransformCoordinates(this._target.position,t),this._target.parent=this._parent}},e.prototype.serialize=function(e){return t.prototype._serialize.call(this,{name:"SetParentAction",properties:[s._GetTargetProperty(this._target),s._GetTargetProperty(this._parent)]},e)},e}(s);a.a.RegisteredTypes["BABYLON.SetParentAction"]=T,a.a.RegisteredTypes["BABYLON.ExecuteCodeAction"]=b,a.a.RegisteredTypes["BABYLON.DoNothingAction"]=v,a.a.RegisteredTypes["BABYLON.StopAnimationAction"]=y,a.a.RegisteredTypes["BABYLON.PlayAnimationAction"]=g,a.a.RegisteredTypes["BABYLON.IncrementValueAction"]=f,a.a.RegisteredTypes["BABYLON.SetValueAction"]=d,a.a.RegisteredTypes["BABYLON.SetStateAction"]=m,a.a.RegisteredTypes["BABYLON.SetParentAction"]=T;var O=i(26),P=i(37);i.d(e,"a",function(){return A});var A=function(){function t(t){this.actions=new Array,this.hoverCursor="",this._scene=t||O.a.LastCreatedScene,t.actionManagers.push(this)}return t.prototype.dispose=function(){for(var e=this._scene.actionManagers.indexOf(this),i=0;i<this.actions.length;i++){var r=this.actions[i];t.Triggers[r.trigger]--,0===t.Triggers[r.trigger]&&delete t.Triggers[r.trigger]}e>-1&&this._scene.actionManagers.splice(e,1)},t.prototype.getScene=function(){return this._scene},t.prototype.hasSpecificTriggers=function(t){for(var e=0;e<this.actions.length;e++){var i=this.actions[e];if(t.indexOf(i.trigger)>-1)return!0}return!1},t.prototype.hasSpecificTriggers2=function(t,e){for(var i=0;i<this.actions.length;i++){var r=this.actions[i];if(t==r.trigger||e==r.trigger)return!0}return!1},t.prototype.hasSpecificTrigger=function(t,e){for(var i=0;i<this.actions.length;i++){var r=this.actions[i];if(r.trigger===t){if(!e)return!0;if(e(r.getTriggerParameter()))return!0}}return!1},Object.defineProperty(t.prototype,"hasPointerTriggers",{get:function(){for(var e=0;e<this.actions.length;e++){var i=this.actions[e];if(i.trigger>=t.OnPickTrigger&&i.trigger<=t.OnPointerOutTrigger)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPickTriggers",{get:function(){for(var e=0;e<this.actions.length;e++){var i=this.actions[e];if(i.trigger>=t.OnPickTrigger&&i.trigger<=t.OnPickUpTrigger)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HasTriggers",{get:function(){for(var e in t.Triggers)if(t.Triggers.hasOwnProperty(e))return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HasPickTriggers",{get:function(){for(var e in t.Triggers)if(t.Triggers.hasOwnProperty(e)){var i=parseInt(e);if(i>=t.OnPickTrigger&&i<=t.OnPickUpTrigger)return!0}return!1},enumerable:!0,configurable:!0}),t.HasSpecificTrigger=function(e){for(var i in t.Triggers){if(t.Triggers.hasOwnProperty(i))if(parseInt(i)===e)return!0}return!1},t.prototype.registerAction=function(e){return e.trigger===t.OnEveryFrameTrigger&&this.getScene().actionManager!==this?(p.a.Warn("OnEveryFrameTrigger can only be used with scene.actionManager"),null):(this.actions.push(e),t.Triggers[e.trigger]?t.Triggers[e.trigger]++:t.Triggers[e.trigger]=1,e._actionManager=this,e._prepare(),e)},t.prototype.unregisterAction=function(e){var i=this.actions.indexOf(e);return-1!==i&&(this.actions.splice(i,1),t.Triggers[e.trigger]-=1,0===t.Triggers[e.trigger]&&delete t.Triggers[e.trigger],delete e._actionManager,!0)},t.prototype.processTrigger=function(e,i){for(var r=0;r<this.actions.length;r++){var n=this.actions[r];if(n.trigger===e){if(i&&(e===t.OnKeyUpTrigger||e===t.OnKeyDownTrigger)){var o=n.getTriggerParameter();if(o&&o!==i.sourceEvent.keyCode){if(!o.toLowerCase)continue;var a=o.toLowerCase();if(a!==i.sourceEvent.key){var s=i.sourceEvent.charCode?i.sourceEvent.charCode:i.sourceEvent.keyCode;if(String.fromCharCode(s).toLowerCase()!==a)continue}}}n._executeCurrent(i)}}},t.prototype._getEffectiveTarget=function(t,e){for(var i=e.split("."),r=0;r<i.length-1;r++)t=t[i[r]];return t},t.prototype._getProperty=function(t){var e=t.split(".");return e[e.length-1]},t.prototype.serialize=function(e){for(var i={children:new Array,name:e,type:3,properties:new Array},r=0;r<this.actions.length;r++){var n={type:0,children:new Array,name:t.GetTriggerName(this.actions[r].trigger),properties:new Array},o=this.actions[r].triggerOptions;if(o&&"number"!=typeof o)if(o.parameter instanceof Node)n.properties.push(s._GetTargetProperty(o.parameter));else{var a={};P.a.DeepCopy(o.parameter,a,["mesh"]),o.parameter&&o.parameter.mesh&&(a._meshId=o.parameter.mesh.id),n.properties.push({name:"parameter",targetType:null,value:a})}this.actions[r].serialize(n),i.children.push(n)}return i},t.Parse=function(e,i,n){var o=new t(n);null===i?n.actionManager=o:i.actionManager=o;for(var s=function(t,e,i,n){if(null===n){var o=parseFloat(e);return"true"===e||"false"===e?"true"===e:isNaN(o)?e:o}for(var a=n.split("."),s=e.split(","),c=0;c<a.length;c++)i=i[a[c]];if("boolean"==typeof i)return"true"===s[0];if("string"==typeof i)return s[0];var h=new Array;for(c=0;c<s.length;c++)h.push(parseFloat(s[c]));return i instanceof r.Vector3?r.Vector3.FromArray(h):i instanceof r.Vector4?r.Vector4.FromArray(h):i instanceof r.Color3?r.Color3.FromArray(h):i instanceof r.Color4?r.Color4.FromArray(h):parseFloat(s[0])},u=function(e,i,r,l,p){if(void 0===p&&(p=null),!e.detached){var _=new Array,m=null,d=null,f=e.combine&&e.combine.length>0;if(2===e.type?_.push(o):_.push(i),f){for(var g=new Array,y=0;y<e.combine.length;y++)u(e.combine[y],t.NothingTrigger,r,l,g);_.push(g)}else for(var b=0;b<e.properties.length;b++){var T=e.properties[b].value,O=e.properties[b].name,P=e.properties[b].targetType;"target"===O?T=m=null!==P&&"SceneProperties"===P?n:n.getNodeByName(T):"parent"===O?T=n.getNodeByName(T):"sound"===O?n.getSoundByName&&(T=n.getSoundByName(T)):"propertyPath"!==O?T=2===e.type&&"operator"===O?h[T]:s(0,T,m,"value"===O?d:null):d=T,_.push(T)}if(null===p?_.push(r):_.push(null),"InterpolateValueAction"===e.name){var A=_[_.length-2];_[_.length-1]=A,_[_.length-2]=r}var M=function(t,e){var i=a.a.GetClass("BABYLON."+t);if(i){var r=Object.create(i.prototype);return r.constructor.apply(r,e),r}}(e.name,_);if(M instanceof c&&null!==r){var R=new v(i,r);l?l.then(R):o.registerAction(R),l=R}null===p?M instanceof c?(r=M,M=l):(r=null,l?l.then(M):o.registerAction(M)):p.push(M);for(b=0;b<e.children.length;b++)u(e.children[b],i,r,M,null)}},l=0;l<e.children.length;l++){var p,_=e.children[l];if(_.properties.length>0){var m=_.properties[0].value,d=null===_.properties[0].targetType?m:n.getMeshByName(m);d._meshId&&(d.mesh=n.getMeshByID(d._meshId)),p={trigger:t[_.name],parameter:d}}else p=t[_.name];for(var f=0;f<_.children.length;f++)_.detached||u(_.children[f],p,null,null)}},t.GetTriggerName=function(t){switch(t){case 0:return"NothingTrigger";case 1:return"OnPickTrigger";case 2:return"OnLeftPickTrigger";case 3:return"OnRightPickTrigger";case 4:return"OnCenterPickTrigger";case 5:return"OnPickDownTrigger";case 6:return"OnPickUpTrigger";case 7:return"OnLongPressTrigger";case 8:return"OnPointerOverTrigger";case 9:return"OnPointerOutTrigger";case 10:return"OnEveryFrameTrigger";case 11:return"OnIntersectionEnterTrigger";case 12:return"OnIntersectionExitTrigger";case 13:return"OnKeyDownTrigger";case 14:return"OnKeyUpTrigger";case 15:return"OnPickOutTrigger";default:return""}},t.NothingTrigger=_.a.ACTION_NothingTrigger,t.OnPickTrigger=_.a.ACTION_OnPickTrigger,t.OnLeftPickTrigger=_.a.ACTION_OnLeftPickTrigger,t.OnRightPickTrigger=_.a.ACTION_OnRightPickTrigger,t.OnCenterPickTrigger=_.a.ACTION_OnCenterPickTrigger,t.OnPickDownTrigger=_.a.ACTION_OnPickDownTrigger,t.OnDoublePickTrigger=_.a.ACTION_OnDoublePickTrigger,t.OnPickUpTrigger=_.a.ACTION_OnPickUpTrigger,t.OnPickOutTrigger=_.a.ACTION_OnPickOutTrigger,t.OnLongPressTrigger=_.a.ACTION_OnLongPressTrigger,t.OnPointerOverTrigger=_.a.ACTION_OnPointerOverTrigger,t.OnPointerOutTrigger=_.a.ACTION_OnPointerOutTrigger,t.OnEveryFrameTrigger=_.a.ACTION_OnEveryFrameTrigger,t.OnIntersectionEnterTrigger=_.a.ACTION_OnIntersectionEnterTrigger,t.OnIntersectionExitTrigger=_.a.ACTION_OnIntersectionExitTrigger,t.OnKeyDownTrigger=_.a.ACTION_OnKeyDownTrigger,t.OnKeyUpTrigger=15,t.Triggers={},t}()},45:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var r=function(){return function(t,e,i){this.bu=t,this.bv=e,this.distance=i,this.faceId=0,this.subMeshId=0}}()},47:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var r,n=i(0),o=(r={root:0,found:!1},function(t,e,i,n){r.root=0,r.found=!1;var o=e*e-4*t*i;if(o<0)return r;var a=Math.sqrt(o),s=(-e-a)/(2*t),c=(-e+a)/(2*t);if(s>c){var h=c;c=s,s=h}return s>0&&s<n?(r.root=s,r.found=!0,r):c>0&&c<n?(r.root=c,r.found=!0,r):r}),a=function(){function t(){this._collisionPoint=n.Vector3.Zero(),this._planeIntersectionPoint=n.Vector3.Zero(),this._tempVector=n.Vector3.Zero(),this._tempVector2=n.Vector3.Zero(),this._tempVector3=n.Vector3.Zero(),this._tempVector4=n.Vector3.Zero(),this._edge=n.Vector3.Zero(),this._baseToVertex=n.Vector3.Zero(),this._destinationPoint=n.Vector3.Zero(),this._slidePlaneNormal=n.Vector3.Zero(),this._displacementVector=n.Vector3.Zero(),this._radius=n.Vector3.One(),this._retry=0,this._basePointWorld=n.Vector3.Zero(),this._velocityWorld=n.Vector3.Zero(),this._normalizedVelocity=n.Vector3.Zero(),this._collisionMask=-1}return Object.defineProperty(t.prototype,"collisionMask",{get:function(){return this._collisionMask},set:function(t){this._collisionMask=isNaN(t)?-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slidePlaneNormal",{get:function(){return this._slidePlaneNormal},enumerable:!0,configurable:!0}),t.prototype._initialize=function(t,e,i){this._velocity=e,n.Vector3.NormalizeToRef(e,this._normalizedVelocity),this._basePoint=t,t.multiplyToRef(this._radius,this._basePointWorld),e.multiplyToRef(this._radius,this._velocityWorld),this._velocityWorldLength=this._velocityWorld.length(),this._epsilon=i,this.collisionFound=!1},t.prototype._checkPointInTriangle=function(t,e,i,r,o){e.subtractToRef(t,this._tempVector),i.subtractToRef(t,this._tempVector2),n.Vector3.CrossToRef(this._tempVector,this._tempVector2,this._tempVector4);var a=n.Vector3.Dot(this._tempVector4,o);return!(a<0)&&(r.subtractToRef(t,this._tempVector3),n.Vector3.CrossToRef(this._tempVector2,this._tempVector3,this._tempVector4),!((a=n.Vector3.Dot(this._tempVector4,o))<0)&&(n.Vector3.CrossToRef(this._tempVector3,this._tempVector,this._tempVector4),(a=n.Vector3.Dot(this._tempVector4,o))>=0))},t.prototype._canDoCollision=function(t,e,i,r){var o=n.Vector3.Distance(this._basePointWorld,t),a=Math.max(this._radius.x,this._radius.y,this._radius.z);return!(o>this._velocityWorldLength+a+e)&&!!function(t,e,i,r){return!(t.x>i.x+r||i.x-r>e.x||t.y>i.y+r||i.y-r>e.y||t.z>i.z+r||i.z-r>e.z)}(i,r,this._basePointWorld,this._velocityWorldLength+a)},t.prototype._testTriangle=function(t,e,i,r,a,s){var c,h=!1;e||(e=[]),e[t]||(e[t]=new n.Plane(0,0,0,0),e[t].copyFromPoints(i,r,a));var u=e[t];if(s||u.isFrontFacingTo(this._normalizedVelocity,0)){var l=u.signedDistanceTo(this._basePoint),p=n.Vector3.Dot(u.normal,this._velocity);if(0==p){if(Math.abs(l)>=1)return;h=!0,c=0}else{var _=(1-l)/p;if((c=(-1-l)/p)>_){var m=_;_=c,c=m}if(c>1||_<0)return;c<0&&(c=0),c>1&&(c=1)}this._collisionPoint.copyFromFloats(0,0,0);var d=!1,f=1;if(h||(this._basePoint.subtractToRef(u.normal,this._planeIntersectionPoint),this._velocity.scaleToRef(c,this._tempVector),this._planeIntersectionPoint.addInPlace(this._tempVector),this._checkPointInTriangle(this._planeIntersectionPoint,i,r,a,u.normal)&&(d=!0,f=c,this._collisionPoint.copyFrom(this._planeIntersectionPoint))),!d){var g=this._velocity.lengthSquared(),y=g;this._basePoint.subtractToRef(i,this._tempVector);var v=2*n.Vector3.Dot(this._velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,T=o(y,v,b,f);T.found&&(f=T.root,d=!0,this._collisionPoint.copyFrom(i)),this._basePoint.subtractToRef(r,this._tempVector),v=2*n.Vector3.Dot(this._velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,(T=o(y,v,b,f)).found&&(f=T.root,d=!0,this._collisionPoint.copyFrom(r)),this._basePoint.subtractToRef(a,this._tempVector),v=2*n.Vector3.Dot(this._velocity,this._tempVector),b=this._tempVector.lengthSquared()-1,(T=o(y,v,b,f)).found&&(f=T.root,d=!0,this._collisionPoint.copyFrom(a)),r.subtractToRef(i,this._edge),i.subtractToRef(this._basePoint,this._baseToVertex);var O=this._edge.lengthSquared(),P=n.Vector3.Dot(this._edge,this._velocity),A=n.Vector3.Dot(this._edge,this._baseToVertex);if(y=O*-g+P*P,v=O*(2*n.Vector3.Dot(this._velocity,this._baseToVertex))-2*P*A,b=O*(1-this._baseToVertex.lengthSquared())+A*A,(T=o(y,v,b,f)).found){var M=(P*T.root-A)/O;M>=0&&M<=1&&(f=T.root,d=!0,this._edge.scaleInPlace(M),i.addToRef(this._edge,this._collisionPoint))}a.subtractToRef(r,this._edge),r.subtractToRef(this._basePoint,this._baseToVertex),O=this._edge.lengthSquared(),P=n.Vector3.Dot(this._edge,this._velocity),A=n.Vector3.Dot(this._edge,this._baseToVertex),y=O*-g+P*P,v=O*(2*n.Vector3.Dot(this._velocity,this._baseToVertex))-2*P*A,b=O*(1-this._baseToVertex.lengthSquared())+A*A,(T=o(y,v,b,f)).found&&(M=(P*T.root-A)/O)>=0&&M<=1&&(f=T.root,d=!0,this._edge.scaleInPlace(M),r.addToRef(this._edge,this._collisionPoint)),i.subtractToRef(a,this._edge),a.subtractToRef(this._basePoint,this._baseToVertex),O=this._edge.lengthSquared(),P=n.Vector3.Dot(this._edge,this._velocity),A=n.Vector3.Dot(this._edge,this._baseToVertex),y=O*-g+P*P,v=O*(2*n.Vector3.Dot(this._velocity,this._baseToVertex))-2*P*A,b=O*(1-this._baseToVertex.lengthSquared())+A*A,(T=o(y,v,b,f)).found&&(M=(P*T.root-A)/O)>=0&&M<=1&&(f=T.root,d=!0,this._edge.scaleInPlace(M),a.addToRef(this._edge,this._collisionPoint))}if(d){var R=f*this._velocity.length();(!this.collisionFound||R<this._nearestDistance)&&(this.intersectionPoint?this.intersectionPoint.copyFrom(this._collisionPoint):this.intersectionPoint=this._collisionPoint.clone(),this._nearestDistance=R,this.collisionFound=!0)}}},t.prototype._collide=function(t,e,i,r,n,o,a){for(var s=r;s<n;s+=3){var c=e[i[s]-o],h=e[i[s+1]-o],u=e[i[s+2]-o];this._testTriangle(s,t,u,h,c,a)}},t.prototype._getResponse=function(t,e){t.addToRef(e,this._destinationPoint),e.scaleInPlace(this._nearestDistance/e.length()),this._basePoint.addToRef(e,t),t.subtractToRef(this.intersectionPoint,this._slidePlaneNormal),this._slidePlaneNormal.normalize(),this._slidePlaneNormal.scaleToRef(this._epsilon,this._displacementVector),t.addInPlace(this._displacementVector),this.intersectionPoint.addInPlace(this._displacementVector),this._slidePlaneNormal.scaleInPlace(n.Plane.SignedDistanceToPlaneFromPositionAndNormal(this.intersectionPoint,this._slidePlaneNormal,this._destinationPoint)),this._destinationPoint.subtractInPlace(this._slidePlaneNormal),this._destinationPoint.subtractToRef(this.intersectionPoint,e)},t}()},55:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var r=i(0),n=i(23),o=function(){function t(){this._scaledPosition=r.Vector3.Zero(),this._scaledVelocity=r.Vector3.Zero(),this._finalPosition=r.Vector3.Zero()}return t.prototype.getNewPosition=function(t,e,i,r,n,o,a){t.divideToRef(i._radius,this._scaledPosition),e.divideToRef(i._radius,this._scaledVelocity),i.collidedMesh=null,i._retry=0,i._initialVelocity=this._scaledVelocity,i._initialPosition=this._scaledPosition,this._collideWithWorld(this._scaledPosition,this._scaledVelocity,i,r,this._finalPosition,n),this._finalPosition.multiplyInPlace(i._radius),o(a,this._finalPosition,i.collidedMesh)},t.prototype.init=function(t){this._scene=t},t.prototype.destroy=function(){},t.prototype.onMeshAdded=function(t){},t.prototype.onMeshUpdated=function(t){},t.prototype.onMeshRemoved=function(t){},t.prototype.onGeometryAdded=function(t){},t.prototype.onGeometryUpdated=function(t){},t.prototype.onGeometryDeleted=function(t){},t.prototype._collideWithWorld=function(t,e,i,r,o,a){void 0===a&&(a=null);var s=10*n.Engine.CollisionsEpsilon;if(i._retry>=r)o.copyFrom(t);else{var c=a?a.collisionMask:i.collisionMask;i._initialize(t,e,s);for(var h=0;h<this._scene.meshes.length;h++){var u=this._scene.meshes[h];u.isEnabled()&&u.checkCollisions&&u.subMeshes&&u!==a&&0!=(c&u.collisionGroup)&&u._checkCollision(i)}i.collisionFound?(0===e.x&&0===e.y&&0===e.z||i._getResponse(t,e),e.length()<=s?o.copyFrom(t):(i._retry++,this._collideWithWorld(t,e,i,r,o,a))):t.addToRef(e,o)}},t}()},57:function(t,e,i){"use strict";var r=i(0),n=i(14),o=Object.freeze(new r.Quaternion(0,0,0,0)),a=Object.freeze(r.Vector3.Zero()),s=Object.freeze(r.Vector2.Zero()),c=Object.freeze(r.Size.Zero()),h=Object.freeze(r.Color3.Black()),u=function(){function t(t,e,i,r){var n=this;this._events=new Array,this._currentFrame=0,this._originalValue=new Array,this._offsetsCache={},this._highLimitsCache={},this._stopped=!1,this._blendingFactor=0,this._targetPath="",this._weight=1,this._ratioOffset=0,this._previousDelay=0,this._previousRatio=0,this._animation=e,this._target=t,this._scene=i,this._host=r,e._runtimeAnimations.push(this);var o=e.getEvents();o&&o.length>0&&o.forEach(function(t){n._events.push(t._clone())})}return Object.defineProperty(t.prototype,"currentFrame",{get:function(){return this._currentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentValue",{get:function(){return this._currentValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetPath",{get:function(){return this._targetPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._activeTarget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),t.prototype.reset=function(t){if(void 0===t&&(t=!1),t)if(this._target instanceof Array)for(var e=0,i=0,r=this._target;i<r.length;i++){var n=r[i];void 0!==this._originalValue[e]&&this._setValue(n,this._originalValue[e],-1),e++}else void 0!==this._originalValue[0]&&this._setValue(this._target,this._originalValue[0],-1);this._offsetsCache={},this._highLimitsCache={},this._currentFrame=0,this._blendingFactor=0,this._originalValue=new Array;for(e=0;e<this._events.length;e++)this._events[e].isDone=!1},t.prototype.isStopped=function(){return this._stopped},t.prototype.dispose=function(){var t=this._animation.runtimeAnimations.indexOf(this);t>-1&&this._animation.runtimeAnimations.splice(t,1)},t.prototype._interpolate=function(t,e,i,o,a){return this._currentFrame=t,this._animation.dataType!==n.a.ANIMATIONTYPE_MATRIX||this._workValue||(this._workValue=r.Matrix.Zero()),this._animation._interpolate(t,e,this._workValue,i,o,a)},t.prototype.setValue=function(t,e){if(void 0===e&&(e=1),this._target instanceof Array)for(var i=0,r=0,n=this._target;r<n.length;r++){var o=n[r];this._setValue(o,t,e,i),i++}else this._setValue(this._target,t,e)},t.prototype._setValue=function(t,e,i,o){var a,s;void 0===o&&(o=0);var c=this._animation.targetPropertyPath;if(c.length>1){for(var h=t[c[0]],u=1;u<c.length-1;u++)h=h[c[u]];a=c[c.length-1],s=h}else a=c[0],s=t;if(this._targetPath=a,this._activeTarget=s,this._weight=i,void 0===this._originalValue[o]){var l=void 0;(l=s.getRestPose&&"_matrix"===a?s.getRestPose():s[a])&&l.clone?this._originalValue[o]=l.clone():this._originalValue[o]=l}if((t&&t.animationPropertiesOverride?t.animationPropertiesOverride.enableBlending:this._animation.enableBlending)&&this._blendingFactor<=1){if(!this._originalBlendValue)(l=s[a]).clone?this._originalBlendValue=l.clone():this._originalBlendValue=l;this._originalBlendValue.m?n.a.AllowMatrixDecomposeForInterpolation?this._currentValue?r.Matrix.DecomposeLerpToRef(this._originalBlendValue,e,this._blendingFactor,this._currentValue):this._currentValue=r.Matrix.DecomposeLerp(this._originalBlendValue,e,this._blendingFactor):this._currentValue?r.Matrix.LerpToRef(this._originalBlendValue,e,this._blendingFactor,this._currentValue):this._currentValue=r.Matrix.Lerp(this._originalBlendValue,e,this._blendingFactor):this._currentValue=n.a._UniversalLerp(this._originalBlendValue,e,this._blendingFactor);var p=t&&t.animationPropertiesOverride?t.animationPropertiesOverride.blendingSpeed:this._animation.blendingSpeed;this._blendingFactor+=p}else this._currentValue=e;-1!==i?this._scene._registerTargetForLateAnimationBinding(this,this._originalValue[o]):s[a]=this._currentValue,t.markAsDirty&&t.markAsDirty(this._animation.targetProperty)},t.prototype._getCorrectLoopMode=function(){return this._target&&this._target.animationPropertiesOverride?this._target.animationPropertiesOverride.loopMode:this._animation.loopMode},t.prototype.goToFrame=function(t){var e=this._animation.getKeys();t<e[0].frame?t=e[0].frame:t>e[e.length-1].frame&&(t=e[e.length-1].frame);var i=this._interpolate(t,0,this._getCorrectLoopMode());this.setValue(i,-1)},t.prototype._prepareForSpeedRatioChange=function(t){var e=this._previousDelay*(this._animation.framePerSecond*t)/1e3;this._ratioOffset=this._previousRatio-e},t.prototype.animate=function(t,e,i,r,u,l,p){void 0===l&&(l=-1);var _=this._animation.targetPropertyPath;if(!_||_.length<1)return this._stopped=!0,!1;var m=!0,d=this._animation.getKeys();if(0!==d[0].frame){var f={frame:0,value:d[0].value};d.splice(0,0,f)}else if(1===d.length){f={frame:.001,value:d[0].value};d.push(f)}(e<d[0].frame||e>d[d.length-1].frame)&&(e=d[0].frame),(i<d[0].frame||i>d[d.length-1].frame)&&(i=d[d.length-1].frame),e===i&&(e>d[0].frame?e--:i<d[d.length-1].frame&&i++);var g,y=i-e,v=t*(this._animation.framePerSecond*u)/1e3+this._ratioOffset,b=0;if(this._previousDelay=t,this._previousRatio=v,(i>e&&v>=y||e>i&&v<=y)&&!r)m=!1,b=this._animation._getKeyValue(d[d.length-1].value);else if(this._getCorrectLoopMode()!==n.a.ANIMATIONLOOPMODE_CYCLE){var T=i.toString()+e.toString();if(!this._offsetsCache[T]){var O=this._interpolate(e,0,n.a.ANIMATIONLOOPMODE_CYCLE),P=this._interpolate(i,0,n.a.ANIMATIONLOOPMODE_CYCLE);switch(this._animation.dataType){case n.a.ANIMATIONTYPE_FLOAT:this._offsetsCache[T]=P-O;break;case n.a.ANIMATIONTYPE_QUATERNION:this._offsetsCache[T]=P.subtract(O);break;case n.a.ANIMATIONTYPE_VECTOR3:this._offsetsCache[T]=P.subtract(O);case n.a.ANIMATIONTYPE_VECTOR2:this._offsetsCache[T]=P.subtract(O);case n.a.ANIMATIONTYPE_SIZE:this._offsetsCache[T]=P.subtract(O);case n.a.ANIMATIONTYPE_COLOR3:this._offsetsCache[T]=P.subtract(O)}this._highLimitsCache[T]=P}b=this._highLimitsCache[T],g=this._offsetsCache[T]}if(void 0===g)switch(this._animation.dataType){case n.a.ANIMATIONTYPE_FLOAT:g=0;break;case n.a.ANIMATIONTYPE_QUATERNION:g=o;break;case n.a.ANIMATIONTYPE_VECTOR3:g=a;break;case n.a.ANIMATIONTYPE_VECTOR2:g=s;break;case n.a.ANIMATIONTYPE_SIZE:g=c;break;case n.a.ANIMATIONTYPE_COLOR3:g=h}var A=v/y>>0,M=m?e+v%y:i;if(this._host&&this._host.syncRoot){var R=this._host.syncRoot;M=e+(i-e)*((R.masterFrame-R.fromFrame)/(R.toFrame-R.fromFrame))}var I=this._events;if(y>0&&this.currentFrame>M||y<0&&this.currentFrame<M){p&&p();for(var C=0;C<I.length;C++)I[C].onlyOnce||(I[C].isDone=!1)}var E=this._interpolate(M,A,this._getCorrectLoopMode(),g,b);this.setValue(E,l);for(C=0;C<I.length;C++)if(y>0&&M>=I[C].frame&&I[C].frame>=e||y<0&&M<=I[C].frame&&I[C].frame<=e){var x=I[C];x.isDone||(x.onlyOnce&&(I.splice(C,1),C--),x.isDone=!0,x.action(M))}return m||(this._stopped=!0),m},t}(),l=i(5);i.d(e,"a",function(){return p});var p=function(){function t(t,e,i,r,n,o,a,s,c){void 0===i&&(i=0),void 0===r&&(r=100),void 0===n&&(n=!1),void 0===o&&(o=1),this.target=e,this.fromFrame=i,this.toFrame=r,this.loopAnimation=n,this.onAnimationEnd=a,this.onAnimationLoop=c,this._localDelayOffset=null,this._pausedDelay=null,this._runtimeAnimations=new Array,this._paused=!1,this._speedRatio=1,this._weight=-1,this.disposeOnEnd=!0,this.animationStarted=!1,this.onAnimationEndObservable=new l.a,this.onAnimationLoopObservable=new l.a,this._scene=t,s&&this.appendAnimations(e,s),this._speedRatio=o,t._activeAnimatables.push(this)}return Object.defineProperty(t.prototype,"syncRoot",{get:function(){return this._syncRoot},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"masterFrame",{get:function(){return 0===this._runtimeAnimations.length?0:this._runtimeAnimations[0].currentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},set:function(t){this._weight=-1!==t?Math.min(Math.max(t,0),1):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedRatio",{get:function(){return this._speedRatio},set:function(t){for(var e=0;e<this._runtimeAnimations.length;e++){this._runtimeAnimations[e]._prepareForSpeedRatioChange(t)}this._speedRatio=t},enumerable:!0,configurable:!0}),t.prototype.syncWith=function(t){if(this._syncRoot=t,t){var e=this._scene._activeAnimatables.indexOf(this);e>-1&&(this._scene._activeAnimatables.splice(e,1),this._scene._activeAnimatables.push(this))}return this},t.prototype.getAnimations=function(){return this._runtimeAnimations},t.prototype.appendAnimations=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];this._runtimeAnimations.push(new u(t,r,this._scene,this))}},t.prototype.getAnimationByTargetProperty=function(t){for(var e=this._runtimeAnimations,i=0;i<e.length;i++)if(e[i].animation.targetProperty===t)return e[i].animation;return null},t.prototype.getRuntimeAnimationByTargetProperty=function(t){for(var e=this._runtimeAnimations,i=0;i<e.length;i++)if(e[i].animation.targetProperty===t)return e[i];return null},t.prototype.reset=function(){for(var t=this._runtimeAnimations,e=0;e<t.length;e++)t[e].reset(!0);this._localDelayOffset=null,this._pausedDelay=null},t.prototype.enableBlending=function(t){for(var e=this._runtimeAnimations,i=0;i<e.length;i++)e[i].animation.enableBlending=!0,e[i].animation.blendingSpeed=t},t.prototype.disableBlending=function(){for(var t=this._runtimeAnimations,e=0;e<t.length;e++)t[e].animation.enableBlending=!1},t.prototype.goToFrame=function(t){var e=this._runtimeAnimations;if(e[0]){var i=e[0].animation.framePerSecond,r=1e3*(t-e[0].currentFrame)/(i*this.speedRatio);null===this._localDelayOffset&&(this._localDelayOffset=0),this._localDelayOffset-=r}for(var n=0;n<e.length;n++)e[n].goToFrame(t)},t.prototype.pause=function(){this._paused||(this._paused=!0)},t.prototype.restart=function(){this._paused=!1},t.prototype._raiseOnAnimationEnd=function(){this.onAnimationEnd&&this.onAnimationEnd(),this.onAnimationEndObservable.notifyObservers(this)},t.prototype.stop=function(t,e){if(t||e){var i=this._scene._activeAnimatables.indexOf(this);if(i>-1){for(var r=(o=this._runtimeAnimations).length-1;r>=0;r--){var n=o[r];t&&n.animation.name!=t||(e&&!e(n.target)||(n.dispose(),o.splice(r,1)))}0==o.length&&(this._scene._activeAnimatables.splice(i,1),this._raiseOnAnimationEnd())}}else{if((r=this._scene._activeAnimatables.indexOf(this))>-1){this._scene._activeAnimatables.splice(r,1);var o=this._runtimeAnimations;for(r=0;r<o.length;r++)o[r].dispose();this._raiseOnAnimationEnd()}}},t.prototype.waitAsync=function(){var t=this;return new Promise(function(e,i){t.onAnimationEndObservable.add(function(){e(t)},void 0,void 0,t,!0)})},t.prototype._animate=function(t){var e=this;if(this._paused)return this.animationStarted=!1,null===this._pausedDelay&&(this._pausedDelay=t),!0;if(null===this._localDelayOffset?(this._localDelayOffset=t,this._pausedDelay=null):null!==this._pausedDelay&&(this._localDelayOffset+=t-this._pausedDelay,this._pausedDelay=null),0===this._weight)return!0;var i,r=!1,n=this._runtimeAnimations;for(i=0;i<n.length;i++){var o=n[i].animate(t-this._localDelayOffset,this.fromFrame,this.toFrame,this.loopAnimation,this._speedRatio,this._weight,function(){e.onAnimationLoopObservable.notifyObservers(e),e.onAnimationLoop&&e.onAnimationLoop()});r=r||o}if(this.animationStarted=r,!r){if(this.disposeOnEnd)for(i=this._scene._activeAnimatables.indexOf(this),this._scene._activeAnimatables.splice(i,1),i=0;i<n.length;i++)n[i].dispose();this._raiseOnAnimationEnd(),this.disposeOnEnd&&(this.onAnimationEnd=null,this.onAnimationLoop=null,this.onAnimationLoopObservable.clear(),this.onAnimationEndObservable.clear())}return r},t}()},82:function(t,e,i){"use strict";i.r(e);var r=i(1),n=i(4),o=i(5),a=i(0),s=i(24),c=i(8),h=i(10),u=i(27),l=function(){function t(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}return Object.defineProperty(t.prototype,"name",{get:function(){return"AutoRotation"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomStopsAnimation",{get:function(){return this._zoomStopsAnimation},set:function(t){this._zoomStopsAnimation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationSpeed",{get:function(){return this._idleRotationSpeed},set:function(t){this._idleRotationSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationWaitTime",{get:function(){return this._idleRotationWaitTime},set:function(t){this._idleRotationWaitTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleRotationSpinupTime",{get:function(){return this._idleRotationSpinupTime},set:function(t){this._idleRotationSpinupTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationInProgress",{get:function(){return Math.abs(this._cameraRotationSpeed)>0},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){var e=this;this._attachedCamera=t;var i=this._attachedCamera.getScene();this._onPrePointerObservableObserver=i.onPrePointerObservable.add(function(t){t.type!==h.a.POINTERDOWN?t.type===h.a.POINTERUP&&(e._isPointerDown=!1):e._isPointerDown=!0}),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add(function(){var t=u.a.Now,i=0;null!=e._lastFrameTime&&(i=t-e._lastFrameTime),e._lastFrameTime=t,e._applyUserInteraction();var r=t-e._lastInteractionTime-e._idleRotationWaitTime,n=Math.max(Math.min(r/e._idleRotationSpinupTime,1),0);e._cameraRotationSpeed=e._idleRotationSpeed*n,e._attachedCamera&&(e._attachedCamera.alpha-=e._cameraRotationSpeed*(i/1e3))})},t.prototype.detach=function(){if(this._attachedCamera){var t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}},t.prototype._userIsZooming=function(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset},t.prototype._shouldAnimationStopForInteraction=function(){if(!this._attachedCamera)return!1;var t=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(t=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?t:this._userIsZooming()},t.prototype._applyUserInteraction=function(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=u.a.Now)},t.prototype._userIsMoving=function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)},t}(),p=function(){function t(){this._easingMode=t.EASINGMODE_EASEIN}return t.prototype.setEasingMode=function(t){var e=Math.min(Math.max(t,0),2);this._easingMode=e},t.prototype.getEasingMode=function(){return this._easingMode},t.prototype.easeInCore=function(t){throw new Error("You must implement this method")},t.prototype.ease=function(e){switch(this._easingMode){case t.EASINGMODE_EASEIN:return this.easeInCore(e);case t.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-e)}return e>=.5?.5*(1-this.easeInCore(2*(1-e)))+.5:.5*this.easeInCore(2*e)},t.EASINGMODE_EASEIN=0,t.EASINGMODE_EASEOUT=1,t.EASINGMODE_EASEINOUT=2,t}(),_=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.c(e,t),e.prototype.easeInCore=function(t){return t=Math.max(0,Math.min(1,t)),1-Math.sqrt(1-t*t)}}(p),function(t){function e(e){void 0===e&&(e=1);var i=t.call(this)||this;return i.amplitude=e,i}return r.c(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.amplitude);return Math.pow(t,3)-t*e*Math.sin(3.141592653589793*t)},e}(p)),m=(function(t){function e(e,i){void 0===e&&(e=3),void 0===i&&(i=2);var r=t.call(this)||this;return r.bounces=e,r.bounciness=i,r}r.c(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.bounces),i=this.bounciness;i<=1&&(i=1.001);var r=Math.pow(i,e),n=1-i,o=(1-r)/n+.5*r,a=t*o,s=Math.log(-a*(1-i)+1)/Math.log(i),c=Math.floor(s),h=c+1,u=(1-Math.pow(i,c))/(n*o),l=.5*(u+(1-Math.pow(i,h))/(n*o)),p=t-l,_=l-u;return-Math.pow(1/i,e-c)/(_*_)*(p-_)*(p+_)}}(p),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.c(e,t),e.prototype.easeInCore=function(t){return t*t*t}}(p),function(t){function e(e,i){void 0===e&&(e=3),void 0===i&&(i=3);var r=t.call(this)||this;return r.oscillations=e,r.springiness=i,r}r.c(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.oscillations),i=Math.max(0,this.springiness);return(0==i?t:(Math.exp(i*t)-1)/(Math.exp(i)-1))*Math.sin((6.283185307179586*e+1.5707963267948966)*t)}}(p),function(t){function e(e){void 0===e&&(e=2);var i=t.call(this)||this;return i.exponent=e,i}return r.c(e,t),e.prototype.easeInCore=function(t){return this.exponent<=0?t:(Math.exp(this.exponent*t)-1)/(Math.exp(this.exponent)-1)},e}(p)),d=(function(t){function e(e){void 0===e&&(e=2);var i=t.call(this)||this;return i.power=e,i}r.c(e,t),e.prototype.easeInCore=function(t){var e=Math.max(0,this.power);return Math.pow(t,e)}}(p),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.c(e,t),e.prototype.easeInCore=function(t){return t*t}}(p),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.c(e,t),e.prototype.easeInCore=function(t){return t*t*t*t}}(p),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.c(e,t),e.prototype.easeInCore=function(t){return t*t*t*t*t}}(p),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.c(e,t),e.prototype.easeInCore=function(t){return 1-Math.sin(1.5707963267948966*(1-t))}}(p),function(t){function e(e,i,r,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=1);var o=t.call(this)||this;return o.x1=e,o.y1=i,o.x2=r,o.y2=n,o}r.c(e,t),e.prototype.easeInCore=function(t){return a.BezierCurve.Interpolate(t,this.x1,this.y1,this.x2,this.y2)}}(p),i(14)),f=function(){function t(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}return Object.defineProperty(t.prototype,"name",{get:function(){return"Bouncing"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoTransitionRange",{get:function(){return this._autoTransitionRange},set:function(t){var e=this;if(this._autoTransitionRange!==t){this._autoTransitionRange=t;var i=this._attachedCamera;i&&(t?this._onMeshTargetChangedObserver=i.onMeshTargetChangedObservable.add(function(t){if(t){t.computeWorldMatrix(!0);var i=t.getBoundingInfo().diagonalLength;e.lowerRadiusTransitionRange=.05*i,e.upperRadiusTransitionRange=.05*i}}):this._onMeshTargetChangedObserver&&i.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(t){var e=this;this._attachedCamera=t,this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add(function(){e._attachedCamera&&(e._isRadiusAtLimit(e._attachedCamera.lowerRadiusLimit)&&e._applyBoundRadiusAnimation(e.lowerRadiusTransitionRange),e._isRadiusAtLimit(e._attachedCamera.upperRadiusLimit)&&e._applyBoundRadiusAnimation(e.upperRadiusTransitionRange))})},t.prototype.detach=function(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)},t.prototype._isRadiusAtLimit=function(t){return!!this._attachedCamera&&(this._attachedCamera.radius===t&&!this._radiusIsAnimating)},t.prototype._applyBoundRadiusAnimation=function(e){var i=this;if(this._attachedCamera){this._radiusBounceTransition||(t.EasingFunction.setEasingMode(t.EasingMode),this._radiusBounceTransition=d.a.CreateAnimation("radius",d.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;var r=d.a.TransitionTo("radius",this._attachedCamera.radius+e,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,function(){return i._clearAnimationLocks()});r&&this._animatables.push(r)}},t.prototype._clearAnimationLocks=function(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)},t.prototype.stopAllAnimations=function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()},t.EasingFunction=new _(.3),t.EasingMode=p.EASINGMODE_EASEOUT,t}(),g=i(7),y=function(){function t(){this._mode=t.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}return Object.defineProperty(t.prototype,"name",{get:function(){return"Framing"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radiusScale",{get:function(){return this._radiusScale},set:function(t){this._radiusScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positionScale",{get:function(){return this._positionScale},set:function(t){this._positionScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultElevation",{get:function(){return this._defaultElevation},set:function(t){this._defaultElevation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elevationReturnTime",{get:function(){return this._elevationReturnTime},set:function(t){this._elevationReturnTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elevationReturnWaitTime",{get:function(){return this._elevationReturnWaitTime},set:function(t){this._elevationReturnWaitTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomStopsAnimation",{get:function(){return this._zoomStopsAnimation},set:function(t){this._zoomStopsAnimation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framingTime",{get:function(){return this._framingTime},set:function(t){this._framingTime=t},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.attach=function(e){var i=this;this._attachedCamera=e;var r=this._attachedCamera.getScene();t.EasingFunction.setEasingMode(t.EasingMode),this._onPrePointerObservableObserver=r.onPrePointerObservable.add(function(t){t.type!==h.a.POINTERDOWN?t.type===h.a.POINTERUP&&(i._isPointerDown=!1):i._isPointerDown=!0}),this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add(function(t){t&&i.zoomOnMesh(t)}),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add(function(){i._applyUserInteraction(),i._maintainCameraAboveGround()})},t.prototype.detach=function(){if(this._attachedCamera){var t=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&t.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}},t.prototype.zoomOnMesh=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=null),t.computeWorldMatrix(!0);var r=t.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(r.minimumWorld,r.maximumWorld,e,i)},t.prototype.zoomOnMeshHierarchy=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=null),t.computeWorldMatrix(!0);var r=t.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(r.min,r.max,e,i)},t.prototype.zoomOnMeshesHierarchy=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=null);for(var r=new a.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=new a.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),o=0;o<t.length;o++){var s=t[o].getHierarchyBoundingVectors(!0);g.c.CheckExtends(s.min,r,n),g.c.CheckExtends(s.max,r,n)}this.zoomOnBoundingInfo(r,n,e,i)},t.prototype.zoomOnBoundingInfo=function(e,i,r,n){var o,s=this;if(void 0===r&&(r=!1),void 0===n&&(n=null),this._attachedCamera){var c=e.y,h=c+(i.y-c)*this._positionScale,u=i.subtract(e).scale(.5);if(r)o=new a.Vector3(0,h,0);else{var l=e.add(u);o=new a.Vector3(l.x,h,l.z)}this._vectorTransition||(this._vectorTransition=d.a.CreateAnimation("target",d.a.ANIMATIONTYPE_VECTOR3,60,t.EasingFunction)),this._betaIsAnimating=!0;var p=d.a.TransitionTo("target",o,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);p&&this._animatables.push(p);var _=0;if(this._mode===t.FitFrustumSidesMode){var m=this._calculateLowerRadiusFromModelBoundingSphere(e,i);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=u.length()+this._attachedCamera.minZ),_=m}else this._mode===t.IgnoreBoundsSizeMode&&(_=this._calculateLowerRadiusFromModelBoundingSphere(e,i),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){var f=i.subtract(e).length();this._attachedCamera.panningSensibility=5e3/f,this._attachedCamera.wheelPrecision=100/_}this._radiusTransition||(this._radiusTransition=d.a.CreateAnimation("radius",d.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction)),(p=d.a.TransitionTo("radius",_,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,function(){s.stopAllAnimations(),n&&n(),s._attachedCamera&&s._attachedCamera.useInputToRestoreState&&s._attachedCamera.storeState()}))&&this._animatables.push(p)}},t.prototype._calculateLowerRadiusFromModelBoundingSphere=function(e,i){var r=i.subtract(e).length(),n=this._getFrustumSlope(),o=.5*r*this._radiusScale,a=o*Math.sqrt(1+1/(n.x*n.x)),s=o*Math.sqrt(1+1/(n.y*n.y)),c=Math.max(a,s),h=this._attachedCamera;return h?(h.lowerRadiusLimit&&this._mode===t.IgnoreBoundsSizeMode&&(c=c<h.lowerRadiusLimit?h.lowerRadiusLimit:c),h.upperRadiusLimit&&(c=c>h.upperRadiusLimit?h.upperRadiusLimit:c),c):0},t.prototype._maintainCameraAboveGround=function(){var e=this;if(!(this._elevationReturnTime<0)){var i=u.a.Now-this._lastInteractionTime,r=.5*Math.PI-this._defaultElevation,n=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>n&&i>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=d.a.CreateAnimation("beta",d.a.ANIMATIONTYPE_FLOAT,60,t.EasingFunction));var o=d.a.TransitionTo("beta",r,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,function(){e._clearAnimationLocks(),e.stopAllAnimations()});o&&this._animatables.push(o)}}},t.prototype._getFrustumSlope=function(){var t=this._attachedCamera;if(!t)return a.Vector2.Zero();var e=t.getScene().getEngine().getAspectRatio(t),i=Math.tan(t.fov/2),r=i*e;return new a.Vector2(r,i)},t.prototype._clearAnimationLocks=function(){this._betaIsAnimating=!1},t.prototype._applyUserInteraction=function(){this.isUserIsMoving&&(this._lastInteractionTime=u.a.Now,this.stopAllAnimations(),this._clearAnimationLocks())},t.prototype.stopAllAnimations=function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()},Object.defineProperty(t.prototype,"isUserIsMoving",{get:function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)},enumerable:!0,configurable:!0}),t.EasingFunction=new m,t.EasingMode=p.EASINGMODE_EASEINOUT,t.IgnoreBoundsSizeMode=0,t.FitFrustumSidesMode=1,t}(),v=i(47),b=i(17),T=function(t){function e(e,i,r,n){void 0===n&&(n=!0);var o=t.call(this,e,i,r,n)||this;return o.cameraDirection=new a.Vector3(0,0,0),o.cameraRotation=new a.Vector2(0,0),o.updateUpVectorFromRotation=!1,o._tmpQuaternion=new a.Quaternion,o.rotation=new a.Vector3(0,0,0),o.speed=2,o.noRotationConstraint=!1,o.lockedTarget=null,o._currentTarget=a.Vector3.Zero(),o._initialFocalDistance=1,o._viewMatrix=a.Matrix.Zero(),o._camMatrix=a.Matrix.Zero(),o._cameraTransformMatrix=a.Matrix.Zero(),o._cameraRotationMatrix=a.Matrix.Zero(),o._referencePoint=new a.Vector3(0,0,1),o._transformedReferencePoint=a.Vector3.Zero(),o._globalCurrentTarget=a.Vector3.Zero(),o._globalCurrentUpVector=a.Vector3.Zero(),o._defaultUp=a.Vector3.Up(),o._cachedRotationZ=0,o._cachedQuaternionRotationZ=0,o}return r.c(e,t),e.prototype.getFrontPosition=function(t){this.getWorldMatrix();var e=this.getTarget().subtract(this.position);return e.normalize(),e.scaleInPlace(t),this.globalPosition.add(e)},e.prototype._getLockedTargetPosition=function(){return this.lockedTarget?(this.lockedTarget.absolutePosition&&this.lockedTarget.computeWorldMatrix(),this.lockedTarget.absolutePosition||this.lockedTarget):null},e.prototype.storeState=function(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),t.prototype.storeState.call(this)},e.prototype._restoreStateValues=function(){return!!t.prototype._restoreStateValues.call(this)&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0)},e.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache.lockedTarget=new a.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new a.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new a.Quaternion(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},e.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this);var i=this._getLockedTargetPosition();i?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(i):this._cache.lockedTarget=i.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)},e.prototype._isSynchronizedViewMatrix=function(){if(!t.prototype._isSynchronizedViewMatrix.call(this))return!1;var e=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(e):!e)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))},e.prototype._computeLocalCameraSpeed=function(){var t=this.getEngine();return this.speed*Math.sqrt(t.getDeltaTime()/(100*t.getFps()))},e.prototype.setTarget=function(t){this.upVector.normalize(),this._initialFocalDistance=t.subtract(this.position).length(),this.position.z===t.z&&(this.position.z+=a.Epsilon),a.Matrix.LookAtLHToRef(this.position,t,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);var e=t.subtract(this.position);e.x>=0?this.rotation.y=-Math.atan(e.z/e.x)+Math.PI/2:this.rotation.y=-Math.atan(e.z/e.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&a.Quaternion.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)},e.prototype.getTarget=function(){return this._currentTarget},e.prototype._decideIfNeedsToMove=function(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0},e.prototype._updatePosition=function(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(a.Tmp.Matrix[0]),a.Vector3.TransformNormalToRef(this.cameraDirection,a.Tmp.Matrix[0],a.Tmp.Vector3[0]),void this.position.addInPlace(a.Tmp.Vector3[0]);this.position.addInPlace(this.cameraDirection)},e.prototype._checkInputs=function(){var e=this._decideIfNeedsToMove(),i=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0;if(e&&this._updatePosition(),i){if(this.rotation.x+=this.cameraRotation.x,this.rotation.y+=this.cameraRotation.y,this.rotationQuaternion)this.rotation.lengthSquared()&&a.Quaternion.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion);if(!this.noRotationConstraint){var r=Math.PI/2*.95;this.rotation.x>r&&(this.rotation.x=r),this.rotation.x<-r&&(this.rotation.x=-r)}}e&&(Math.abs(this.cameraDirection.x)<this.speed*a.Epsilon&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*a.Epsilon&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*a.Epsilon&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),i&&(Math.abs(this.cameraRotation.x)<this.speed*a.Epsilon&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*a.Epsilon&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),t.prototype._checkInputs.call(this)},e.prototype._updateCameraRotationMatrix=function(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):a.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)},e.prototype._rotateUpVectorWithCameraRotationMatrix=function(){return a.Vector3.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this},e.prototype._getViewMatrix=function(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!=this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),a.Vector3.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?a.Axis.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(a.Quaternion.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),a.Axis.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix},e.prototype._computeViewMatrix=function(t,e,i){if(this.parent){var r=this.parent.getWorldMatrix();a.Vector3.TransformCoordinatesToRef(t,r,this._globalPosition),a.Vector3.TransformCoordinatesToRef(e,r,this._globalCurrentTarget),a.Vector3.TransformNormalToRef(i,r,this._globalCurrentUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(t),this._globalCurrentTarget.copyFrom(e),this._globalCurrentUpVector.copyFrom(i);this.getScene().useRightHandedSystem?a.Matrix.LookAtRHToRef(this._globalPosition,this._globalCurrentTarget,this._globalCurrentUpVector,this._viewMatrix):a.Matrix.LookAtLHToRef(this._globalPosition,this._globalCurrentTarget,this._globalCurrentUpVector,this._viewMatrix)},e.prototype.createRigCamera=function(t,i){if(this.cameraRigMode!==b.a.RIG_MODE_NONE){var r=new e(t,this.position.clone(),this.getScene());return this.cameraRigMode!==b.a.RIG_MODE_VR&&this.cameraRigMode!==b.a.RIG_MODE_WEBVR||(this.rotationQuaternion||(this.rotationQuaternion=new a.Quaternion),r._cameraRigParams={},r.rotationQuaternion=new a.Quaternion),r}return null},e.prototype._updateRigCameras=function(){var e=this._rigCameras[0],i=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case b.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case b.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:var r=this.cameraRigMode===b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,n=this.cameraRigMode===b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*r,e),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*n,i);break;case b.a.RIG_MODE_VR:e.rotationQuaternion?(e.rotationQuaternion.copyFrom(this.rotationQuaternion),i.rotationQuaternion.copyFrom(this.rotationQuaternion)):(e.rotation.copyFrom(this.rotation),i.rotation.copyFrom(this.rotation)),e.position.copyFrom(this.position),i.position.copyFrom(this.position)}t.prototype._updateRigCameras.call(this)},e.prototype._getRigCamPositionAndTarget=function(t,i){this.getTarget().subtractToRef(this.position,e._TargetFocalPoint),e._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);var r=e._TargetFocalPoint.addInPlace(this.position);a.Matrix.TranslationToRef(-r.x,-r.y,-r.z,e._TargetTransformMatrix),e._TargetTransformMatrix.multiplyToRef(a.Matrix.RotationY(t),e._RigCamTransformMatrix),a.Matrix.TranslationToRef(r.x,r.y,r.z,e._TargetTransformMatrix),e._RigCamTransformMatrix.multiplyToRef(e._TargetTransformMatrix,e._RigCamTransformMatrix),a.Vector3.TransformCoordinatesToRef(this.position,e._RigCamTransformMatrix,i.position),i.setTarget(r)},e.prototype.getClassName=function(){return"TargetCamera"},e._RigCamTransformMatrix=new a.Matrix,e._TargetTransformMatrix=new a.Matrix,e._TargetFocalPoint=new a.Vector3,r.b([Object(n.k)()],e.prototype,"rotation",void 0),r.b([Object(n.c)()],e.prototype,"speed",void 0),r.b([Object(n.h)("lockedTargetId")],e.prototype,"lockedTarget",void 0),e}(b.a),O=i(9),P={},A=function(){function t(t){this.attached={},this.camera=t,this.checkInputs=function(){}}return t.prototype.add=function(t){var e=t.getSimpleName();this.attached[e]?O.a.Warn("camera input of type "+e+" already exists on camera"):(this.attached[e]=t,t.camera=this.camera,t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t))),this.attachedElement&&t.attachControl(this.attachedElement))},t.prototype.remove=function(t){for(var e in this.attached){var i=this.attached[e];i===t&&(i.detachControl(this.attachedElement),i.camera=null,delete this.attached[e],this.rebuildInputCheck())}},t.prototype.removeByType=function(t){for(var e in this.attached){var i=this.attached[e];i.getClassName()===t&&(i.detachControl(this.attachedElement),i.camera=null,delete this.attached[e],this.rebuildInputCheck())}},t.prototype._addCheckInputs=function(t){var e=this.checkInputs;return function(){e(),t()}},t.prototype.attachInput=function(t){this.attachedElement&&t.attachControl(this.attachedElement,this.noPreventDefault)},t.prototype.attachElement=function(t,e){if(void 0===e&&(e=!1),!this.attachedElement)for(var i in e=!b.a.ForceAttachControlToAlwaysPreventDefault&&e,this.attachedElement=t,this.noPreventDefault=e,this.attached)this.attached[i].attachControl(t,e)},t.prototype.detachElement=function(t,e){if(void 0===e&&(e=!1),this.attachedElement===t){for(var i in this.attached)this.attached[i].detachControl(t),e&&(this.attached[i].camera=null);this.attachedElement=null}},t.prototype.rebuildInputCheck=function(){for(var t in this.checkInputs=function(){},this.attached){var e=this.attached[t];e.checkInputs&&(this.checkInputs=this._addCheckInputs(e.checkInputs.bind(e)))}},t.prototype.clear=function(){this.attachedElement&&this.detachElement(this.attachedElement,!0),this.attached={},this.attachedElement=null,this.checkInputs=function(){}},t.prototype.serialize=function(t){var e={};for(var i in this.attached){var r=this.attached[i],o=n.a.Serialize(r);e[r.getClassName()]=o}t.inputsmgr=e},t.prototype.parse=function(t){var e=t.inputsmgr;if(e)for(var i in this.clear(),e){if(a=P[i]){var r=e[i],o=n.a.Parse(function(){return new a},r,null);this.add(o)}}else for(var i in this.attached){var a;if(a=P[this.attached[i].getClassName()]){o=n.a.Parse(function(){return new a},t,null);this.remove(this.attached[i]),this.add(o)}}},t}(),M=function(){function t(){this.alphaCorrection=1,this.gammaCorrection=1,this._alpha=0,this._gamma=0,this._dirty=!1,this._deviceOrientationHandler=this._onOrientationEvent.bind(this)}return t.prototype.attachControl=function(t,e){this.camera.attachControl(t,e),window.addEventListener("deviceorientation",this._deviceOrientationHandler)},t.prototype._onOrientationEvent=function(t){null!==t.alpha&&(this._alpha=(0|+t.alpha)*this.alphaCorrection),null!==t.gamma&&(this._gamma=(0|+t.gamma)*this.gammaCorrection),this._dirty=!0},t.prototype.checkInputs=function(){this._dirty&&(this._dirty=!1,this._gamma<0&&(this._gamma=180+this._gamma),this.camera.alpha=-this._alpha/180*Math.PI%Math.PI*2,this.camera.beta=this._gamma/180*Math.PI)},t.prototype.detachControl=function(t){window.removeEventListener("deviceorientation",this._deviceOrientationHandler)},t.prototype.getClassName=function(){return"ArcRotateCameraVRDeviceOrientationInput"},t.prototype.getSimpleName=function(){return"VRDeviceOrientation"},t}();P.ArcRotateCameraVRDeviceOrientationInput=M;var R=function(){function t(){this.buttons=[0,1,2],this.angularSensibilityX=1e3,this.angularSensibilityY=1e3,this.pinchPrecision=12,this.pinchDeltaPercentage=0,this.panningSensibility=1e3,this.multiTouchPanning=!0,this.multiTouchPanAndZoom=!0,this.pinchInwards=!0,this._isPanClick=!1}return t.prototype.attachControl=function(t,e){var i,r=this,n=this.camera.getEngine(),o=null,a=null,s=0,c=0,u=0,l={x:0,y:0,isPaning:!1,isPinching:!1};this._pointerInput=function(p,_){var m=p.event,d="touch"===p.event.pointerType;if(!n.isInVRExclusivePointerMode&&(p.type===h.a.POINTERMOVE||-1!==r.buttons.indexOf(m.button))){var f=m.srcElement||m.target;if(p.type===h.a.POINTERDOWN&&f){try{f.setPointerCapture(m.pointerId)}catch(t){}r._isPanClick=m.button===r.camera._panningMouseButton,i={x:m.clientX,y:m.clientY,pointerId:m.pointerId,type:m.pointerType},null===o?o=i:null===a&&(a=i),e||(m.preventDefault(),t.focus())}else if(p.type===h.a.POINTERDOUBLETAP)r.camera.useInputToRestoreState&&r.camera.restoreState();else if(p.type===h.a.POINTERUP&&f){try{f.releasePointerCapture(m.pointerId)}catch(t){}i=null,s=0,l.isPaning=!1,l.isPinching=!1,u=0,c=0,d||(a=null),n._badOS?o=a=null:a&&o&&o.pointerId==m.pointerId?(o=a,a=null,i={x:o.x,y:o.y,pointerId:o.pointerId,type:m.pointerType}):o&&a&&a.pointerId==m.pointerId?(a=null,i={x:o.x,y:o.y,pointerId:o.pointerId,type:m.pointerType}):o=a=null,e||m.preventDefault()}else if(p.type===h.a.POINTERMOVE)if(e||m.preventDefault(),o&&null===a&&i){if(0!==r.panningSensibility&&(m.ctrlKey&&r.camera._useCtrlForPanning||r._isPanClick))r.camera.inertialPanningX+=-(m.clientX-i.x)/r.panningSensibility,r.camera.inertialPanningY+=(m.clientY-i.y)/r.panningSensibility;else{var g=m.clientX-i.x,y=m.clientY-i.y;r.camera.inertialAlphaOffset-=g/r.angularSensibilityX,r.camera.inertialBetaOffset-=y/r.angularSensibilityY}i.x=m.clientX,i.y=m.clientY}else if(o&&a){var v=o.pointerId===m.pointerId?o:a;v.x=m.clientX,v.y=m.clientY;var b=r.pinchInwards?1:-1,T=o.x-a.x,O=o.y-a.y,P=T*T+O*O,A=Math.sqrt(P);if(0===s)return c=A,s=P,l.x=(o.x+a.x)/2,void(l.y=(o.y+a.y)/2);if(r.multiTouchPanAndZoom){if(r.pinchDeltaPercentage?r.camera.inertialRadiusOffset+=.001*(P-s)*r.camera.radius*r.pinchDeltaPercentage:r.camera.inertialRadiusOffset+=(P-s)/(r.pinchPrecision*((r.angularSensibilityX+r.angularSensibilityY)/2)*b),0!==r.panningSensibility){var M=(o.x+a.x)/2,R=(o.y+a.y)/2,I=M-l.x,C=R-l.y;l.x=M,l.y=R,r.camera.inertialPanningX+=-I/r.panningSensibility,r.camera.inertialPanningY+=C/r.panningSensibility}}else{if(u++,l.isPinching||u<20&&Math.abs(A-c)>r.camera.pinchToPanMaxDistance)r.pinchDeltaPercentage?r.camera.inertialRadiusOffset+=.001*(P-s)*r.camera.radius*r.pinchDeltaPercentage:r.camera.inertialRadiusOffset+=(P-s)/(r.pinchPrecision*((r.angularSensibilityX+r.angularSensibilityY)/2)*b),l.isPaning=!1,l.isPinching=!0;else if(i&&i.pointerId===v.pointerId&&0!==r.panningSensibility&&r.multiTouchPanning){if(!l.isPaning)return l.isPaning=!0,l.isPinching=!1,l.x=v.x,void(l.y=v.y);r.camera.inertialPanningX+=-(v.x-l.x)/r.panningSensibility,r.camera.inertialPanningY+=(v.y-l.y)/r.panningSensibility}i&&i.pointerId===m.pointerId&&(l.x=v.x,l.y=v.y)}s=P}}},this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,h.a.POINTERDOWN|h.a.POINTERUP|h.a.POINTERMOVE|h.a.POINTERDOUBLETAP),this._onContextMenu=function(t){t.preventDefault()},this.camera._useCtrlForPanning||t.addEventListener("contextmenu",this._onContextMenu,!1),this._onLostFocus=function(){o=a=null,s=0,l.isPaning=!1,l.isPinching=!1,u=0,i=null,c=0},this._onMouseMove=function(t){if(n.isPointerLock){var i=t.movementX||t.mozMovementX||t.webkitMovementX||t.msMovementX||0,o=t.movementY||t.mozMovementY||t.webkitMovementY||t.msMovementY||0;r.camera.inertialAlphaOffset-=i/r.angularSensibilityX,r.camera.inertialBetaOffset-=o/r.angularSensibilityY,e||t.preventDefault()}},this._onGestureStart=function(e){void 0!==window.MSGesture&&(r._MSGestureHandler||(r._MSGestureHandler=new MSGesture,r._MSGestureHandler.target=t),r._MSGestureHandler.addPointer(e.pointerId))},this._onGesture=function(t){r.camera.radius*=t.scale,t.preventDefault&&(e||(t.stopPropagation(),t.preventDefault()))},t.addEventListener("mousemove",this._onMouseMove,!1),t.addEventListener("MSPointerDown",this._onGestureStart,!1),t.addEventListener("MSGestureChange",this._onGesture,!1),g.c.RegisterTopRootEvents([{name:"blur",handler:this._onLostFocus}])},t.prototype.detachControl=function(t){this._onLostFocus&&g.c.UnregisterTopRootEvents([{name:"blur",handler:this._onLostFocus}]),t&&this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this._onContextMenu&&t.removeEventListener("contextmenu",this._onContextMenu),this._onMouseMove&&t.removeEventListener("mousemove",this._onMouseMove),this._onGestureStart&&t.removeEventListener("MSPointerDown",this._onGestureStart),this._onGesture&&t.removeEventListener("MSGestureChange",this._onGesture),this._isPanClick=!1,this.pinchInwards=!0,this._onMouseMove=null,this._onGestureStart=null,this._onGesture=null,this._MSGestureHandler=null,this._onLostFocus=null,this._onContextMenu=null)},t.prototype.getClassName=function(){return"ArcRotateCameraPointersInput"},t.prototype.getSimpleName=function(){return"pointers"},r.b([Object(n.c)()],t.prototype,"buttons",void 0),r.b([Object(n.c)()],t.prototype,"angularSensibilityX",void 0),r.b([Object(n.c)()],t.prototype,"angularSensibilityY",void 0),r.b([Object(n.c)()],t.prototype,"pinchPrecision",void 0),r.b([Object(n.c)()],t.prototype,"pinchDeltaPercentage",void 0),r.b([Object(n.c)()],t.prototype,"panningSensibility",void 0),r.b([Object(n.c)()],t.prototype,"multiTouchPanning",void 0),r.b([Object(n.c)()],t.prototype,"multiTouchPanAndZoom",void 0),t}();P.ArcRotateCameraPointersInput=R;var I=i(36),C=function(){function t(){this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}return t.prototype.attachControl=function(t,e){var i=this;this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(function(){i._keys=[]}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(function(t){var r,n=t.event;n.metaKey||(t.type===I.a.KEYDOWN?(i._ctrlPressed=n.ctrlKey,i._altPressed=n.altKey,(-1!==i.keysUp.indexOf(n.keyCode)||-1!==i.keysDown.indexOf(n.keyCode)||-1!==i.keysLeft.indexOf(n.keyCode)||-1!==i.keysRight.indexOf(n.keyCode)||-1!==i.keysReset.indexOf(n.keyCode))&&(-1===(r=i._keys.indexOf(n.keyCode))&&i._keys.push(n.keyCode),n.preventDefault&&(e||n.preventDefault()))):-1===i.keysUp.indexOf(n.keyCode)&&-1===i.keysDown.indexOf(n.keyCode)&&-1===i.keysLeft.indexOf(n.keyCode)&&-1===i.keysRight.indexOf(n.keyCode)&&-1===i.keysReset.indexOf(n.keyCode)||((r=i._keys.indexOf(n.keyCode))>=0&&i._keys.splice(r,1),n.preventDefault&&(e||n.preventDefault())))}))},t.prototype.detachControl=function(t){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys=[]},t.prototype.checkInputs=function(){if(this._onKeyboardObserver)for(var t=this.camera,e=0;e<this._keys.length;e++){var i=this._keys[e];-1!==this.keysLeft.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX-=1/this.panningSensibility:t.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset+=1/this.zoomingSensibility:t.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningX+=1/this.panningSensibility:t.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?t.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?t.inertialRadiusOffset-=1/this.zoomingSensibility:t.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(i)&&t.useInputToRestoreState&&t.restoreState()}},t.prototype.getClassName=function(){return"ArcRotateCameraKeyboardMoveInput"},t.prototype.getSimpleName=function(){return"keyboard"},r.b([Object(n.c)()],t.prototype,"keysUp",void 0),r.b([Object(n.c)()],t.prototype,"keysDown",void 0),r.b([Object(n.c)()],t.prototype,"keysLeft",void 0),r.b([Object(n.c)()],t.prototype,"keysRight",void 0),r.b([Object(n.c)()],t.prototype,"keysReset",void 0),r.b([Object(n.c)()],t.prototype,"panningSensibility",void 0),r.b([Object(n.c)()],t.prototype,"zoomingSensibility",void 0),r.b([Object(n.c)()],t.prototype,"useAltToZoom",void 0),r.b([Object(n.c)()],t.prototype,"angularSpeed",void 0),t}();P.ArcRotateCameraKeyboardMoveInput=C;var E=function(){function t(){this.wheelPrecision=3,this.wheelDeltaPercentage=0}return t.prototype.attachControl=function(t,e){var i=this;this._wheel=function(t,r){if(t.type===h.a.POINTERWHEEL){var n=t.event,o=0,a=n;if(a.wheelDelta)if(i.wheelDeltaPercentage){var s=.01*a.wheelDelta*i.wheelDeltaPercentage*i.camera.radius;o=a.wheelDelta>0?s/(1+i.wheelDeltaPercentage):s*(1+i.wheelDeltaPercentage)}else o=a.wheelDelta/(40*i.wheelPrecision);else o=-(n.deltaY||n.detail)/i.wheelPrecision;o&&(i.camera.inertialRadiusOffset+=o),n.preventDefault&&(e||n.preventDefault())}},this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,h.a.POINTERWHEEL)},t.prototype.detachControl=function(t){this._observer&&t&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this._wheel=null)},t.prototype.getClassName=function(){return"ArcRotateCameraMouseWheelInput"},t.prototype.getSimpleName=function(){return"mousewheel"},r.b([Object(n.c)()],t.prototype,"wheelPrecision",void 0),r.b([Object(n.c)()],t.prototype,"wheelDeltaPercentage",void 0),t}();P.ArcRotateCameraMouseWheelInput=E;var x=function(t){function e(e){return t.call(this,e)||this}return r.c(e,t),e.prototype.addMouseWheel=function(){return this.add(new E),this},e.prototype.addPointers=function(){return this.add(new R),this},e.prototype.addKeyboard=function(){return this.add(new C),this},e.prototype.addVRDeviceOrientation=function(){return this.add(new M),this},e}(A);i.d(e,"ArcRotateCamera",function(){return V}),s.a.AddNodeConstructor("ArcRotateCamera",function(t,e){return function(){return new V(t,0,0,1,a.Vector3.Zero(),e)}});var V=function(t){function e(e,i,r,n,s,c,h){void 0===h&&(h=!0);var u=t.call(this,e,a.Vector3.Zero(),c,h)||this;return u.inertialAlphaOffset=0,u.inertialBetaOffset=0,u.inertialRadiusOffset=0,u.lowerAlphaLimit=null,u.upperAlphaLimit=null,u.lowerBetaLimit=.01,u.upperBetaLimit=Math.PI-.01,u.lowerRadiusLimit=null,u.upperRadiusLimit=null,u.inertialPanningX=0,u.inertialPanningY=0,u.pinchToPanMaxDistance=20,u.panningDistanceLimit=null,u.panningOriginTarget=a.Vector3.Zero(),u.panningInertia=.9,u.zoomOnFactor=1,u.targetScreenOffset=a.Vector2.Zero(),u.allowUpsideDown=!0,u.useInputToRestoreState=!0,u._viewMatrix=new a.Matrix,u.panningAxis=new a.Vector3(1,1,0),u.onMeshTargetChangedObservable=new o.a,u.checkCollisions=!1,u.collisionRadius=new a.Vector3(.5,.5,.5),u._previousPosition=a.Vector3.Zero(),u._collisionVelocity=a.Vector3.Zero(),u._newPosition=a.Vector3.Zero(),u._computationVector=a.Vector3.Zero(),u._onCollisionPositionChange=function(t,e,i){void 0===i&&(i=null),i?(u.setPosition(e),u.onCollide&&u.onCollide(i)):u._previousPosition.copyFrom(u.position);var r=Math.cos(u.alpha),n=Math.sin(u.alpha),o=Math.cos(u.beta),a=Math.sin(u.beta);0===a&&(a=1e-4);var s=u._getTargetPosition();u._computationVector.copyFromFloats(u.radius*r*a,u.radius*o,u.radius*n*a),s.addToRef(u._computationVector,u._newPosition),u.position.copyFrom(u._newPosition);var c=u.upVector;u.allowUpsideDown&&u.beta<0&&(c=(c=c.clone()).negate()),u._computeViewMatrix(u.position,s,c),u._viewMatrix.addAtIndex(12,u.targetScreenOffset.x),u._viewMatrix.addAtIndex(13,u.targetScreenOffset.y),u._collisionTriggered=!1},u._target=a.Vector3.Zero(),s&&u.setTarget(s),u.alpha=i,u.beta=r,u.radius=n,u.getViewMatrix(),u.inputs=new x(u),u.inputs.addKeyboard().addMouseWheel().addPointers(),u}return r.c(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this.setTarget(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angularSensibilityX",{get:function(){var t=this.inputs.attached.pointers;return t?t.angularSensibilityX:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.angularSensibilityX=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angularSensibilityY",{get:function(){var t=this.inputs.attached.pointers;return t?t.angularSensibilityY:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.angularSensibilityY=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pinchPrecision",{get:function(){var t=this.inputs.attached.pointers;return t?t.pinchPrecision:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.pinchPrecision=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pinchDeltaPercentage",{get:function(){var t=this.inputs.attached.pointers;return t?t.pinchDeltaPercentage:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.pinchDeltaPercentage=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panningSensibility",{get:function(){var t=this.inputs.attached.pointers;return t?t.panningSensibility:0},set:function(t){var e=this.inputs.attached.pointers;e&&(e.panningSensibility=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keysUp",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysUp:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysUp=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keysDown",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysDown:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysDown=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keysLeft",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysLeft:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysLeft=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keysRight",{get:function(){var t=this.inputs.attached.keyboard;return t?t.keysRight:[]},set:function(t){var e=this.inputs.attached.keyboard;e&&(e.keysRight=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wheelPrecision",{get:function(){var t=this.inputs.attached.mousewheel;return t?t.wheelPrecision:0},set:function(t){var e=this.inputs.attached.mousewheel;e&&(e.wheelPrecision=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wheelDeltaPercentage",{get:function(){var t=this.inputs.attached.mousewheel;return t?t.wheelDeltaPercentage:0},set:function(t){var e=this.inputs.attached.mousewheel;e&&(e.wheelDeltaPercentage=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bouncingBehavior",{get:function(){return this._bouncingBehavior},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBouncingBehavior",{get:function(){return null!=this._bouncingBehavior},set:function(t){t!==this.useBouncingBehavior&&(t?(this._bouncingBehavior=new f,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"framingBehavior",{get:function(){return this._framingBehavior},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useFramingBehavior",{get:function(){return null!=this._framingBehavior},set:function(t){t!==this.useFramingBehavior&&(t?(this._framingBehavior=new y,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoRotationBehavior",{get:function(){return this._autoRotationBehavior},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useAutoRotationBehavior",{get:function(){return null!=this._autoRotationBehavior},set:function(t){t!==this.useAutoRotationBehavior&&(t?(this._autoRotationBehavior=new l,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))},enumerable:!0,configurable:!0}),e.prototype._initCache=function(){t.prototype._initCache.call(this),this._cache._target=new a.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=a.Vector2.Zero()},e.prototype._updateCache=function(e){e||t.prototype._updateCache.call(this),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)},e.prototype._getTargetPosition=function(){if(this._targetHost&&this._targetHost.getAbsolutePosition){var t=this._targetHost.absolutePosition;this._targetBoundingCenter?t.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(t)}var e=this._getLockedTargetPosition();return e||this._target},e.prototype.storeState=function(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),t.prototype.storeState.call(this)},e.prototype._restoreStateValues=function(){return!!t.prototype._restoreStateValues.call(this)&&(this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.setTarget(this._storedTarget.clone()),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0)},e.prototype._isSynchronizedViewMatrix=function(){return!!t.prototype._isSynchronizedViewMatrix.call(this)&&(this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset))},e.prototype.attachControl=function(t,e,i,r){var n=this;void 0===i&&(i=!0),void 0===r&&(r=2),this._useCtrlForPanning=i,this._panningMouseButton=r,this.inputs.attachElement(t,e),this._reset=function(){n.inertialAlphaOffset=0,n.inertialBetaOffset=0,n.inertialRadiusOffset=0,n.inertialPanningX=0,n.inertialPanningY=0}},e.prototype.detachControl=function(t){this.inputs.detachElement(t),this._reset&&this._reset()},e.prototype._checkInputs=function(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){var e=this.inertialAlphaOffset;this.beta<=0&&(e*=-1),this.getScene().useRightHandedSystem&&(e*=-1),this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(e*=-1),this.alpha+=e,this.beta+=this.inertialBetaOffset,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<a.Epsilon&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<a.Epsilon&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*a.Epsilon&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY){if(this._localDirection||(this._localDirection=a.Vector3.Zero(),this._transformedDirection=a.Vector3.Zero()),this._localDirection.copyFromFloats(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY),this._localDirection.multiplyInPlace(this.panningAxis),this._viewMatrix.invertToRef(this._cameraTransformMatrix),a.Vector3.TransformNormalToRef(this._localDirection,this._cameraTransformMatrix,this._transformedDirection),this.panningAxis.y||(this._transformedDirection.y=0),!this._targetHost)if(this.panningDistanceLimit)this._transformedDirection.addInPlace(this._target),a.Vector3.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection);else this._target.addInPlace(this._transformedDirection);this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*a.Epsilon&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*a.Epsilon&&(this.inertialPanningY=0)}this._checkLimits(),t.prototype._checkInputs.call(this)}},e.prototype._checkLimits=function(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)},e.prototype.rebuildAnglesAndRadius=function(){this.position.subtractToRef(this._getTargetPosition(),this._computationVector),this.radius=this._computationVector.length(),0===this.radius&&(this.radius=1e-4),this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha),this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()},e.prototype.setPosition=function(t){this.position.equals(t)||(this.position.copyFrom(t),this.rebuildAnglesAndRadius())},e.prototype.setTarget=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),t.getBoundingInfo)this._targetBoundingCenter=e?t.getBoundingInfo().boundingBox.centerWorld.clone():null,this._targetHost=t,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{var r=t,n=this._getTargetPosition();if(n&&!i&&n.equals(r))return;this._targetHost=null,this._target=r,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}this.rebuildAnglesAndRadius()},e.prototype._getViewMatrix=function(){var t=Math.cos(this.alpha),e=Math.sin(this.alpha),i=Math.cos(this.beta),r=Math.sin(this.beta);0===r&&(r=1e-4);var n=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*t*r,this.radius*i,this.radius*e*r),0!==this.upVector.x||1!==this.upVector.y||0!==this.upVector.z){this._tempAxisVector||(this._tempAxisVector=new a.Vector3,this._tempAxisRotationMatrix=new a.Matrix),a.Vector3.CrossToRef(a.Vector3.Up(),this.upVector,this._tempAxisVector),this._tempAxisVector.normalize();var o=Math.acos(a.Vector3.Dot(a.Vector3.UpReadOnly,this.upVector));a.Matrix.RotationAxisToRef(this._tempAxisVector,o,this._tempAxisRotationMatrix),this._tempAxisVector.copyFrom(this._computationVector),a.Vector3.TransformCoordinatesToRef(this._tempAxisVector,this._tempAxisRotationMatrix,this._computationVector)}if(n.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions)this._collider||(this._collider=new v.a),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this.position,this._collisionVelocity),this._collisionTriggered=!0,this.getScene().collisionCoordinator.getNewPosition(this.position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId);else{this.position.copyFrom(this._newPosition);var s=this.upVector;this.allowUpsideDown&&r<0&&(s=(s=s.clone()).negate()),this._computeViewMatrix(this.position,n,s),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=n,this._viewMatrix},e.prototype.zoomOn=function(t,e){void 0===e&&(e=!1),t=t||this.getScene().meshes;var i=c.a.MinMax(t),r=a.Vector3.Distance(i.min,i.max);this.radius=r*this.zoomOnFactor,this.focusOn({min:i.min,max:i.max,distance:r},e)},e.prototype.focusOn=function(t,e){var i,r;if(void 0===e&&(e=!1),void 0===t.min){var n=t||this.getScene().meshes;i=c.a.MinMax(n),r=a.Vector3.Distance(i.min,i.max)}else{i=t,r=t.distance}this._target=c.a.Center(i),e||(this.maxZ=2*r)},e.prototype.createRigCamera=function(t,i){var r=0;switch(this.cameraRigMode){case b.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case b.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case b.a.RIG_MODE_VR:r=this._cameraRigParams.stereoHalfAngle*(0===i?1:-1);break;case b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:r=this._cameraRigParams.stereoHalfAngle*(0===i?-1:1)}var n=new e(t,this.alpha+r,this.beta,this.radius,this._target,this.getScene());return n._cameraRigParams={},n},e.prototype._updateRigCameras=function(){var e=this._rigCameras[0],i=this._rigCameras[1];switch(e.beta=i.beta=this.beta,this.cameraRigMode){case b.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case b.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case b.a.RIG_MODE_VR:e.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,i.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case b.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:e.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,i.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}t.prototype._updateRigCameras.call(this)},e.prototype.dispose=function(){this.inputs.clear(),t.prototype.dispose.call(this)},e.prototype.getClassName=function(){return"ArcRotateCamera"},r.b([Object(n.c)()],e.prototype,"alpha",void 0),r.b([Object(n.c)()],e.prototype,"beta",void 0),r.b([Object(n.c)()],e.prototype,"radius",void 0),r.b([Object(n.k)("target")],e.prototype,"_target",void 0),r.b([Object(n.c)()],e.prototype,"inertialAlphaOffset",void 0),r.b([Object(n.c)()],e.prototype,"inertialBetaOffset",void 0),r.b([Object(n.c)()],e.prototype,"inertialRadiusOffset",void 0),r.b([Object(n.c)()],e.prototype,"lowerAlphaLimit",void 0),r.b([Object(n.c)()],e.prototype,"upperAlphaLimit",void 0),r.b([Object(n.c)()],e.prototype,"lowerBetaLimit",void 0),r.b([Object(n.c)()],e.prototype,"upperBetaLimit",void 0),r.b([Object(n.c)()],e.prototype,"lowerRadiusLimit",void 0),r.b([Object(n.c)()],e.prototype,"upperRadiusLimit",void 0),r.b([Object(n.c)()],e.prototype,"inertialPanningX",void 0),r.b([Object(n.c)()],e.prototype,"inertialPanningY",void 0),r.b([Object(n.c)()],e.prototype,"pinchToPanMaxDistance",void 0),r.b([Object(n.c)()],e.prototype,"panningDistanceLimit",void 0),r.b([Object(n.k)()],e.prototype,"panningOriginTarget",void 0),r.b([Object(n.c)()],e.prototype,"panningInertia",void 0),r.b([Object(n.c)()],e.prototype,"zoomOnFactor",void 0),r.b([Object(n.c)()],e.prototype,"targetScreenOffset",void 0),r.b([Object(n.c)()],e.prototype,"allowUpsideDown",void 0),r.b([Object(n.c)()],e.prototype,"useInputToRestoreState",void 0),e}(T)}}]);