!function(e){function t(t){for(var r,a,o=t[0],h=t[1],u=t[2],l=0,d=[];l<o.length;l++)a=o[l],n[a]&&d.push(n[a][0]),n[a]=0;for(r in h)Object.prototype.hasOwnProperty.call(h,r)&&(e[r]=h[r]);for(c&&c(t);d.length;)d.shift()();return s.push.apply(s,u||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],r=!0,o=1;o<i.length;o++){var h=i[o];0!==n[h]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=i[0]))}return e}var r={},n={2:0},s=[];function a(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=r,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(i,r,function(t){return e[t]}.bind(null,r));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window.webpackJsonp=window.webpackJsonp||[],h=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=h;s.push([85,1,6,0,5,3,4]),i()}({11:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var r=i(0),n=i(2),s=function(){function e(){}return e.prototype.set=function(e,t){switch(t){case n.b.PositionKind:this.positions=e;break;case n.b.NormalKind:this.normals=e;break;case n.b.TangentKind:this.tangents=e;break;case n.b.UVKind:this.uvs=e;break;case n.b.UV2Kind:this.uvs2=e;break;case n.b.UV3Kind:this.uvs3=e;break;case n.b.UV4Kind:this.uvs4=e;break;case n.b.UV5Kind:this.uvs5=e;break;case n.b.UV6Kind:this.uvs6=e;break;case n.b.ColorKind:this.colors=e;break;case n.b.MatricesIndicesKind:this.matricesIndices=e;break;case n.b.MatricesWeightsKind:this.matricesWeights=e;break;case n.b.MatricesIndicesExtraKind:this.matricesIndicesExtra=e;break;case n.b.MatricesWeightsExtraKind:this.matricesWeightsExtra=e}},e.prototype.applyToMesh=function(e,t){return this._applyTo(e,t),this},e.prototype.applyToGeometry=function(e,t){return this._applyTo(e,t),this},e.prototype.updateMesh=function(e){return this._update(e),this},e.prototype.updateGeometry=function(e){return this._update(e),this},e.prototype._applyTo=function(e,t){return void 0===t&&(t=!1),this.positions&&e.setVerticesData(n.b.PositionKind,this.positions,t),this.normals&&e.setVerticesData(n.b.NormalKind,this.normals,t),this.tangents&&e.setVerticesData(n.b.TangentKind,this.tangents,t),this.uvs&&e.setVerticesData(n.b.UVKind,this.uvs,t),this.uvs2&&e.setVerticesData(n.b.UV2Kind,this.uvs2,t),this.uvs3&&e.setVerticesData(n.b.UV3Kind,this.uvs3,t),this.uvs4&&e.setVerticesData(n.b.UV4Kind,this.uvs4,t),this.uvs5&&e.setVerticesData(n.b.UV5Kind,this.uvs5,t),this.uvs6&&e.setVerticesData(n.b.UV6Kind,this.uvs6,t),this.colors&&e.setVerticesData(n.b.ColorKind,this.colors,t),this.matricesIndices&&e.setVerticesData(n.b.MatricesIndicesKind,this.matricesIndices,t),this.matricesWeights&&e.setVerticesData(n.b.MatricesWeightsKind,this.matricesWeights,t),this.matricesIndicesExtra&&e.setVerticesData(n.b.MatricesIndicesExtraKind,this.matricesIndicesExtra,t),this.matricesWeightsExtra&&e.setVerticesData(n.b.MatricesWeightsExtraKind,this.matricesWeightsExtra,t),this.indices?e.setIndices(this.indices,null,t):e.setIndices([],null),this},e.prototype._update=function(e,t,i){return this.positions&&e.updateVerticesData(n.b.PositionKind,this.positions,t,i),this.normals&&e.updateVerticesData(n.b.NormalKind,this.normals,t,i),this.tangents&&e.updateVerticesData(n.b.TangentKind,this.tangents,t,i),this.uvs&&e.updateVerticesData(n.b.UVKind,this.uvs,t,i),this.uvs2&&e.updateVerticesData(n.b.UV2Kind,this.uvs2,t,i),this.uvs3&&e.updateVerticesData(n.b.UV3Kind,this.uvs3,t,i),this.uvs4&&e.updateVerticesData(n.b.UV4Kind,this.uvs4,t,i),this.uvs5&&e.updateVerticesData(n.b.UV5Kind,this.uvs5,t,i),this.uvs6&&e.updateVerticesData(n.b.UV6Kind,this.uvs6,t,i),this.colors&&e.updateVerticesData(n.b.ColorKind,this.colors,t,i),this.matricesIndices&&e.updateVerticesData(n.b.MatricesIndicesKind,this.matricesIndices,t,i),this.matricesWeights&&e.updateVerticesData(n.b.MatricesWeightsKind,this.matricesWeights,t,i),this.matricesIndicesExtra&&e.updateVerticesData(n.b.MatricesIndicesExtraKind,this.matricesIndicesExtra,t,i),this.matricesWeightsExtra&&e.updateVerticesData(n.b.MatricesWeightsExtraKind,this.matricesWeightsExtra,t,i),this.indices&&e.setIndices(this.indices,null),this},e.prototype.transform=function(e){var t,i=e.m[0]*e.m[5]*e.m[10]<0,n=r.Vector3.Zero();if(this.positions){var s=r.Vector3.Zero();for(t=0;t<this.positions.length;t+=3)r.Vector3.FromArrayToRef(this.positions,t,s),r.Vector3.TransformCoordinatesToRef(s,e,n),this.positions[t]=n.x,this.positions[t+1]=n.y,this.positions[t+2]=n.z}if(this.normals){var a=r.Vector3.Zero();for(t=0;t<this.normals.length;t+=3)r.Vector3.FromArrayToRef(this.normals,t,a),r.Vector3.TransformNormalToRef(a,e,n),this.normals[t]=n.x,this.normals[t+1]=n.y,this.normals[t+2]=n.z}if(this.tangents){var o=r.Vector4.Zero(),h=r.Vector4.Zero();for(t=0;t<this.tangents.length;t+=4)r.Vector4.FromArrayToRef(this.tangents,t,o),r.Vector4.TransformNormalToRef(o,e,h),this.tangents[t]=h.x,this.tangents[t+1]=h.y,this.tangents[t+2]=h.z,this.tangents[t+3]=h.w}if(i&&this.indices)for(t=0;t<this.indices.length;t+=3){var u=this.indices[t+1];this.indices[t+1]=this.indices[t+2],this.indices[t+2]=u}return this},e.prototype.merge=function(e,t){if(void 0===t&&(t=!1),this._validate(),e._validate(),!this.normals!=!e.normals||!this.tangents!=!e.tangents||!this.uvs!=!e.uvs||!this.uvs2!=!e.uvs2||!this.uvs3!=!e.uvs3||!this.uvs4!=!e.uvs4||!this.uvs5!=!e.uvs5||!this.uvs6!=!e.uvs6||!this.colors!=!e.colors||!this.matricesIndices!=!e.matricesIndices||!this.matricesWeights!=!e.matricesWeights||!this.matricesIndicesExtra!=!e.matricesIndicesExtra||!this.matricesWeightsExtra!=!e.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes");if(e.indices){this.indices||(this.indices=[]);var i=this.positions?this.positions.length/3:0;if(void 0!==this.indices.BYTES_PER_ELEMENT){var r=this.indices.length+e.indices.length,n=t||this.indices instanceof Uint32Array?new Uint32Array(r):new Uint16Array(r);n.set(this.indices);for(var s=this.indices.length,a=0;a<e.indices.length;a++)n[s+a]=e.indices[a]+i;this.indices=n}else for(a=0;a<e.indices.length;a++)this.indices.push(e.indices[a]+i)}return this.positions=this._mergeElement(this.positions,e.positions),this.normals=this._mergeElement(this.normals,e.normals),this.tangents=this._mergeElement(this.tangents,e.tangents),this.uvs=this._mergeElement(this.uvs,e.uvs),this.uvs2=this._mergeElement(this.uvs2,e.uvs2),this.uvs3=this._mergeElement(this.uvs3,e.uvs3),this.uvs4=this._mergeElement(this.uvs4,e.uvs4),this.uvs5=this._mergeElement(this.uvs5,e.uvs5),this.uvs6=this._mergeElement(this.uvs6,e.uvs6),this.colors=this._mergeElement(this.colors,e.colors),this.matricesIndices=this._mergeElement(this.matricesIndices,e.matricesIndices),this.matricesWeights=this._mergeElement(this.matricesWeights,e.matricesWeights),this.matricesIndicesExtra=this._mergeElement(this.matricesIndicesExtra,e.matricesIndicesExtra),this.matricesWeightsExtra=this._mergeElement(this.matricesWeightsExtra,e.matricesWeightsExtra),this},e.prototype._mergeElement=function(e,t){if(!e)return t;if(!t)return e;var i=t.length+e.length,r=e instanceof Float32Array,n=t instanceof Float32Array;if(r){var s=new Float32Array(i);return s.set(e),s.set(t,e.length),s}if(n){var a=e.slice(0),o=0;for(i=t.length;o<i;o++)a.push(t[o]);return a}return e.concat(t)},e.prototype._validate=function(){if(!this.positions)throw new Error("Positions are required");var e=function(e,t){var i=n.b.DeduceStride(e);if(t.length%i!=0)throw new Error("The "+e+"s array count must be a multiple of "+i);return t.length/i},t=e(n.b.PositionKind,this.positions),i=function(i,r){var n=e(i,r);if(n!==t)throw new Error("The "+i+"s element count ("+n+") does not match the positions count ("+t+")")};this.normals&&i(n.b.NormalKind,this.normals),this.tangents&&i(n.b.TangentKind,this.tangents),this.uvs&&i(n.b.UVKind,this.uvs),this.uvs2&&i(n.b.UV2Kind,this.uvs2),this.uvs3&&i(n.b.UV3Kind,this.uvs3),this.uvs4&&i(n.b.UV4Kind,this.uvs4),this.uvs5&&i(n.b.UV5Kind,this.uvs5),this.uvs6&&i(n.b.UV6Kind,this.uvs6),this.colors&&i(n.b.ColorKind,this.colors),this.matricesIndices&&i(n.b.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&i(n.b.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&i(n.b.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&i(n.b.MatricesWeightsExtraKind,this.matricesWeightsExtra)},e.prototype.serialize=function(){var e=this.serialize();return this.positions&&(e.positions=this.positions),this.normals&&(e.normals=this.normals),this.tangents&&(e.tangents=this.tangents),this.uvs&&(e.uvs=this.uvs),this.uvs2&&(e.uvs2=this.uvs2),this.uvs3&&(e.uvs3=this.uvs3),this.uvs4&&(e.uvs4=this.uvs4),this.uvs5&&(e.uvs5=this.uvs5),this.uvs6&&(e.uvs6=this.uvs6),this.colors&&(e.colors=this.colors),this.matricesIndices&&(e.matricesIndices=this.matricesIndices,e.matricesIndices._isExpanded=!0),this.matricesWeights&&(e.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(e.matricesIndicesExtra=this.matricesIndicesExtra,e.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(e.matricesWeightsExtra=this.matricesWeightsExtra),e.indices=this.indices,e},e.ExtractFromMesh=function(t,i,r){return e._ExtractFrom(t,i,r)},e.ExtractFromGeometry=function(t,i,r){return e._ExtractFrom(t,i,r)},e._ExtractFrom=function(t,i,r){var s=new e;return t.isVerticesDataPresent(n.b.PositionKind)&&(s.positions=t.getVerticesData(n.b.PositionKind,i,r)),t.isVerticesDataPresent(n.b.NormalKind)&&(s.normals=t.getVerticesData(n.b.NormalKind,i,r)),t.isVerticesDataPresent(n.b.TangentKind)&&(s.tangents=t.getVerticesData(n.b.TangentKind,i,r)),t.isVerticesDataPresent(n.b.UVKind)&&(s.uvs=t.getVerticesData(n.b.UVKind,i,r)),t.isVerticesDataPresent(n.b.UV2Kind)&&(s.uvs2=t.getVerticesData(n.b.UV2Kind,i,r)),t.isVerticesDataPresent(n.b.UV3Kind)&&(s.uvs3=t.getVerticesData(n.b.UV3Kind,i,r)),t.isVerticesDataPresent(n.b.UV4Kind)&&(s.uvs4=t.getVerticesData(n.b.UV4Kind,i,r)),t.isVerticesDataPresent(n.b.UV5Kind)&&(s.uvs5=t.getVerticesData(n.b.UV5Kind,i,r)),t.isVerticesDataPresent(n.b.UV6Kind)&&(s.uvs6=t.getVerticesData(n.b.UV6Kind,i,r)),t.isVerticesDataPresent(n.b.ColorKind)&&(s.colors=t.getVerticesData(n.b.ColorKind,i,r)),t.isVerticesDataPresent(n.b.MatricesIndicesKind)&&(s.matricesIndices=t.getVerticesData(n.b.MatricesIndicesKind,i,r)),t.isVerticesDataPresent(n.b.MatricesWeightsKind)&&(s.matricesWeights=t.getVerticesData(n.b.MatricesWeightsKind,i,r)),t.isVerticesDataPresent(n.b.MatricesIndicesExtraKind)&&(s.matricesIndicesExtra=t.getVerticesData(n.b.MatricesIndicesExtraKind,i,r)),t.isVerticesDataPresent(n.b.MatricesWeightsExtraKind)&&(s.matricesWeightsExtra=t.getVerticesData(n.b.MatricesWeightsExtraKind,i,r)),s.indices=t.getIndices(i,r),s},e.CreateRibbon=function(t){var i=t.pathArray,r=t.closeArray||!1,s=t.closePath||!1,a=t.invertUV||!1,o=Math.floor(i[0].length/2),h=t.offset||o;h=h>o?o:Math.floor(h);var u,c,l,d,f=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,p=t.uvs,g=t.colors,m=[],v=[],y=[],b=[],_=[],x=[],M=[],D=[],V=[],I=[];if(i.length<2){var A=[],w=[];for(l=0;l<i[0].length-h;l++)A.push(i[0][l]),w.push(i[0][l+h]);i=[A,w]}var T,S,O,P,C,E=0,B=s?1:0;for(u=i[0].length,c=0;c<i.length;c++){for(M[c]=0,_[c]=[0],u=u<(S=(T=i[c]).length)?u:S,d=0;d<S;)m.push(T[d].x,T[d].y,T[d].z),d>0&&(O=T[d].subtract(T[d-1]).length()+M[c],_[c].push(O),M[c]=O),d++;s&&(d--,m.push(T[0].x,T[0].y,T[0].z),O=T[d].subtract(T[0]).length()+M[c],_[c].push(O),M[c]=O),V[c]=S+B,I[c]=E,E+=S+B}var L,F,R=null,z=null;for(l=0;l<u+B;l++){for(D[l]=0,x[l]=[0],c=0;c<i.length-1;c++)P=i[c],C=i[c+1],l===u?(R=P[0],z=C[0]):(R=P[l],z=C[l]),O=z.subtract(R).length()+D[l],x[l].push(O),D[l]=O;r&&z&&R&&(P=i[c],C=i[0],l===u&&(z=C[0]),O=z.subtract(R).length()+D[l],D[l]=O)}if(p)for(c=0;c<p.length;c++)b.push(p[c].x,p[c].y);else for(c=0;c<i.length;c++)for(l=0;l<u+B;l++)L=0!=M[c]?_[c][l]/M[c]:0,F=0!=D[l]?x[l][c]/D[l]:0,a?b.push(F,L):b.push(L,F);for(var U=0,K=V[c=0]-1,N=V[c+1]-1,W=K<N?K:N,k=I[1]-I[0],j=r?V.length:V.length-1;U<=W&&c<j;)v.push(U,U+k,U+1),v.push(U+k+1,U+1,U+k),(U+=1)===W&&(++c===V.length-1?(k=I[0]-I[c],K=V[c]-1,N=V[0]-1):(k=I[c+1]-I[c],K=V[c]-1,N=V[c+1]-1),U=I[c],W=K<N?K+U:N+U);if(e.ComputeNormals(m,v,y),s){var G=0,Q=0;for(c=0;c<i.length;c++)G=3*I[c],Q=c+1<i.length?3*(I[c+1]-1):y.length-3,y[G]=.5*(y[G]+y[Q]),y[G+1]=.5*(y[G+1]+y[Q+1]),y[G+2]=.5*(y[G+2]+y[Q+2]),y[Q]=y[G],y[Q+1]=y[G+1],y[Q+2]=y[G+2]}e._ComputeSides(f,m,v,y,b,t.frontUVs,t.backUVs);var Y=null;if(g){Y=new Float32Array(4*g.length);for(var Z=0;Z<g.length;Z++)Y[4*Z]=g[Z].r,Y[4*Z+1]=g[Z].g,Y[4*Z+2]=g[Z].b,Y[4*Z+3]=g[Z].a}var H=new e,X=new Float32Array(m),q=new Float32Array(y),J=new Float32Array(b);return H.indices=v,H.positions=X,H.normals=q,H.uvs=J,Y&&H.set(Y,n.b.ColorKind),s&&(H._idx=I),H},e.CreateBox=function(t){for(var i=[new r.Vector3(0,0,1),new r.Vector3(0,0,-1),new r.Vector3(1,0,0),new r.Vector3(-1,0,0),new r.Vector3(0,1,0),new r.Vector3(0,-1,0)],n=[],s=[],a=[],o=[],h=t.width||t.size||1,u=t.height||t.size||1,c=t.depth||t.size||1,l=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,d=t.faceUV||new Array(6),f=t.faceColors,p=[],g=0;g<6;g++)void 0===d[g]&&(d[g]=new r.Vector4(0,0,1,1)),f&&void 0===f[g]&&(f[g]=new r.Color4(1,1,1,1));for(var m=new r.Vector3(h/2,u/2,c/2),v=0;v<i.length;v++){var y=i[v],b=new r.Vector3(y.y,y.z,y.x),_=r.Vector3.Cross(y,b),x=s.length/3;n.push(x),n.push(x+1),n.push(x+2),n.push(x),n.push(x+2),n.push(x+3);var M=y.subtract(b).subtract(_).multiply(m);s.push(M.x,M.y,M.z),a.push(y.x,y.y,y.z),o.push(d[v].z,d[v].w),f&&p.push(f[v].r,f[v].g,f[v].b,f[v].a),M=y.subtract(b).add(_).multiply(m),s.push(M.x,M.y,M.z),a.push(y.x,y.y,y.z),o.push(d[v].x,d[v].w),f&&p.push(f[v].r,f[v].g,f[v].b,f[v].a),M=y.add(b).add(_).multiply(m),s.push(M.x,M.y,M.z),a.push(y.x,y.y,y.z),o.push(d[v].x,d[v].y),f&&p.push(f[v].r,f[v].g,f[v].b,f[v].a),M=y.add(b).subtract(_).multiply(m),s.push(M.x,M.y,M.z),a.push(y.x,y.y,y.z),o.push(d[v].z,d[v].y),f&&p.push(f[v].r,f[v].g,f[v].b,f[v].a)}e._ComputeSides(l,s,n,a,o,t.frontUVs,t.backUVs);var D=new e;if(D.indices=n,D.positions=s,D.normals=a,D.uvs=o,f){var V=l===e.DOUBLESIDE?p.concat(p):p;D.colors=V}return D},e.CreateSphere=function(t){for(var i=t.segments||32,n=t.diameterX||t.diameter||1,s=t.diameterY||t.diameter||1,a=t.diameterZ||t.diameter||1,o=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,h=t.slice&&t.slice<=0?1:t.slice||1,u=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,c=new r.Vector3(n/2,s/2,a/2),l=2+i,d=2*l,f=[],p=[],g=[],m=[],v=0;v<=l;v++){for(var y=v/l,b=y*Math.PI*h,_=0;_<=d;_++){var x=_/d,M=x*Math.PI*2*o,D=r.Matrix.RotationZ(-b),V=r.Matrix.RotationY(M),I=r.Vector3.TransformCoordinates(r.Vector3.Up(),D),A=r.Vector3.TransformCoordinates(I,V),w=A.multiply(c),T=A.divide(c).normalize();p.push(w.x,w.y,w.z),g.push(T.x,T.y,T.z),m.push(x,y)}if(v>0)for(var S=p.length/3,O=S-2*(d+1);O+d+2<S;O++)f.push(O),f.push(O+1),f.push(O+d+1),f.push(O+d+1),f.push(O+1),f.push(O+d+2)}e._ComputeSides(u,p,f,g,m,t.frontUVs,t.backUVs);var P=new e;return P.indices=f,P.positions=p,P.normals=g,P.uvs=m,P},e.CreateCylinder=function(t){var i,n=t.height||2,s=0===t.diameterTop?0:t.diameterTop||t.diameter||1,a=0===t.diameterBottom?0:t.diameterBottom||t.diameter||1,o=t.tessellation||24,h=t.subdivisions||1,u=!!t.hasRings,c=!!t.enclose,l=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,d=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,f=t.faceUV||new Array(3),p=t.faceColors,g=2+(1+(1!==l&&c?2:0))*(u?h:1);for(i=0;i<g;i++)p&&void 0===p[i]&&(p[i]=new r.Color4(1,1,1,1));for(i=0;i<g;i++)f&&void 0===f[i]&&(f[i]=new r.Vector4(0,0,1,1));var m,v,y,b,_,x,M=new Array,D=new Array,V=new Array,I=new Array,A=new Array,w=2*Math.PI*l/o,T=(a-s)/2/n,S=r.Vector3.Zero(),O=r.Vector3.Zero(),P=r.Vector3.Zero(),C=r.Vector3.Zero(),E=r.Vector3.Zero(),B=r.Axis.Y,L=1,F=1,R=0,z=0;for(b=0;b<=h;b++)for(y=((v=b/h)*(s-a)+a)/2,L=u&&0!==b&&b!==h?2:1,x=0;x<L;x++){for(u&&(F+=x),c&&(F+=2*x),_=0;_<=o;_++)m=_*w,S.x=Math.cos(-m)*y,S.y=-n/2+v*n,S.z=Math.sin(-m)*y,0===s&&b===h?(O.x=V[V.length-3*(o+1)],O.y=V[V.length-3*(o+1)+1],O.z=V[V.length-3*(o+1)+2]):(O.x=S.x,O.z=S.z,O.y=Math.sqrt(O.x*O.x+O.z*O.z)*T,O.normalize()),0===_&&(P.copyFrom(S),C.copyFrom(O)),D.push(S.x,S.y,S.z),V.push(O.x,O.y,O.z),z=u?R!==F?f[F].y:f[F].w:f[F].y+(f[F].w-f[F].y)*v,I.push(f[F].x+(f[F].z-f[F].x)*_/o,z),p&&A.push(p[F].r,p[F].g,p[F].b,p[F].a);1!==l&&c&&(D.push(S.x,S.y,S.z),D.push(0,S.y,0),D.push(0,S.y,0),D.push(P.x,P.y,P.z),r.Vector3.CrossToRef(B,O,E),E.normalize(),V.push(E.x,E.y,E.z,E.x,E.y,E.z),r.Vector3.CrossToRef(C,B,E),E.normalize(),V.push(E.x,E.y,E.z,E.x,E.y,E.z),z=u?R!==F?f[F+1].y:f[F+1].w:f[F+1].y+(f[F+1].w-f[F+1].y)*v,I.push(f[F+1].x,z),I.push(f[F+1].z,z),z=u?R!==F?f[F+2].y:f[F+2].w:f[F+2].y+(f[F+2].w-f[F+2].y)*v,I.push(f[F+2].x,z),I.push(f[F+2].z,z),p&&(A.push(p[F+1].r,p[F+1].g,p[F+1].b,p[F+1].a),A.push(p[F+1].r,p[F+1].g,p[F+1].b,p[F+1].a),A.push(p[F+2].r,p[F+2].g,p[F+2].b,p[F+2].a),A.push(p[F+2].r,p[F+2].g,p[F+2].b,p[F+2].a))),R!==F&&(R=F)}var U=1!==l&&c?o+4:o;for(b=0,F=0;F<h;F++){var K=0,N=0,W=0,k=0;for(_=0;_<o;_++)K=b*(U+1)+_,N=(b+1)*(U+1)+_,W=b*(U+1)+(_+1),k=(b+1)*(U+1)+(_+1),M.push(K,N,W),M.push(k,W,N);1!==l&&c&&(M.push(K+2,N+2,W+2),M.push(k+2,W+2,N+2),M.push(K+4,N+4,W+4),M.push(k+4,W+4,N+4)),b=u?b+2:b+1}var j=function(e){var t=e?s/2:a/2;if(0!==t){var i,h,u,c=e?f[g-1]:f[0],d=null;p&&(d=e?p[g-1]:p[0]);var m=D.length/3,v=e?n/2:-n/2,y=new r.Vector3(0,v,0);D.push(y.x,y.y,y.z),V.push(0,e?1:-1,0),I.push(c.x+.5*(c.z-c.x),c.y+.5*(c.w-c.y)),d&&A.push(d.r,d.g,d.b,d.a);var b=new r.Vector2(.5,.5);for(u=0;u<=o;u++){i=2*Math.PI*u*l/o;var _=Math.cos(-i),x=Math.sin(-i);h=new r.Vector3(_*t,v,x*t);var w=new r.Vector2(_*b.x+.5,x*b.y+.5);D.push(h.x,h.y,h.z),V.push(0,e?1:-1,0),I.push(c.x+(c.z-c.x)*w.x,c.y+(c.w-c.y)*w.y),d&&A.push(d.r,d.g,d.b,d.a)}for(u=0;u<o;u++)e?(M.push(m),M.push(m+(u+2)),M.push(m+(u+1))):(M.push(m),M.push(m+(u+1)),M.push(m+(u+2)))}};j(!1),j(!0),e._ComputeSides(d,D,M,V,I,t.frontUVs,t.backUVs);var G=new e;return G.indices=M,G.positions=D,G.normals=V,G.uvs=I,p&&(G.colors=A),G},e.CreateTorus=function(t){for(var i=[],n=[],s=[],a=[],o=t.diameter||1,h=t.thickness||.5,u=t.tessellation||16,c=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,l=u+1,d=0;d<=u;d++)for(var f=d/u,p=d*Math.PI*2/u-Math.PI/2,g=r.Matrix.Translation(o/2,0,0).multiply(r.Matrix.RotationY(p)),m=0;m<=u;m++){var v=1-m/u,y=m*Math.PI*2/u+Math.PI,b=Math.cos(y),_=Math.sin(y),x=new r.Vector3(b,_,0),M=x.scale(h/2),D=new r.Vector2(f,v);M=r.Vector3.TransformCoordinates(M,g),x=r.Vector3.TransformNormal(x,g),n.push(M.x,M.y,M.z),s.push(x.x,x.y,x.z),a.push(D.x,D.y);var V=(d+1)%l,I=(m+1)%l;i.push(d*l+m),i.push(d*l+I),i.push(V*l+m),i.push(d*l+I),i.push(V*l+I),i.push(V*l+m)}e._ComputeSides(c,n,i,s,a,t.frontUVs,t.backUVs);var A=new e;return A.indices=i,A.positions=n,A.normals=s,A.uvs=a,A},e.CreateLineSystem=function(t){for(var i=[],r=[],n=t.lines,s=t.colors,a=[],o=0,h=0;h<n.length;h++)for(var u=n[h],c=0;c<u.length;c++){if(r.push(u[c].x,u[c].y,u[c].z),s){var l=s[h];a.push(l[c].r,l[c].g,l[c].b,l[c].a)}c>0&&(i.push(o-1),i.push(o)),o++}var d=new e;return d.indices=i,d.positions=r,s&&(d.colors=a),d},e.CreateDashedLines=function(t){var i,n,s=t.dashSize||3,a=t.gapSize||1,o=t.dashNb||200,h=t.points,u=new Array,c=new Array,l=r.Vector3.Zero(),d=0,f=0,p=0,g=0,m=0;for(m=0;m<h.length-1;m++)h[m+1].subtractToRef(h[m],l),d+=l.length();for(n=s*(i=d/o)/(s+a),m=0;m<h.length-1;m++){h[m+1].subtractToRef(h[m],l),f=Math.floor(l.length()/i),l.normalize();for(var v=0;v<f;v++)p=i*v,u.push(h[m].x+p*l.x,h[m].y+p*l.y,h[m].z+p*l.z),u.push(h[m].x+(p+n)*l.x,h[m].y+(p+n)*l.y,h[m].z+(p+n)*l.z),c.push(g,g+1),g+=2}var y=new e;return y.positions=u,y.indices=c,y},e.CreateGround=function(t){var i,n,s=[],a=[],o=[],h=[],u=t.width||1,c=t.height||1,l=t.subdivisionsX||t.subdivisions||1,d=t.subdivisionsY||t.subdivisions||1;for(i=0;i<=d;i++)for(n=0;n<=l;n++){var f=new r.Vector3(n*u/l-u/2,0,(d-i)*c/d-c/2),p=new r.Vector3(0,1,0);a.push(f.x,f.y,f.z),o.push(p.x,p.y,p.z),h.push(n/l,1-i/d)}for(i=0;i<d;i++)for(n=0;n<l;n++)s.push(n+1+(i+1)*(l+1)),s.push(n+1+i*(l+1)),s.push(n+i*(l+1)),s.push(n+(i+1)*(l+1)),s.push(n+1+(i+1)*(l+1)),s.push(n+i*(l+1));var g=new e;return g.indices=s,g.positions=a,g.normals=o,g.uvs=h,g},e.CreateTiledGround=function(t){var i,n,s,a,o=void 0!==t.xmin&&null!==t.xmin?t.xmin:-1,h=void 0!==t.zmin&&null!==t.zmin?t.zmin:-1,u=void 0!==t.xmax&&null!==t.xmax?t.xmax:1,c=void 0!==t.zmax&&null!==t.zmax?t.zmax:1,l=t.subdivisions||{w:1,h:1},d=t.precision||{w:1,h:1},f=new Array,p=new Array,g=new Array,m=new Array;l.h=l.h<1?1:l.h,l.w=l.w<1?1:l.w,d.w=d.w<1?1:d.w,d.h=d.h<1?1:d.h;var v=(u-o)/l.w,y=(c-h)/l.h;function b(e,t,s,a){var o=p.length/3,h=d.w+1;for(i=0;i<d.h;i++)for(n=0;n<d.w;n++){var u=[o+n+i*h,o+(n+1)+i*h,o+(n+1)+(i+1)*h,o+n+(i+1)*h];f.push(u[1]),f.push(u[2]),f.push(u[3]),f.push(u[0]),f.push(u[1]),f.push(u[3])}var c=r.Vector3.Zero(),l=new r.Vector3(0,1,0);for(i=0;i<=d.h;i++)for(c.z=i*(a-t)/d.h+t,n=0;n<=d.w;n++)c.x=n*(s-e)/d.w+e,c.y=0,p.push(c.x,c.y,c.z),g.push(l.x,l.y,l.z),m.push(n/d.w,i/d.h)}for(s=0;s<l.h;s++)for(a=0;a<l.w;a++)b(o+a*v,h+s*y,o+(a+1)*v,h+(s+1)*y);var _=new e;return _.indices=f,_.positions=p,_.normals=g,_.uvs=m,_},e.CreateGroundFromHeightMap=function(t){var i,n,s=[],a=[],o=[],h=[],u=t.colorFilter||new r.Color3(.3,.59,.11),c=t.alphaFilter||0;for(i=0;i<=t.subdivisions;i++)for(n=0;n<=t.subdivisions;n++){var l=new r.Vector3(n*t.width/t.subdivisions-t.width/2,0,(t.subdivisions-i)*t.height/t.subdivisions-t.height/2),d=4*(((l.x+t.width/2)/t.width*(t.bufferWidth-1)|0)+((1-(l.z+t.height/2)/t.height)*(t.bufferHeight-1)|0)*t.bufferWidth),f=t.buffer[d]/255,p=t.buffer[d+1]/255,g=t.buffer[d+2]/255,m=t.buffer[d+3]/255,v=f*u.r+p*u.g+g*u.b;l.y=m>=c?t.minHeight+(t.maxHeight-t.minHeight)*v:t.minHeight-r.Epsilon,a.push(l.x,l.y,l.z),o.push(0,0,0),h.push(n/t.subdivisions,1-i/t.subdivisions)}for(i=0;i<t.subdivisions;i++)for(n=0;n<t.subdivisions;n++){var y=n+1+(i+1)*(t.subdivisions+1),b=n+1+i*(t.subdivisions+1),_=n+i*(t.subdivisions+1),x=n+(i+1)*(t.subdivisions+1),M=a[3*y+1]>=t.minHeight,D=a[3*b+1]>=t.minHeight,V=a[3*_+1]>=t.minHeight;M&&D&&V&&(s.push(y),s.push(b),s.push(_)),a[3*x+1]>=t.minHeight&&M&&V&&(s.push(x),s.push(y),s.push(_))}e.ComputeNormals(a,s,o);var I=new e;return I.indices=s,I.positions=a,I.normals=o,I.uvs=h,I},e.CreatePlane=function(t){var i=[],r=[],n=[],s=[],a=t.width||t.size||1,o=t.height||t.size||1,h=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,u=a/2,c=o/2;r.push(-u,-c,0),n.push(0,0,-1),s.push(0,0),r.push(u,-c,0),n.push(0,0,-1),s.push(1,0),r.push(u,c,0),n.push(0,0,-1),s.push(1,1),r.push(-u,c,0),n.push(0,0,-1),s.push(0,1),i.push(0),i.push(1),i.push(2),i.push(0),i.push(2),i.push(3),e._ComputeSides(h,r,i,n,s,t.frontUVs,t.backUVs);var l=new e;return l.indices=i,l.positions=r,l.normals=n,l.uvs=s,l},e.CreateDisc=function(t){var i=new Array,r=new Array,n=new Array,s=new Array,a=t.radius||.5,o=t.tessellation||64,h=t.arc&&(t.arc<=0||t.arc>1)?1:t.arc||1,u=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE;i.push(0,0,0),s.push(.5,.5);for(var c=2*Math.PI*h,l=c/o,d=0;d<c;d+=l){var f=Math.cos(d),p=Math.sin(d),g=(f+1)/2,m=(1-p)/2;i.push(a*f,a*p,0),s.push(g,m)}1===h&&(i.push(i[3],i[4],i[5]),s.push(s[2],s[3]));for(var v=i.length/3,y=1;y<v-1;y++)r.push(y+1,0,y);e.ComputeNormals(i,r,n),e._ComputeSides(u,i,r,n,s,t.frontUVs,t.backUVs);var b=new e;return b.indices=r,b.positions=i,b.normals=n,b.uvs=s,b},e.CreatePolygon=function(t,i,s,a,o,h){for(var u=s||new Array(3),c=a,l=[],d=0;d<3;d++)void 0===u[d]&&(u[d]=new r.Vector4(0,0,1,1)),c&&void 0===c[d]&&(c[d]=new r.Color4(1,1,1,1));for(var f=t.getVerticesData(n.b.PositionKind),p=t.getVerticesData(n.b.NormalKind),g=t.getVerticesData(n.b.UVKind),m=t.getIndices(),v=0,y=0,b=0;b<p.length;b+=3)Math.abs(p[b+1])<.001&&(y=1),Math.abs(p[b+1]-1)<.001&&(y=0),Math.abs(p[b+1]+1)<.001&&(y=2),g[2*(v=b/3)]=(1-g[2*v])*u[y].x+g[2*v]*u[y].z,g[2*v+1]=(1-g[2*v+1])*u[y].y+g[2*v+1]*u[y].w,c&&l.push(c[y].r,c[y].g,c[y].b,c[y].a);e._ComputeSides(i,f,m,p,g,o,h);var _=new e;if(_.indices=m,_.positions=f,_.normals=p,_.uvs=g,c){var x=i===e.DOUBLESIDE?l.concat(l):l;_.colors=x}return _},e.CreateIcoSphere=function(t){var i,n=t.sideOrientation||e.DEFAULTSIDE,s=t.radius||1,a=void 0===t.flat||t.flat,o=t.subdivisions||4,h=t.radiusX||s,u=t.radiusY||s,c=t.radiusZ||s,l=(1+Math.sqrt(5))/2,d=[-1,l,-0,1,l,0,-1,-l,0,1,-l,0,0,-1,-l,0,1,-l,0,-1,l,0,1,l,l,0,1,l,0,-1,-l,0,1,-l,0,-1],f=[0,11,5,0,5,1,0,1,7,0,7,10,12,22,23,1,5,20,5,11,4,23,22,13,22,18,6,7,1,8,14,21,4,14,4,2,16,13,6,15,6,19,3,8,9,4,21,5,13,17,23,6,13,22,19,6,18,9,8,1],p=[0,1,2,3,4,5,6,7,8,9,10,11,0,2,3,3,3,4,7,8,9,9,10,11],g=[5,1,3,1,6,4,0,0,5,3,4,2,2,2,4,0,2,0,1,1,6,0,6,2,0,4,3,3,4,4,3,1,4,2,4,4,0,2,1,1,2,2,3,3,1,3,2,4],m=[0,0,0,0,1,0,0,1,1,0,0,0,1,1,0,0,1,1,1,0],v=new Array,y=new Array,b=new Array,_=new Array,x=0,M=new Array(3),D=new Array(3);for(i=0;i<3;i++)M[i]=r.Vector3.Zero(),D[i]=r.Vector2.Zero();for(var V=0;V<20;V++){for(i=0;i<3;i++){var I=f[3*V+i];M[i].copyFromFloats(d[3*p[I]],d[3*p[I]+1],d[3*p[I]+2]),M[i].normalize().scaleInPlace(s),D[i].copyFromFloats(g[2*I]*(138/1024)+60/1024+m[V]*(-40/1024),g[2*I+1]*(239/1024)+26/1024+m[V]*(20/1024))}for(var A=function(e,t,i,n){var s,l=r.Vector3.Lerp(M[0],M[2],t/o),d=r.Vector3.Lerp(M[1],M[2],t/o),f=o===t?M[2]:r.Vector3.Lerp(l,d,e/(o-t));if(f.normalize(),a){var p=r.Vector3.Lerp(M[0],M[2],n/o),g=r.Vector3.Lerp(M[1],M[2],n/o);s=r.Vector3.Lerp(p,g,i/(o-n))}else s=new r.Vector3(f.x,f.y,f.z);s.x/=h,s.y/=u,s.z/=c,s.normalize();var m=r.Vector2.Lerp(D[0],D[2],t/o),V=r.Vector2.Lerp(D[1],D[2],t/o),I=o===t?D[2]:r.Vector2.Lerp(m,V,e/(o-t));y.push(f.x*h,f.y*u,f.z*c),b.push(s.x,s.y,s.z),_.push(I.x,I.y),v.push(x),x++},w=0;w<o;w++)for(var T=0;T+w<o;T++)A(T,w,T+1/3,w+1/3),A(T+1,w,T+1/3,w+1/3),A(T,w+1,T+1/3,w+1/3),T+w+1<o&&(A(T+1,w,T+2/3,w+2/3),A(T+1,w+1,T+2/3,w+2/3),A(T,w+1,T+2/3,w+2/3))}e._ComputeSides(n,y,v,b,_,t.frontUVs,t.backUVs);var S=new e;return S.indices=v,S.positions=y,S.normals=b,S.uvs=_,S},e.CreatePolyhedron=function(t){var i=[];i[0]={vertex:[[0,0,1.732051],[1.632993,0,-.5773503],[-.8164966,1.414214,-.5773503],[-.8164966,-1.414214,-.5773503]],face:[[0,1,2],[0,2,3],[0,3,1],[1,3,2]]},i[1]={vertex:[[0,0,1.414214],[1.414214,0,0],[0,1.414214,0],[-1.414214,0,0],[0,-1.414214,0],[0,0,-1.414214]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]]},i[2]={vertex:[[0,0,1.070466],[.7136442,0,.7978784],[-.3568221,.618034,.7978784],[-.3568221,-.618034,.7978784],[.7978784,.618034,.3568221],[.7978784,-.618034,.3568221],[-.9341724,.381966,.3568221],[.1362939,1,.3568221],[.1362939,-1,.3568221],[-.9341724,-.381966,.3568221],[.9341724,.381966,-.3568221],[.9341724,-.381966,-.3568221],[-.7978784,.618034,-.3568221],[-.1362939,1,-.3568221],[-.1362939,-1,-.3568221],[-.7978784,-.618034,-.3568221],[.3568221,.618034,-.7978784],[.3568221,-.618034,-.7978784],[-.7136442,0,-.7978784],[0,0,-1.070466]],face:[[0,1,4,7,2],[0,2,6,9,3],[0,3,8,5,1],[1,5,11,10,4],[2,7,13,12,6],[3,9,15,14,8],[4,10,16,13,7],[5,8,14,17,11],[6,12,18,15,9],[10,11,17,19,16],[12,13,16,19,18],[14,15,18,19,17]]},i[3]={vertex:[[0,0,1.175571],[1.051462,0,.5257311],[.3249197,1,.5257311],[-.8506508,.618034,.5257311],[-.8506508,-.618034,.5257311],[.3249197,-1,.5257311],[.8506508,.618034,-.5257311],[.8506508,-.618034,-.5257311],[-.3249197,1,-.5257311],[-1.051462,0,-.5257311],[-.3249197,-1,-.5257311],[0,0,-1.175571]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,5],[0,5,1],[1,5,7],[1,7,6],[1,6,2],[2,6,8],[2,8,3],[3,8,9],[3,9,4],[4,9,10],[4,10,5],[5,10,7],[6,7,11],[6,11,8],[7,10,11],[8,11,9],[9,11,10]]},i[4]={vertex:[[0,0,1.070722],[.7148135,0,.7971752],[-.104682,.7071068,.7971752],[-.6841528,.2071068,.7971752],[-.104682,-.7071068,.7971752],[.6101315,.7071068,.5236279],[1.04156,.2071068,.1367736],[.6101315,-.7071068,.5236279],[-.3574067,1,.1367736],[-.7888348,-.5,.5236279],[-.9368776,.5,.1367736],[-.3574067,-1,.1367736],[.3574067,1,-.1367736],[.9368776,-.5,-.1367736],[.7888348,.5,-.5236279],[.3574067,-1,-.1367736],[-.6101315,.7071068,-.5236279],[-1.04156,-.2071068,-.1367736],[-.6101315,-.7071068,-.5236279],[.104682,.7071068,-.7971752],[.6841528,-.2071068,-.7971752],[.104682,-.7071068,-.7971752],[-.7148135,0,-.7971752],[0,0,-1.070722]],face:[[0,2,3],[1,6,5],[4,9,11],[7,15,13],[8,16,10],[12,14,19],[17,22,18],[20,21,23],[0,1,5,2],[0,3,9,4],[0,4,7,1],[1,7,13,6],[2,5,12,8],[2,8,10,3],[3,10,17,9],[4,11,15,7],[5,6,14,12],[6,13,20,14],[8,12,19,16],[9,17,18,11],[10,16,22,17],[11,18,21,15],[13,15,21,20],[14,20,23,19],[16,19,23,22],[18,22,23,21]]},i[5]={vertex:[[0,0,1.322876],[1.309307,0,.1889822],[-.9819805,.8660254,.1889822],[.1636634,-1.299038,.1889822],[.3273268,.8660254,-.9449112],[-.8183171,-.4330127,-.9449112]],face:[[0,3,1],[2,4,5],[0,1,4,2],[0,2,5,3],[1,3,5,4]]},i[6]={vertex:[[0,0,1.159953],[1.013464,0,.5642542],[-.3501431,.9510565,.5642542],[-.7715208,-.6571639,.5642542],[.6633206,.9510565,-.03144481],[.8682979,-.6571639,-.3996071],[-1.121664,.2938926,-.03144481],[-.2348831,-1.063314,-.3996071],[.5181548,.2938926,-.9953061],[-.5850262,-.112257,-.9953061]],face:[[0,1,4,2],[0,2,6,3],[1,5,8,4],[3,6,9,7],[5,7,9,8],[0,3,7,5,1],[2,4,8,9,6]]},i[7]={vertex:[[0,0,1.118034],[.8944272,0,.6708204],[-.2236068,.8660254,.6708204],[-.7826238,-.4330127,.6708204],[.6708204,.8660254,.2236068],[1.006231,-.4330127,-.2236068],[-1.006231,.4330127,.2236068],[-.6708204,-.8660254,-.2236068],[.7826238,.4330127,-.6708204],[.2236068,-.8660254,-.6708204],[-.8944272,0,-.6708204],[0,0,-1.118034]],face:[[0,1,4,2],[0,2,6,3],[1,5,8,4],[3,6,10,7],[5,9,11,8],[7,10,11,9],[0,3,7,9,5,1],[2,4,8,11,10,6]]},i[8]={vertex:[[-.729665,.670121,.319155],[-.655235,-.29213,-.754096],[-.093922,-.607123,.537818],[.702196,.595691,.485187],[.776626,-.36656,-.588064]],face:[[1,4,2],[0,1,2],[3,0,2],[4,3,2],[4,1,0,3]]},i[9]={vertex:[[-.868849,-.100041,.61257],[-.329458,.976099,.28078],[-.26629,-.013796,-.477654],[-.13392,-1.034115,.229829],[.738834,.707117,-.307018],[.859683,-.535264,-.338508]],face:[[3,0,2],[5,3,2],[4,5,2],[1,4,2],[0,1,2],[0,3,5,4,1]]},i[10]={vertex:[[-.610389,.243975,.531213],[-.187812,-.48795,-.664016],[-.187812,.9759,-.664016],[.187812,-.9759,.664016],[.798201,.243975,.132803]],face:[[1,3,0],[3,4,0],[3,1,4],[0,2,1],[0,4,2],[2,4,1]]},i[11]={vertex:[[-1.028778,.392027,-.048786],[-.640503,-.646161,.621837],[-.125162,-.395663,-.540059],[.004683,.888447,-.651988],[.125161,.395663,.540059],[.632925,-.791376,.433102],[1.031672,.157063,-.354165]],face:[[3,2,0],[2,1,0],[2,5,1],[0,4,3],[0,1,4],[4,1,5],[2,3,6],[3,4,6],[5,2,6],[4,5,6]]},i[12]={vertex:[[-.669867,.334933,-.529576],[-.669867,.334933,.529577],[-.4043,1.212901,0],[-.334933,-.669867,-.529576],[-.334933,-.669867,.529577],[.334933,.669867,-.529576],[.334933,.669867,.529577],[.4043,-1.212901,0],[.669867,-.334933,-.529576],[.669867,-.334933,.529577]],face:[[8,9,7],[6,5,2],[3,8,7],[5,0,2],[4,3,7],[0,1,2],[9,4,7],[1,6,2],[9,8,5,6],[8,3,0,5],[3,4,1,0],[4,9,6,1]]},i[13]={vertex:[[-.931836,.219976,-.264632],[-.636706,.318353,.692816],[-.613483,-.735083,-.264632],[-.326545,.979634,0],[-.318353,-.636706,.692816],[-.159176,.477529,-.856368],[.159176,-.477529,-.856368],[.318353,.636706,.692816],[.326545,-.979634,0],[.613482,.735082,-.264632],[.636706,-.318353,.692816],[.931835,-.219977,-.264632]],face:[[11,10,8],[7,9,3],[6,11,8],[9,5,3],[2,6,8],[5,0,3],[4,2,8],[0,1,3],[10,4,8],[1,7,3],[10,11,9,7],[11,6,5,9],[6,2,0,5],[2,4,1,0],[4,10,7,1]]},i[14]={vertex:[[-.93465,.300459,-.271185],[-.838689,-.260219,-.516017],[-.711319,.717591,.128359],[-.710334,-.156922,.080946],[-.599799,.556003,-.725148],[-.503838,-.004675,-.969981],[-.487004,.26021,.48049],[-.460089,-.750282,-.512622],[-.376468,.973135,-.325605],[-.331735,-.646985,.084342],[-.254001,.831847,.530001],[-.125239,-.494738,-.966586],[.029622,.027949,.730817],[.056536,-.982543,-.262295],[.08085,1.087391,.076037],[.125583,-.532729,.485984],[.262625,.599586,.780328],[.391387,-.726999,-.716259],[.513854,-.868287,.139347],[.597475,.85513,.326364],[.641224,.109523,.783723],[.737185,-.451155,.538891],[.848705,-.612742,-.314616],[.976075,.365067,.32976],[1.072036,-.19561,.084927]],face:[[15,18,21],[12,20,16],[6,10,2],[3,0,1],[9,7,13],[2,8,4,0],[0,4,5,1],[1,5,11,7],[7,11,17,13],[13,17,22,18],[18,22,24,21],[21,24,23,20],[20,23,19,16],[16,19,14,10],[10,14,8,2],[15,9,13,18],[12,15,21,20],[6,12,16,10],[3,6,2,0],[9,3,1,7],[9,15,12,6,3],[22,17,11,5,4,8,14,19,23,24]]};var n,s,a,o,h,u,c=t.type&&(t.type<0||t.type>=i.length)?0:t.type||0,l=t.size,d=t.sizeX||l||1,f=t.sizeY||l||1,p=t.sizeZ||l||1,g=t.custom||i[c],m=g.face.length,v=t.faceUV||new Array(m),y=t.faceColors,b=void 0===t.flat||t.flat,_=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,x=new Array,M=new Array,D=new Array,V=new Array,I=new Array,A=0,w=0,T=new Array,S=0,O=0;if(b)for(O=0;O<m;O++)y&&void 0===y[O]&&(y[O]=new r.Color4(1,1,1,1)),v&&void 0===v[O]&&(v[O]=new r.Vector4(0,0,1,1));if(b)for(O=0;O<m;O++){var P=g.face[O].length;for(a=2*Math.PI/P,o=.5*Math.tan(a/2),h=.5,S=0;S<P;S++)x.push(g.vertex[g.face[O][S]][0]*d,g.vertex[g.face[O][S]][1]*f,g.vertex[g.face[O][S]][2]*p),T.push(A),A++,n=v[O].x+(v[O].z-v[O].x)*(.5+o),s=v[O].y+(v[O].w-v[O].y)*(h-.5),V.push(n,s),u=o*Math.cos(a)-h*Math.sin(a),h=o*Math.sin(a)+h*Math.cos(a),o=u,y&&I.push(y[O].r,y[O].g,y[O].b,y[O].a);for(S=0;S<P-2;S++)M.push(T[0+w],T[S+2+w],T[S+1+w]);w+=P}else{for(S=0;S<g.vertex.length;S++)x.push(g.vertex[S][0]*d,g.vertex[S][1]*f,g.vertex[S][2]*p),V.push(0,0);for(O=0;O<m;O++)for(S=0;S<g.face[O].length-2;S++)M.push(g.face[O][0],g.face[O][S+2],g.face[O][S+1])}e.ComputeNormals(x,M,D),e._ComputeSides(_,x,M,D,V,t.frontUVs,t.backUVs);var C=new e;return C.positions=x,C.indices=M,C.normals=D,C.uvs=V,y&&b&&(C.colors=I),C},e.CreateTorusKnot=function(t){var i,n,s=new Array,a=new Array,o=new Array,h=new Array,u=t.radius||2,c=t.tube||.5,l=t.radialSegments||32,d=t.tubularSegments||32,f=t.p||2,p=t.q||3,g=0===t.sideOrientation?0:t.sideOrientation||e.DEFAULTSIDE,m=function(e){var t=Math.cos(e),i=Math.sin(e),n=p/f*e,s=Math.cos(n),a=u*(2+s)*.5*t,o=u*(2+s)*i*.5,h=u*Math.sin(n)*.5;return new r.Vector3(a,o,h)};for(i=0;i<=l;i++){var v=i%l/l*2*f*Math.PI,y=m(v),b=m(v+.01),_=b.subtract(y),x=b.add(y),M=r.Vector3.Cross(_,x);for(x=r.Vector3.Cross(M,_),M.normalize(),x.normalize(),n=0;n<d;n++){var D=n%d/d*2*Math.PI,V=-c*Math.cos(D),I=c*Math.sin(D);a.push(y.x+V*x.x+I*M.x),a.push(y.y+V*x.y+I*M.y),a.push(y.z+V*x.z+I*M.z),h.push(i/l),h.push(n/d)}}for(i=0;i<l;i++)for(n=0;n<d;n++){var A=(n+1)%d,w=i*d+n,T=(i+1)*d+n,S=(i+1)*d+A,O=i*d+A;s.push(O),s.push(T),s.push(w),s.push(O),s.push(S),s.push(T)}e.ComputeNormals(a,s,o),e._ComputeSides(g,a,s,o,h,t.frontUVs,t.backUVs);var P=new e;return P.indices=s,P.positions=a,P.normals=o,P.uvs=h,P},e.ComputeNormals=function(e,t,i,n){var s=0,a=0,o=0,h=0,u=0,c=0,l=0,d=0,f=0,p=0,g=0,m=0,v=0,y=0,b=0,_=0,x=0,M=0,D=0,V=0,I=!1,A=!1,w=!1,T=!1,S=1,O=0,P=null;if(n&&(I=!!n.facetNormals,A=!!n.facetPositions,w=!!n.facetPartitioning,S=!0===n.useRightHandedSystem?-1:1,O=n.ratio||0,T=!!n.depthSort,P=n.distanceTo,T)){void 0===P&&(P=r.Vector3.Zero());var C=n.depthSortedFacets}var E=0,B=0,L=0,F=0;if(w&&n&&n.bbSize){var R=0,z=0,U=0,K=0,N=0,W=0,k=0,j=0,G=0,Q=0,Y=0,Z=0,H=0,X=0,q=0,J=0,$=n.bbSize.x>n.bbSize.y?n.bbSize.x:n.bbSize.y;$=$>n.bbSize.z?$:n.bbSize.z,E=n.subDiv.X*O/n.bbSize.x,B=n.subDiv.Y*O/n.bbSize.y,L=n.subDiv.Z*O/n.bbSize.z,F=n.subDiv.max*n.subDiv.max,n.facetPartitioning.length=0}for(s=0;s<e.length;s++)i[s]=0;var ee=t.length/3|0;for(s=0;s<ee;s++){if(v=(m=3*t[3*s])+1,y=m+2,_=(b=3*t[3*s+1])+1,x=b+2,D=(M=3*t[3*s+2])+1,V=M+2,a=e[m]-e[b],o=e[v]-e[_],h=e[y]-e[x],u=e[M]-e[b],c=e[D]-e[_],d=S*(o*(l=e[V]-e[x])-h*c),f=S*(h*u-a*l),p=S*(a*c-o*u),d/=g=0===(g=Math.sqrt(d*d+f*f+p*p))?1:g,f/=g,p/=g,I&&n&&(n.facetNormals[s].x=d,n.facetNormals[s].y=f,n.facetNormals[s].z=p),A&&n&&(n.facetPositions[s].x=(e[m]+e[b]+e[M])/3,n.facetPositions[s].y=(e[v]+e[_]+e[D])/3,n.facetPositions[s].z=(e[y]+e[x]+e[V])/3),w&&n&&(R=Math.floor((n.facetPositions[s].x-n.bInfo.minimum.x*O)*E),z=Math.floor((n.facetPositions[s].y-n.bInfo.minimum.y*O)*B),U=Math.floor((n.facetPositions[s].z-n.bInfo.minimum.z*O)*L),K=Math.floor((e[m]-n.bInfo.minimum.x*O)*E),N=Math.floor((e[v]-n.bInfo.minimum.y*O)*B),W=Math.floor((e[y]-n.bInfo.minimum.z*O)*L),k=Math.floor((e[b]-n.bInfo.minimum.x*O)*E),j=Math.floor((e[_]-n.bInfo.minimum.y*O)*B),G=Math.floor((e[x]-n.bInfo.minimum.z*O)*L),Q=Math.floor((e[M]-n.bInfo.minimum.x*O)*E),Y=Math.floor((e[D]-n.bInfo.minimum.y*O)*B),Z=Math.floor((e[V]-n.bInfo.minimum.z*O)*L),X=K+n.subDiv.max*N+F*W,q=k+n.subDiv.max*j+F*G,J=Q+n.subDiv.max*Y+F*Z,H=R+n.subDiv.max*z+F*U,n.facetPartitioning[H]=n.facetPartitioning[H]?n.facetPartitioning[H]:new Array,n.facetPartitioning[X]=n.facetPartitioning[X]?n.facetPartitioning[X]:new Array,n.facetPartitioning[q]=n.facetPartitioning[q]?n.facetPartitioning[q]:new Array,n.facetPartitioning[J]=n.facetPartitioning[J]?n.facetPartitioning[J]:new Array,n.facetPartitioning[X].push(s),q!=X&&n.facetPartitioning[q].push(s),J!=q&&J!=X&&n.facetPartitioning[J].push(s),H!=X&&H!=q&&H!=J&&n.facetPartitioning[H].push(s)),T&&n&&n.facetPositions){var te=C[s];te.ind=3*s,te.sqDistance=r.Vector3.DistanceSquared(n.facetPositions[s],P)}i[m]+=d,i[v]+=f,i[y]+=p,i[b]+=d,i[_]+=f,i[x]+=p,i[M]+=d,i[D]+=f,i[V]+=p}for(s=0;s<i.length/3;s++)d=i[3*s],f=i[3*s+1],p=i[3*s+2],d/=g=0===(g=Math.sqrt(d*d+f*f+p*p))?1:g,f/=g,p/=g,i[3*s]=d,i[3*s+1]=f,i[3*s+2]=p},e._ComputeSides=function(t,i,n,s,a,o,h){var u,c,l=n.length,d=s.length;switch(t=t||e.DEFAULTSIDE){case e.FRONTSIDE:break;case e.BACKSIDE:var f;for(u=0;u<l;u+=3)f=n[u],n[u]=n[u+2],n[u+2]=f;for(c=0;c<d;c++)s[c]=-s[c];break;case e.DOUBLESIDE:for(var p=i.length,g=p/3,m=0;m<p;m++)i[p+m]=i[m];for(u=0;u<l;u+=3)n[u+l]=n[u+2]+g,n[u+1+l]=n[u+1]+g,n[u+2+l]=n[u]+g;for(c=0;c<d;c++)s[d+c]=-s[c];var v=a.length,y=0;for(y=0;y<v;y++)a[y+v]=a[y];for(o=o||new r.Vector4(0,0,1,1),h=h||new r.Vector4(0,0,1,1),y=0,u=0;u<v/2;u++)a[y]=o.x+(o.z-o.x)*a[y],a[y+1]=o.y+(o.w-o.y)*a[y+1],a[y+v]=h.x+(h.z-h.x)*a[y+v],a[y+v+1]=h.y+(h.w-h.y)*a[y+v+1],y+=2}},e.ImportVertexData=function(t,i){var s=new e,a=t.positions;a&&s.set(a,n.b.PositionKind);var o=t.normals;o&&s.set(o,n.b.NormalKind);var h=t.tangents;h&&s.set(h,n.b.TangentKind);var u=t.uvs;u&&s.set(u,n.b.UVKind);var c=t.uv2s;c&&s.set(c,n.b.UV2Kind);var l=t.uv3s;l&&s.set(l,n.b.UV3Kind);var d=t.uv4s;d&&s.set(d,n.b.UV4Kind);var f=t.uv5s;f&&s.set(f,n.b.UV5Kind);var p=t.uv6s;p&&s.set(p,n.b.UV6Kind);var g=t.colors;g&&s.set(r.Color4.CheckColors4(g,a.length/3),n.b.ColorKind);var m=t.matricesIndices;m&&s.set(m,n.b.MatricesIndicesKind);var v=t.matricesWeights;v&&s.set(v,n.b.MatricesWeightsKind);var y=t.indices;y&&(s.indices=y),i.setAllVerticesData(s,t.updatable)},e.FRONTSIDE=0,e.BACKSIDE=1,e.DOUBLESIDE=2,e.DEFAULTSIDE=0,e}()},19:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function e(){}return e.IsWindowObjectExist=function(){return"undefined"!=typeof window},e.GetDOMTextContent=function(e){for(var t="",i=e.firstChild;i;)3===i.nodeType&&(t+=i.textContent),i=i.nextSibling;return t},e}()},2:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return n});var r=function(){function e(e,t,i,r,n,s,a){void 0===r&&(r=0),void 0===n&&(n=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=i,this._instanced=s,this._data=t,this.byteStride=a?r:r*Float32Array.BYTES_PER_ELEMENT,n||this.create()}return e.prototype.createVertexBuffer=function(e,t,i,r,s,a){void 0===a&&(a=!1);var o=a?t:t*Float32Array.BYTES_PER_ELEMENT,h=r?a?r:r*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new n(this._engine,this,e,this._updatable,!0,h,void 0===s?this._instanced:s,o,i,void 0,void 0,!0)},e.prototype.isUpdatable=function(){return this._updatable},e.prototype.getData=function(){return this._data},e.prototype.getBuffer=function(){return this._buffer},e.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},e.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},e.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},e.prototype.update=function(e){this.create(e)},e.prototype.updateDirectly=function(e,t,i,r){void 0===r&&(r=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,r?t:t*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),this._data=null)},e.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)},e}(),n=function(){function e(t,i,n,s,a,o,h,u,c,l,d,f){if(void 0===d&&(d=!1),void 0===f&&(f=!1),i instanceof r?(this._buffer=i,this._ownsBuffer=!1):(this._buffer=new r(t,i,s,o,a,h,f),this._ownsBuffer=!0),this._kind=n,null==l){var p=this.getData();this.type=e.FLOAT,p instanceof Int8Array?this.type=e.BYTE:p instanceof Uint8Array?this.type=e.UNSIGNED_BYTE:p instanceof Int16Array?this.type=e.SHORT:p instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:p instanceof Int32Array?this.type=e.INT:p instanceof Uint32Array&&(this.type=e.UNSIGNED_INT)}else this.type=l;var g=e.GetTypeByteLength(this.type);f?(this._size=c||(o?o/g:e.DeduceStride(n)),this.byteStride=o||this._buffer.byteStride||this._size*g,this.byteOffset=u||0):(this._size=c||o||e.DeduceStride(n),this.byteStride=o?o*g:this._buffer.byteStride||this._size*g,this.byteOffset=(u||0)*g),this.normalized=d,this._instanced=void 0!==h&&h,this._instanceDivisor=h?1:0}return Object.defineProperty(e.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e},enumerable:!0,configurable:!0}),e.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},e.prototype.getKind=function(){return this._kind},e.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},e.prototype.getData=function(){return this._buffer.getData()},e.prototype.getBuffer=function(){return this._buffer.getBuffer()},e.prototype.getStrideSize=function(){return this.byteStride/e.GetTypeByteLength(this.type)},e.prototype.getOffset=function(){return this.byteOffset/e.GetTypeByteLength(this.type)},e.prototype.getSize=function(){return this._size},e.prototype.getIsInstanced=function(){return this._instanced},e.prototype.getInstanceDivisor=function(){return this._instanceDivisor},e.prototype.create=function(e){this._buffer.create(e)},e.prototype.update=function(e){this._buffer.update(e)},e.prototype.updateDirectly=function(e,t,i){void 0===i&&(i=!1),this._buffer.updateDirectly(e,t,void 0,i)},e.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},e.prototype.forEach=function(t,i){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,i)},e.DeduceStride=function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}},e.GetTypeByteLength=function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '"+t+"'")}},e.ForEach=function(t,i,r,n,s,a,o,h){if(t instanceof Array)for(var u=i/4,c=r/4,l=0;l<a;l+=n){for(var d=0;d<n;d++)h(t[u+d],l+d);u+=c}else{var f=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),p=e.GetTypeByteLength(s);for(l=0;l<a;l+=n){var g=i;for(d=0;d<n;d++){h(e._GetFloatValue(f,s,g,o),l+d),g+=p}i+=r}}},e._GetFloatValue=function(t,i,r,n){switch(i){case e.BYTE:var s=t.getInt8(r);return n&&(s=Math.max(s/127,-1)),s;case e.UNSIGNED_BYTE:s=t.getUint8(r);return n&&(s/=255),s;case e.SHORT:s=t.getInt16(r,!0);return n&&(s=Math.max(s/16383,-1)),s;case e.UNSIGNED_SHORT:s=t.getUint16(r,!0);return n&&(s/=65535),s;case e.FLOAT:return t.getFloat32(r,!0);default:throw new Error("Invalid component type "+i)}},e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.PositionKind="position",e.NormalKind="normal",e.TangentKind="tangent",e.UVKind="uv",e.UV2Kind="uv2",e.UV3Kind="uv3",e.UV4Kind="uv4",e.UV5Kind="uv5",e.UV6Kind="uv6",e.ColorKind="color",e.MatricesIndicesKind="matricesIndices",e.MatricesWeightsKind="matricesWeights",e.MatricesIndicesExtraKind="matricesIndicesExtra",e.MatricesWeightsExtraKind="matricesWeightsExtra",e}()},21:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function e(){}return e.BuildArray=function(e,t){for(var i=[],r=0;r<e;++r)i.push(t());return i},e}()},22:function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s});var r=i(1),n=function(){function e(t){this.length=0,this.data=new Array(t),this._id=e._GlobalId++}return e.prototype.push=function(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2)},e.prototype.forEach=function(e){for(var t=0;t<this.length;t++)e(this.data[t])},e.prototype.sort=function(e){this.data.sort(e)},e.prototype.reset=function(){this.length=0},e.prototype.dispose=function(){this.reset(),this.data&&(this.data.length=0,this.data=[])},e.prototype.concat=function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}},e.prototype.indexOf=function(e){var t=this.data.indexOf(e);return t>=this.length?-1:t},e.prototype.contains=function(e){return-1!==this.indexOf(e)},e._GlobalId=0,e}(),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._duplicateId=0,t}return r.c(t,e),t.prototype.push=function(t){e.prototype.push.call(this,t),t.__smartArrayFlags||(t.__smartArrayFlags={}),t.__smartArrayFlags[this._id]=this._duplicateId},t.prototype.pushNoDuplicate=function(e){return(!e.__smartArrayFlags||e.__smartArrayFlags[this._id]!==this._duplicateId)&&(this.push(e),!0)},t.prototype.reset=function(){e.prototype.reset.call(this),this._duplicateId++},t.prototype.concatWithNoDuplicate=function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++){var i=(e.data||e)[t];this.pushNoDuplicate(i)}}},t}(n)},27:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var r=i(19),n=function(){function e(){}return Object.defineProperty(e,"Now",{get:function(){return r.a.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!0,configurable:!0}),e}()},30:function(e,t,i){"use strict";i.d(t,"a",function(){return u}),i.d(t,"b",function(){return c});var r=i(1),n=i(7),s=i(2),a=i(45),o=i(28),h=i(3),u=function(){function e(){}return Object.defineProperty(e.prototype,"effect",{get:function(){return this._materialEffect},enumerable:!0,configurable:!0}),e.prototype.setEffect=function(e,t){void 0===t&&(t=null),this._materialEffect!==e?(this._materialDefines=t,this._materialEffect=e):e||(this._materialDefines=null)},e}(),c=function(e){function t(t,i,r,n,s,a,o,h){void 0===h&&(h=!0);var u=e.call(this)||this;return u.materialIndex=t,u.verticesStart=i,u.verticesCount=r,u.indexStart=n,u.indexCount=s,u._renderId=0,u._mesh=a,u._renderingMesh=o||a,a.subMeshes.push(u),u._trianglePlanes=[],u._id=a.subMeshes.length-1,h&&(u.refreshBoundingInfo(),a.computeWorldMatrix(!0)),u}return r.c(t,e),t.AddToMesh=function(e,i,r,n,s,a,o,h){return void 0===h&&(h=!0),new t(e,i,r,n,s,a,o,h)},Object.defineProperty(t.prototype,"IsGlobal",{get:function(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()},enumerable:!0,configurable:!0}),t.prototype.getBoundingInfo=function(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo},t.prototype.setBoundingInfo=function(e){return this._boundingInfo=e,this},t.prototype.getMesh=function(){return this._mesh},t.prototype.getRenderingMesh=function(){return this._renderingMesh},t.prototype.getMaterial=function(){var e=this._renderingMesh.material;if(null==e)return this._mesh.getScene().defaultMaterial;if(e.getSubMaterial){var t=e.getSubMaterial(this.materialIndex);return this._currentMaterial!==t&&(this._currentMaterial=t,this._materialDefines=null),t}return e},t.prototype.refreshBoundingInfo=function(){if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;var e=this._renderingMesh.getVerticesData(s.b.PositionKind);if(!e)return this._boundingInfo=this._mesh.getBoundingInfo(),this;var t,i=this._renderingMesh.getIndices();if(0===this.indexStart&&this.indexCount===i.length){var r=this._renderingMesh.getBoundingInfo();t={minimum:r.minimum.clone(),maximum:r.maximum.clone()}}else t=n.c.ExtractMinAndMaxIndexed(e,i,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(t.minimum,t.maximum):this._boundingInfo=new o.a(t.minimum,t.maximum),this},t.prototype._checkCollision=function(e){return this.getBoundingInfo()._checkCollision(e)},t.prototype.updateBoundingInfo=function(e){var t=this.getBoundingInfo();return t||(this.refreshBoundingInfo(),t=this.getBoundingInfo()),t.update(e),this},t.prototype.isInFrustum=function(e){var t=this.getBoundingInfo();return!!t&&t.isInFrustum(e,this._mesh.cullingStrategy)},t.prototype.isCompletelyInFrustum=function(e){var t=this.getBoundingInfo();return!!t&&t.isCompletelyInFrustum(e)},t.prototype.render=function(e){return this._renderingMesh.render(this,e),this},t.prototype._getLinesIndexBuffer=function(e,t){if(!this._linesIndexBuffer){for(var i=[],r=this.indexStart;r<this.indexStart+this.indexCount;r+=3)i.push(e[r],e[r+1],e[r+1],e[r+2],e[r+2],e[r]);this._linesIndexBuffer=t.createIndexBuffer(i),this._linesIndexCount=i.length}return this._linesIndexBuffer},t.prototype.canIntersects=function(e){var t=this.getBoundingInfo();return!!t&&e.intersectsBox(t.boundingBox)},t.prototype.intersects=function(e,t,i,r){var n=this.getMaterial();if(!n)return null;switch(n.fillMode){case h.a.MATERIAL_PointListDrawMode:case h.a.MATERIAL_LineListDrawMode:case h.a.MATERIAL_LineLoopDrawMode:case h.a.MATERIAL_LineStripDrawMode:case h.a.MATERIAL_TriangleFanDrawMode:case h.a.MATERIAL_TriangleStripDrawMode:return null}return"InstancedLinesMesh"===this._mesh.getClassName()||"LinesMesh"===this._mesh.getClassName()?this._intersectLines(e,t,i,this._mesh.intersectionThreshold,r):this._intersectTriangles(e,t,i,r)},t.prototype._intersectLines=function(e,t,i,r,n){for(var s=null,o=this.indexStart;o<this.indexStart+this.indexCount;o+=2){var h=t[i[o]],u=t[i[o+1]],c=e.intersectionSegment(h,u,r);if(!(c<0)&&((n||!s||c<s.distance)&&((s=new a.a(null,null,c)).faceId=o/2,n)))break}return s},t.prototype._intersectTriangles=function(e,t,i,r){for(var n=null,s=this.indexStart;s<this.indexStart+this.indexCount;s+=3){var a=t[i[s]],o=t[i[s+1]],h=t[i[s+2]],u=e.intersectsTriangle(a,o,h);if(u){if(u.distance<0)continue;if((r||!n||u.distance<n.distance)&&((n=u).faceId=s/3,r))break}}return n},t.prototype._rebuild=function(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)},t.prototype.clone=function(e,i){var r=new t(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,e,i,!1);if(!this.IsGlobal){var n=this.getBoundingInfo();if(!n)return r;r._boundingInfo=new o.a(n.minimum,n.maximum)}return r},t.prototype.dispose=function(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);var e=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(e,1)},t.prototype.getClassName=function(){return"SubMesh"},t.CreateFromIndices=function(e,i,r,n,s){for(var a=Number.MAX_VALUE,o=-Number.MAX_VALUE,h=(s||n).getIndices(),u=i;u<i+r;u++){var c=h[u];c<a&&(a=c),c>o&&(o=c)}return new t(e,a,o-a+1,i,r,n,s)},t}(u)},37:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var r=function(e,t){return e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null},n=function(){function e(){}return e.DeepCopy=function(e,t,i,n){for(var s in e)if(("_"!==s[0]||n&&-1!==n.indexOf(s))&&(!i||-1===i.indexOf(s))){var a=e[s],o=typeof a;if("function"!==o)try{if("object"===o)if(a instanceof Array){if(t[s]=[],a.length>0)if("object"==typeof a[0])for(var h=0;h<a.length;h++){var u=r(a[h],t);-1===t[s].indexOf(u)&&t[s].push(u)}else t[s]=a.slice(0)}else t[s]=r(a,t);else t[s]=a}catch(e){}}},e}()},38:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function e(){this._count=0,this._data={}}return e.prototype.copyFrom=function(e){var t=this;this.clear(),e.forEach(function(e,i){return t.add(e,i)})},e.prototype.get=function(e){var t=this._data[e];if(void 0!==t)return t},e.prototype.getOrAddWithFactory=function(e,t){var i=this.get(e);return void 0!==i?i:((i=t(e))&&this.add(e,i),i)},e.prototype.getOrAdd=function(e,t){var i=this.get(e);return void 0!==i?i:(this.add(e,t),t)},e.prototype.contains=function(e){return void 0!==this._data[e]},e.prototype.add=function(e,t){return void 0===this._data[e]&&(this._data[e]=t,++this._count,!0)},e.prototype.set=function(e,t){return void 0!==this._data[e]&&(this._data[e]=t,!0)},e.prototype.getAndRemove=function(e){var t=this.get(e);return void 0!==t?(delete this._data[e],--this._count,t):null},e.prototype.remove=function(e){return!!this.contains(e)&&(delete this._data[e],--this._count,!0)},e.prototype.clear=function(){this._data={},this._count=0},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){for(var t in this._data){e(t,this._data[t])}},e.prototype.first=function(e){for(var t in this._data){var i=e(t,this._data[t]);if(i)return i}return null},e}()},4:function(e,t,i){"use strict";i.d(t,"b",function(){return c}),i.d(t,"c",function(){return l}),i.d(t,"j",function(){return d}),i.d(t,"d",function(){return f}),i.d(t,"g",function(){return p}),i.d(t,"k",function(){return g}),i.d(t,"h",function(){return m}),i.d(t,"f",function(){return v}),i.d(t,"e",function(){return y}),i.d(t,"i",function(){return b}),i.d(t,"a",function(){return _});var r=i(12),n=i(0),s={},a={},o=function(e,t,i){var n=e();r.a&&r.a.AddTagsTo(n,t.tags);var s=h(n);for(var a in s){var o=s[a],u=t[a],c=o.type;if(null!=u)switch(c){case 0:case 6:case 11:n[a]=u;break;case 1:n[a]=i||u.isRenderTarget?u:u.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:n[a]=i?u:u.clone()}}return n};function h(e){var t=e.getClassName();if(a[t])return a[t];a[t]={};for(var i=a[t],r=e,n=t;n;){var o=s[n];for(var h in o)i[h]=o[h];var u=void 0,c=!1;do{if(!(u=Object.getPrototypeOf(r)).getClassName){c=!0;break}if(u.getClassName()!==n)break;r=u}while(u);if(c)break;n=u.getClassName(),r=u}return i}function u(e,t){return function(i,r){var n=function(e){var t=e.getClassName();return s[t]||(s[t]={}),s[t]}(i);n[r]||(n[r]={type:e,sourceName:t})}}function c(e,t){return void 0===t&&(t=null),function(e,t){return void 0===t&&(t=null),function(i,r){var n=t||"_"+r;Object.defineProperty(i,r,{get:function(){return this[n]},set:function(t){this[n]!==t&&(this[n]=t,i[e].apply(this))},enumerable:!0,configurable:!0})}}(e,t)}function l(e){return u(0,e)}function d(e){return u(1,e)}function f(e){return u(2,e)}function p(e){return u(3,e)}function g(e){return u(5,e)}function m(e){return u(6,e)}function v(e){return u(7,e)}function y(e){return u(8,e)}function b(e){return u(10,e)}var _=function(){function e(){}return e.AppendSerializedAnimations=function(e,t){if(e.animations){t.animations=[];for(var i=0;i<e.animations.length;i++){var r=e.animations[i];t.animations.push(r.serialize())}}},e.Serialize=function(e,t){t||(t={}),r.a&&(t.tags=r.a.GetTags(e));var i=h(e);for(var n in i){var s=i[n],a=s.sourceName||n,o=s.type,u=e[n];if(null!=u)switch(o){case 0:t[a]=u;break;case 1:t[a]=u.serialize();break;case 2:t[a]=u.asArray();break;case 3:t[a]=u.serialize();break;case 4:case 5:t[a]=u.asArray();break;case 6:t[a]=u.id;break;case 7:t[a]=u.serialize();break;case 8:t[a]=u.asArray();break;case 9:t[a]=u.serialize();break;case 10:t[a]=u.asArray();break;case 11:t[a]=u.id}}return t},e.Parse=function(t,i,s,a){void 0===a&&(a=null);var o=t();a||(a=""),r.a&&r.a.AddTagsTo(o,i.tags);var u=h(o);for(var c in u){var l=u[c],d=i[l.sourceName||c],f=l.type;if(null!=d){var p=o;switch(f){case 0:p[c]=d;break;case 1:s&&(p[c]=e._TextureParser(d,s,a));break;case 2:p[c]=n.Color3.FromArray(d);break;case 3:p[c]=e._FresnelParametersParser(d);break;case 4:p[c]=n.Vector2.FromArray(d);break;case 5:p[c]=n.Vector3.FromArray(d);break;case 6:s&&(p[c]=s.getLastMeshByID(d));break;case 7:p[c]=e._ColorCurvesParser(d);break;case 8:p[c]=n.Color4.FromArray(d);break;case 9:p[c]=e._ImageProcessingConfigurationParser(d);break;case 10:p[c]=n.Quaternion.FromArray(d);break;case 11:s&&(p[c]=s.getCameraByID(d))}}}return o},e.Clone=function(e,t){return o(e,t,!1)},e.Instanciate=function(e,t){return o(e,t,!0)},e._ImageProcessingConfigurationParser=function(e){throw"ImageProcessingConfiguration needs to be imported before being deserialized."},e._FresnelParametersParser=function(e){throw"FresnelParameters needs to be imported before being deserialized."},e._ColorCurvesParser=function(e){throw"ColorCurves needs to be imported before being deserialized."},e._TextureParser=function(e,t,i){throw"Texture needs to be imported before being deserialized."},e}()},42:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var r=i(1),n=i(4),s=i(12),a=i(5),o=i(0),h=function(e){function t(i,r,n){void 0===r&&(r=null),void 0===n&&(n=!0);var s=e.call(this,i,r)||this;return s._forward=new o.Vector3(0,0,1),s._forwardInverted=new o.Vector3(0,0,-1),s._up=new o.Vector3(0,1,0),s._right=new o.Vector3(1,0,0),s._rightInverted=new o.Vector3(-1,0,0),s._position=o.Vector3.Zero(),s._rotation=o.Vector3.Zero(),s._scaling=o.Vector3.One(),s._isDirty=!1,s.billboardMode=t.BILLBOARDMODE_NONE,s.scalingDeterminant=1,s.infiniteDistance=!1,s.ignoreNonUniformScaling=!1,s._localMatrix=o.Matrix.Zero(),s._absolutePosition=o.Vector3.Zero(),s._pivotMatrix=o.Matrix.Identity(),s._postMultiplyPivotMatrix=!1,s._isWorldMatrixFrozen=!1,s._indexInSceneTransformNodesArray=-1,s.onAfterWorldMatrixUpdateObservable=new a.a,s._nonUniformScaling=!1,n&&s.getScene().addTransformNode(s),s}return r.c(t,e),t.prototype.getClassName=function(){return"TransformNode"},Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e,this._isDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e,this._isDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaling",{get:function(){return this._scaling},set:function(e){this._scaling=e,this._isDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationQuaternion",{get:function(){return this._rotationQuaternion},set:function(e){this._rotationQuaternion=e,e&&this.rotation.setAll(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forward",{get:function(){return o.Vector3.Normalize(o.Vector3.TransformNormal(this.getScene().useRightHandedSystem?this._forwardInverted:this._forward,this.getWorldMatrix()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"up",{get:function(){return o.Vector3.Normalize(o.Vector3.TransformNormal(this._up,this.getWorldMatrix()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return o.Vector3.Normalize(o.Vector3.TransformNormal(this.getScene().useRightHandedSystem?this._rightInverted:this._right,this.getWorldMatrix()))},enumerable:!0,configurable:!0}),t.prototype.updatePoseMatrix=function(e){return this._poseMatrix.copyFrom(e),this},t.prototype.getPoseMatrix=function(){return this._poseMatrix},t.prototype._isSynchronized=function(){return!this._isDirty&&(this.billboardMode===this._cache.billboardMode&&this.billboardMode===t.BILLBOARDMODE_NONE&&(!this._cache.pivotMatrixUpdated&&(!this.infiniteDistance&&(!!this._cache.position.equals(this._position)&&(!(this._rotationQuaternion&&!this._cache.rotationQuaternion.equals(this._rotationQuaternion))&&(!!this._cache.rotation.equals(this._rotation)&&!!this._cache.scaling.equals(this._scaling)))))))},t.prototype._initCache=function(){e.prototype._initCache.call(this),this._cache.localMatrixUpdated=!1,this._cache.position=o.Vector3.Zero(),this._cache.scaling=o.Vector3.Zero(),this._cache.rotation=o.Vector3.Zero(),this._cache.rotationQuaternion=new o.Quaternion(0,0,0,0),this._cache.billboardMode=-1,this._cache.infiniteDistance=!1},t.prototype.markAsDirty=function(e){return"rotation"===e&&(this.rotationQuaternion=null),this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this},Object.defineProperty(t.prototype,"absolutePosition",{get:function(){return this._absolutePosition},enumerable:!0,configurable:!0}),t.prototype.setPreTransformMatrix=function(e){return this.setPivotMatrix(e,!1)},t.prototype.setPivotMatrix=function(e,t){return void 0===t&&(t=!0),this._pivotMatrix.copyFrom(e),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=t,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=o.Matrix.Invert(this._pivotMatrix)),this},t.prototype.getPivotMatrix=function(){return this._pivotMatrix},t.prototype.freezeWorldMatrix=function(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this._isWorldMatrixFrozen=!0,this},t.prototype.unfreezeWorldMatrix=function(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this},Object.defineProperty(t.prototype,"isWorldMatrixFrozen",{get:function(){return this._isWorldMatrixFrozen},enumerable:!0,configurable:!0}),t.prototype.getAbsolutePosition=function(){return this.computeWorldMatrix(),this._absolutePosition},t.prototype.setAbsolutePosition=function(e){if(!e)return this;var t,i,r;if(void 0===e.x){if(arguments.length<3)return this;t=arguments[0],i=arguments[1],r=arguments[2]}else t=e.x,i=e.y,r=e.z;if(this.parent){var n=o.Tmp.Matrix[0];this.parent.getWorldMatrix().invertToRef(n),o.Vector3.TransformCoordinatesFromFloatsToRef(t,i,r,n,this.position)}else this.position.x=t,this.position.y=i,this.position.z=r;return this},t.prototype.setPositionWithLocalVector=function(e){return this.computeWorldMatrix(),this.position=o.Vector3.TransformNormal(e,this._localMatrix),this},t.prototype.getPositionExpressedInLocalSpace=function(){this.computeWorldMatrix();var e=o.Tmp.Matrix[0];return this._localMatrix.invertToRef(e),o.Vector3.TransformNormal(this.position,e)},t.prototype.locallyTranslate=function(e){return this.computeWorldMatrix(!0),this.position=o.Vector3.TransformCoordinates(e,this._localMatrix),this},t.prototype.lookAt=function(e,i,r,n,s){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===s&&(s=o.Space.LOCAL);var a=t._lookAtVectorCache,h=s===o.Space.LOCAL?this.position:this.getAbsolutePosition();if(e.subtractToRef(h,a),this.setDirection(a,i,r,n),s===o.Space.WORLD&&this.parent)if(this.rotationQuaternion){var u=o.Tmp.Matrix[0];this.rotationQuaternion.toRotationMatrix(u);var c=o.Tmp.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(c),c.invert(),u.multiplyToRef(c,u),this.rotationQuaternion.fromRotationMatrix(u)}else{var l=o.Tmp.Quaternion[0];o.Quaternion.FromEulerVectorToRef(this.rotation,l);u=o.Tmp.Matrix[0];l.toRotationMatrix(u);c=o.Tmp.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(c),c.invert(),u.multiplyToRef(c,u),l.fromRotationMatrix(u),l.toEulerAnglesToRef(this.rotation)}return this},t.prototype.getDirection=function(e){var t=o.Vector3.Zero();return this.getDirectionToRef(e,t),t},t.prototype.getDirectionToRef=function(e,t){return o.Vector3.TransformNormalToRef(e,this.getWorldMatrix(),t),this},t.prototype.setDirection=function(e,t,i,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0);var n=-Math.atan2(e.z,e.x)+Math.PI/2,s=Math.sqrt(e.x*e.x+e.z*e.z),a=-Math.atan2(e.y,s);return this.rotationQuaternion?o.Quaternion.RotationYawPitchRollToRef(n+t,a+i,r,this.rotationQuaternion):(this.rotation.x=a+i,this.rotation.y=n+t,this.rotation.z=r),this},t.prototype.setPivotPoint=function(e,t){void 0===t&&(t=o.Space.LOCAL),0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);var i=this.getWorldMatrix();if(t==o.Space.WORLD){var r=o.Tmp.Matrix[0];i.invertToRef(r),e=o.Vector3.TransformCoordinates(e,r)}return this.setPivotMatrix(o.Matrix.Translation(-e.x,-e.y,-e.z),!0)},t.prototype.getPivotPoint=function(){var e=o.Vector3.Zero();return this.getPivotPointToRef(e),e},t.prototype.getPivotPointToRef=function(e){return e.x=-this._pivotMatrix.m[12],e.y=-this._pivotMatrix.m[13],e.z=-this._pivotMatrix.m[14],this},t.prototype.getAbsolutePivotPoint=function(){var e=o.Vector3.Zero();return this.getAbsolutePivotPointToRef(e),e},t.prototype.getAbsolutePivotPointToRef=function(e){return e.x=this._pivotMatrix.m[12],e.y=this._pivotMatrix.m[13],e.z=this._pivotMatrix.m[14],this.getPivotPointToRef(e),o.Vector3.TransformCoordinatesToRef(e,this.getWorldMatrix(),e),this},t.prototype.setParent=function(e){if(!e&&!this.parent)return this;var t=o.Tmp.Quaternion[0],i=o.Tmp.Vector3[0],r=o.Tmp.Vector3[1];if(e){var n=o.Tmp.Matrix[0],s=o.Tmp.Matrix[1];this.computeWorldMatrix(!0),e.computeWorldMatrix(!0),e.getWorldMatrix().invertToRef(s),this.getWorldMatrix().multiplyToRef(s,n),n.decompose(r,t,i)}else this.parent&&this.parent.computeWorldMatrix&&this.parent.computeWorldMatrix(!0),this.computeWorldMatrix(!0),this.getWorldMatrix().decompose(r,t,i);return this.rotationQuaternion?this.rotationQuaternion.copyFrom(t):t.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(r),this.position.copyFrom(i),this.parent=e,this},Object.defineProperty(t.prototype,"nonUniformScaling",{get:function(){return this._nonUniformScaling},enumerable:!0,configurable:!0}),t.prototype._updateNonUniformScalingState=function(e){return this._nonUniformScaling!==e&&(this._nonUniformScaling=e,!0)},t.prototype.attachToBone=function(e,t){return this._transformToBoneReferal=t,this.parent=e,e.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this},t.prototype.detachFromBone=function(){return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,this.parent=null,this):this},t.prototype.rotate=function(e,i,r){var n;if(e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0)),r&&r!==o.Space.LOCAL){if(this.parent){var s=o.Tmp.Matrix[0];this.parent.getWorldMatrix().invertToRef(s),e=o.Vector3.TransformNormal(e,s)}(n=o.Quaternion.RotationAxisToRef(e,i,t._rotationAxisCache)).multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}else n=o.Quaternion.RotationAxisToRef(e,i,t._rotationAxisCache),this.rotationQuaternion.multiplyToRef(n,this.rotationQuaternion);return this},t.prototype.rotateAround=function(e,t,i){t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=o.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));var r=o.Tmp.Vector3[0],n=o.Tmp.Vector3[1],s=o.Tmp.Vector3[2],a=o.Tmp.Quaternion[0],h=o.Tmp.Matrix[0],u=o.Tmp.Matrix[1],c=o.Tmp.Matrix[2],l=o.Tmp.Matrix[3];return e.subtractToRef(this.position,r),o.Matrix.TranslationToRef(r.x,r.y,r.z,h),o.Matrix.TranslationToRef(-r.x,-r.y,-r.z,u),o.Matrix.RotationAxisToRef(t,i,c),u.multiplyToRef(c,l),l.multiplyToRef(h,l),l.decompose(n,a,s),this.position.addInPlace(s),a.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this},t.prototype.translate=function(e,t,i){var r=e.scale(t);if(i&&i!==o.Space.LOCAL)this.setAbsolutePosition(this.getAbsolutePosition().add(r));else{var n=this.getPositionExpressedInLocalSpace().add(r);this.setPositionWithLocalVector(n)}return this},t.prototype.addRotation=function(e,t,i){var r;this.rotationQuaternion?r=this.rotationQuaternion:(r=o.Tmp.Quaternion[1],o.Quaternion.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,r));var n=o.Tmp.Quaternion[0];return o.Quaternion.RotationYawPitchRollToRef(t,e,i,n),r.multiplyInPlace(n),this.rotationQuaternion||r.toEulerAnglesToRef(this.rotation),this},t.prototype.computeWorldMatrix=function(e){if(this._isWorldMatrixFrozen)return this._worldMatrix;if(!e&&this.isSynchronized())return this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix;(this._updateCache(),this._cache.position.copyFrom(this.position),this._cache.scaling.copyFrom(this.scaling),this._cache.pivotMatrixUpdated=!1,this._cache.billboardMode=this.billboardMode,this._cache.infiniteDistance=this.infiniteDistance,this._currentRenderId=this.getScene().getRenderId(),this._childRenderId=this.getScene().getRenderId(),this._isDirty=!1,o.Matrix.ScalingToRef(this.scaling.x*this.scalingDeterminant,this.scaling.y*this.scalingDeterminant,this.scaling.z*this.scalingDeterminant,o.Tmp.Matrix[1]),this.rotationQuaternion)&&(this.rotation.length()&&(this.rotationQuaternion.multiplyInPlace(o.Quaternion.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)),this.rotation.copyFromFloats(0,0,0)));this.rotationQuaternion?(this.rotationQuaternion.toRotationMatrix(o.Tmp.Matrix[0]),this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)):(o.Matrix.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,o.Tmp.Matrix[0]),this._cache.rotation.copyFrom(this.rotation));var i=this.getScene().activeCamera;if(this.infiniteDistance&&!this.parent&&i){var r=i.getWorldMatrix(),n=new o.Vector3(r.m[12],r.m[13],r.m[14]);o.Matrix.TranslationToRef(this.position.x+n.x,this.position.y+n.y,this.position.z+n.z,o.Tmp.Matrix[2])}else o.Matrix.TranslationToRef(this.position.x,this.position.y,this.position.z,o.Tmp.Matrix[2]);if(this._pivotMatrix.multiplyToRef(o.Tmp.Matrix[1],o.Tmp.Matrix[4]),o.Tmp.Matrix[4].multiplyToRef(o.Tmp.Matrix[0],o.Tmp.Matrix[5]),this.billboardMode!==t.BILLBOARDMODE_NONE&&i){if((this.billboardMode&t.BILLBOARDMODE_ALL)!==t.BILLBOARDMODE_ALL){var s=o.Tmp.Vector3[3];this.parent&&this.parent.getWorldMatrix?this._transformToBoneReferal?(this.parent.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),o.Tmp.Matrix[6]),o.Vector3.TransformCoordinatesToRef(this.position,o.Tmp.Matrix[6],s)):o.Vector3.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),s):s.copyFrom(this.position),s.subtractInPlace(i.globalPosition);var a=o.Tmp.Vector3[4].copyFromFloats(0,0,0);(this.billboardMode&t.BILLBOARDMODE_X)===t.BILLBOARDMODE_X&&(a.x=Math.atan2(-s.y,s.z)),(this.billboardMode&t.BILLBOARDMODE_Y)===t.BILLBOARDMODE_Y&&(a.y=Math.atan2(s.x,s.z)),(this.billboardMode&t.BILLBOARDMODE_Z)===t.BILLBOARDMODE_Z&&(a.z=Math.atan2(s.y,s.x)),o.Matrix.RotationYawPitchRollToRef(a.y,a.x,a.z,o.Tmp.Matrix[0])}else o.Tmp.Matrix[1].copyFrom(i.getViewMatrix()),o.Tmp.Matrix[1].setTranslationFromFloats(0,0,0),o.Tmp.Matrix[1].invertToRef(o.Tmp.Matrix[0]);o.Tmp.Matrix[1].copyFrom(o.Tmp.Matrix[5]),o.Tmp.Matrix[1].multiplyToRef(o.Tmp.Matrix[0],o.Tmp.Matrix[5])}return this._postMultiplyPivotMatrix&&o.Tmp.Matrix[5].multiplyToRef(this._pivotMatrixInverse,o.Tmp.Matrix[5]),o.Tmp.Matrix[5].multiplyToRef(o.Tmp.Matrix[2],this._localMatrix),this.parent&&this.parent.getWorldMatrix?(this.billboardMode!==t.BILLBOARDMODE_NONE?(this._transformToBoneReferal?(this.parent.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),o.Tmp.Matrix[6]),o.Tmp.Matrix[5].copyFrom(o.Tmp.Matrix[6])):o.Tmp.Matrix[5].copyFrom(this.parent.getWorldMatrix()),this._localMatrix.getTranslationToRef(o.Tmp.Vector3[5]),o.Vector3.TransformCoordinatesToRef(o.Tmp.Vector3[5],o.Tmp.Matrix[5],o.Tmp.Vector3[5]),this._worldMatrix.copyFrom(this._localMatrix),this._worldMatrix.setTranslation(o.Tmp.Vector3[5])):this._transformToBoneReferal?(this._localMatrix.multiplyToRef(this.parent.getWorldMatrix(),o.Tmp.Matrix[6]),o.Tmp.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()):this._worldMatrix.copyFrom(this._localMatrix),this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this.scaling.isNonUniform?this._updateNonUniformScalingState(!0):this.parent&&this.parent._nonUniformScaling?this._updateNonUniformScalingState(this.parent._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=o.Matrix.Invert(this._worldMatrix)),this._worldMatrixDeterminant=this._worldMatrix.determinant(),this._worldMatrix},t.prototype._afterComputeWorldMatrix=function(){},t.prototype.registerAfterWorldMatrixUpdate=function(e){return this.onAfterWorldMatrixUpdateObservable.add(e),this},t.prototype.unregisterAfterWorldMatrixUpdate=function(e){return this.onAfterWorldMatrixUpdateObservable.removeCallback(e),this},t.prototype.getPositionInCameraSpace=function(e){return void 0===e&&(e=null),e||(e=this.getScene().activeCamera),o.Vector3.TransformCoordinates(this.absolutePosition,e.getViewMatrix())},t.prototype.getDistanceToCamera=function(e){return void 0===e&&(e=null),e||(e=this.getScene().activeCamera),this.absolutePosition.subtract(e.position).length()},t.prototype.clone=function(e,i,r){var s=this,a=n.a.Clone(function(){return new t(e,s.getScene())},this);if(a.name=e,a.id=e,i&&(a.parent=i),!r)for(var o=this.getDescendants(!0),h=0;h<o.length;h++){var u=o[h];u.clone&&u.clone(e+"."+u.name,a)}return a},t.prototype.serialize=function(e){var t=n.a.Serialize(this,e);return t.type=this.getClassName(),this.parent&&(t.parentId=this.parent.id),s.a&&s.a.HasTags(this)&&(t.tags=s.a.GetTags(this)),t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(),this.parent&&(t.parentId=this.parent.id),t},t.Parse=function(e,i,r){var a=n.a.Parse(function(){return new t(e.name,i)},e,i,r);return s.a&&s.a.AddTagsTo(a,e.tags),e.localMatrix?a.setPreTransformMatrix(o.Matrix.FromArray(e.localMatrix)):e.pivotMatrix&&a.setPivotMatrix(o.Matrix.FromArray(e.pivotMatrix)),a.setEnabled(e.isEnabled),e.parentId&&(a._waitingParentId=e.parentId),a},t.prototype.getChildTransformNodes=function(e,i){var r=[];return this._getDescendants(r,e,function(e){return(!i||i(e))&&e instanceof t}),r},t.prototype.dispose=function(t,i){if(void 0===i&&(i=!1),this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this.onAfterWorldMatrixUpdateObservable.clear(),t)for(var r=0,n=this.getChildTransformNodes(!0);r<n.length;r++){var s=n[r];s.parent=null,s.computeWorldMatrix(!0)}e.prototype.dispose.call(this,t,i)},t.BILLBOARDMODE_NONE=0,t.BILLBOARDMODE_X=1,t.BILLBOARDMODE_Y=2,t.BILLBOARDMODE_Z=4,t.BILLBOARDMODE_ALL=7,t._lookAtVectorCache=new o.Vector3(0,0,0),t._rotationAxisCache=new o.Quaternion,r.b([Object(n.k)("position")],t.prototype,"_position",void 0),r.b([Object(n.k)("rotation")],t.prototype,"_rotation",void 0),r.b([Object(n.i)("rotationQuaternion")],t.prototype,"_rotationQuaternion",void 0),r.b([Object(n.k)("scaling")],t.prototype,"_scaling",void 0),r.b([Object(n.c)()],t.prototype,"billboardMode",void 0),r.b([Object(n.c)()],t.prototype,"scalingDeterminant",void 0),r.b([Object(n.c)()],t.prototype,"infiniteDistance",void 0),r.b([Object(n.c)()],t.prototype,"ignoreNonUniformScaling",void 0),t}(i(24).a)},43:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function e(){}return e.FilesToLoad={},e}()},5:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var r=function(){function e(e,t,i,r){void 0===t&&(t=!1),this.initalize(e,t,i,r)}return e.prototype.initalize=function(e,t,i,r){return void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t,this.target=i,this.currentTarget=r,this},e}(),n=function(){return function(e,t,i){void 0===i&&(i=null),this.callback=e,this.mask=t,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}(),s=(function(){function e(){}e.prototype.dispose=function(){if(this._observers&&this._observables)for(var e=0;e<this._observers.length;e++)this._observables[e].remove(this._observers[e]);this._observers=null,this._observables=null},e.Watch=function(t,i,r,n){void 0===r&&(r=-1),void 0===n&&(n=null);var s=new e;s._observers=new Array,s._observables=t;for(var a=0,o=t;a<o.length;a++){var h=o[a].add(i,r,!1,n);h&&s._observers.push(h)}return s}}(),function(){function e(e){this._observers=new Array,this._eventState=new r(0),e&&(this._onObserverAdded=e)}return e.prototype.add=function(e,t,i,r,s){if(void 0===t&&(t=-1),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===s&&(s=!1),!e)return null;var a=new n(e,t,r);return a.unregisterOnNextCall=s,i?this._observers.unshift(a):this._observers.push(a),this._onObserverAdded&&this._onObserverAdded(a),a},e.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)},e.prototype.remove=function(e){return!!e&&(-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))},e.prototype.removeCallback=function(e,t){for(var i=0;i<this._observers.length;i++)if(this._observers[i].callback===e&&(!t||t===this._observers[i].scope))return this._deferUnregister(this._observers[i]),!0;return!1},e.prototype._deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(function(){t._remove(e)},0)},e.prototype._remove=function(e){if(!e)return!1;var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e.prototype.notifyObservers=function(e,t,i,r){if(void 0===t&&(t=-1),!this._observers.length)return!0;var n=this._eventState;n.mask=t,n.target=i,n.currentTarget=r,n.skipNextObservers=!1,n.lastReturnValue=e;for(var s=0,a=this._observers;s<a.length;s++){var o=a[s];if(!o._willBeUnregistered&&(o.mask&t&&(o.scope?n.lastReturnValue=o.callback.apply(o.scope,[e,n]):n.lastReturnValue=o.callback(e,n),o.unregisterOnNextCall&&this._deferUnregister(o)),n.skipNextObservers))return!1}return!0},e.prototype.notifyObserversWithPromise=function(e,t,i,r){var n=this;void 0===t&&(t=-1);var s=Promise.resolve(e);if(!this._observers.length)return s;var a=this._eventState;return a.mask=t,a.target=i,a.currentTarget=r,a.skipNextObservers=!1,this._observers.forEach(function(i){a.skipNextObservers||i._willBeUnregistered||i.mask&t&&(s=i.scope?s.then(function(t){return a.lastReturnValue=t,i.callback.apply(i.scope,[e,a])}):s.then(function(t){return a.lastReturnValue=t,i.callback(e,a)}),i.unregisterOnNextCall&&n._deferUnregister(i))}),s.then(function(){return e})},e.prototype.notifyObserver=function(e,t,i){void 0===i&&(i=-1);var r=this._eventState;r.mask=i,r.skipNextObservers=!1,e.callback(t,r)},e.prototype.hasObservers=function(){return this._observers.length>0},e.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},e.prototype.clone=function(){var t=new e;return t._observers=this._observers.slice(0),t},e.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,i=this._observers;t<i.length;t++){var r=i[t];if(r.mask&e||r.mask===e)return!0}return!1},e}())},53:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var r=i(0),n=i(13),s=i(54),a=i(3),o=function(){return function(e,t,i,r){this.name=e,this.worldAxisForNormal=t,this.worldAxisForFileX=i,this.worldAxisForFileY=r}}(),h=function(){function e(){}return e.ConvertCubeMapTextureToSphericalPolynomial=function(e){if(!e.isCube)return null;var t,i,r=e.getSize().width,n=e.readPixels(0),s=e.readPixels(1);e.isRenderTarget?(t=e.readPixels(3),i=e.readPixels(2)):(t=e.readPixels(2),i=e.readPixels(3));var o=e.readPixels(4),h=e.readPixels(5),u=e.gammaSpace,c=a.a.TEXTUREFORMAT_RGBA,l=a.a.TEXTURETYPE_UNSIGNED_INT;e.textureType&&e.textureType!==a.a.TEXTURETYPE_UNSIGNED_INT&&(l=a.a.TEXTURETYPE_FLOAT);var d={size:r,right:n,left:s,up:t,down:i,front:o,back:h,format:c,type:l,gammaSpace:u};return this.ConvertCubeMapToSphericalPolynomial(d)},e.ConvertCubeMapToSphericalPolynomial=function(e){for(var t=new s.a,i=0,o=2/e.size,h=o,u=.5*o-1,c=0;c<6;c++)for(var l=this.FileFaces[c],d=e[l.name],f=u,p=e.format===a.a.TEXTUREFORMAT_RGBA?4:3,g=0;g<e.size;g++){for(var m=u,v=0;v<e.size;v++){var y=l.worldAxisForFileX.scale(m).add(l.worldAxisForFileY.scale(f)).add(l.worldAxisForNormal);y.normalize();var b=Math.pow(1+m*m+f*f,-1.5),_=d[g*e.size*p+v*p+0],x=d[g*e.size*p+v*p+1],M=d[g*e.size*p+v*p+2];e.type===a.a.TEXTURETYPE_UNSIGNED_INT&&(_/=255,x/=255,M/=255),e.gammaSpace&&(_=Math.pow(n.a.Clamp(_),r.ToLinearSpace),x=Math.pow(n.a.Clamp(x),r.ToLinearSpace),M=Math.pow(n.a.Clamp(M),r.ToLinearSpace));var D=new r.Color3(_,x,M);t.addLight(y,D,b),i+=b,m+=o}f+=h}var V=6*(4*Math.PI)/6/i;return t.scale(V),t.convertIncidentRadianceToIrradiance(),t.convertIrradianceToLambertianRadiance(),s.b.FromHarmonics(t)},e.FileFaces=[new o("right",new r.Vector3(1,0,0),new r.Vector3(0,0,-1),new r.Vector3(0,-1,0)),new o("left",new r.Vector3(-1,0,0),new r.Vector3(0,0,1),new r.Vector3(0,-1,0)),new o("up",new r.Vector3(0,1,0),new r.Vector3(1,0,0),new r.Vector3(0,0,1)),new o("down",new r.Vector3(0,-1,0),new r.Vector3(1,0,0),new r.Vector3(0,0,-1)),new o("front",new r.Vector3(0,0,1),new r.Vector3(1,0,0),new r.Vector3(0,-1,0)),new o("back",new r.Vector3(0,0,-1),new r.Vector3(-1,0,0),new r.Vector3(0,-1,0))],e}()},69:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var r=i(27),n=function(){function e(e){void 0===e&&(e=30),this._enabled=!0,this._rollingFrameTime=new s(e)}return e.prototype.sampleFrame=function(e){if(void 0===e&&(e=r.a.Now),this._enabled){if(null!=this._lastFrameTimeMs){var t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}},Object.defineProperty(e.prototype,"averageFrameTime",{get:function(){return this._rollingFrameTime.average},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"averageFrameTimeVariance",{get:function(){return this._rollingFrameTime.variance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instantaneousFrameTime",{get:function(){return this._rollingFrameTime.history(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"averageFPS",{get:function(){return 1e3/this._rollingFrameTime.average},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instantaneousFPS",{get:function(){var e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSaturated",{get:function(){return this._rollingFrameTime.isSaturated()},enumerable:!0,configurable:!0}),e.prototype.enable=function(){this._enabled=!0},e.prototype.disable=function(){this._enabled=!1,this._lastFrameTimeMs=null},Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._enabled},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()},e}(),s=function(){function e(e){this._samples=new Array(e),this.reset()}return e.prototype.add=function(e){var t;if(this.isSaturated()){var i=this._samples[this._pos];t=i-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(i-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length},e.prototype.history=function(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;var t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]},e.prototype.isSaturated=function(){return this._sampleCount>=this._samples.length},e.prototype.reset=function(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0},e.prototype._wrapPosition=function(e){var t=this._samples.length;return(e%t+t)%t},e}()},70:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var r,n=i(7);!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(r||(r={}));var s=function(){return function(){this.count=0,this.target=0,this.results=[]}}(),a=function(){function e(e){var t=this;if(this._state=r.Pending,this._children=new Array,this._rejectWasConsumed=!1,e)try{e(function(e){t._resolve(e)},function(e){t._reject(e)})}catch(e){this._reject(e)}}return Object.defineProperty(e.prototype,"_result",{get:function(){return this._resultValue},set:function(e){this._resultValue=e,this._parent&&void 0===this._parent._result&&(this._parent._result=e)},enumerable:!0,configurable:!0}),e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype.then=function(t,i){var s=this,a=new e;return a._onFulfilled=t,a._onRejected=i,this._children.push(a),a._parent=this,this._state!==r.Pending&&n.c.SetImmediate(function(){if(s._state===r.Fulfilled||s._rejectWasConsumed){var e=a._resolve(s._result);if(null!=e)if(void 0!==e._state){var t=e;a._children.push(t),t._parent=a,a=t}else a._result=e}else a._reject(s._reason)}),a},e.prototype._moveChildren=function(e){var t,i=this;if((t=this._children).push.apply(t,e.splice(0,e.length)),this._children.forEach(function(e){e._parent=i}),this._state===r.Fulfilled)for(var n=0,s=this._children;n<s.length;n++){s[n]._resolve(this._result)}else if(this._state===r.Rejected)for(var a=0,o=this._children;a<o.length;a++){o[a]._reject(this._reason)}},e.prototype._resolve=function(e){try{this._state=r.Fulfilled;var t=null;if(this._onFulfilled&&(t=this._onFulfilled(e)),null!=t)if(void 0!==t._state){var i=t;i._parent=this,i._moveChildren(this._children),e=i._result}else e=t;this._result=e;for(var n=0,s=this._children;n<s.length;n++){s[n]._resolve(e)}this._children.length=0,delete this._onFulfilled,delete this._onRejected}catch(e){this._reject(e,!0)}},e.prototype._reject=function(e,t){if(void 0===t&&(t=!1),this._state=r.Rejected,this._reason=e,this._onRejected&&!t)try{this._onRejected(e),this._rejectWasConsumed=!0}catch(t){e=t}for(var i=0,n=this._children;i<n.length;i++){var s=n[i];this._rejectWasConsumed?s._resolve(null):s._reject(e)}this._children.length=0,delete this._onFulfilled,delete this._onRejected},e.resolve=function(t){var i=new e;return i._resolve(t),i},e._RegisterForFulfillment=function(e,t,i){e.then(function(e){return t.results[i]=e,t.count++,t.count===t.target&&t.rootPromise._resolve(t.results),null},function(e){t.rootPromise._state!==r.Rejected&&t.rootPromise._reject(e)})},e.all=function(t){var i=new e,r=new s;if(r.target=t.length,r.rootPromise=i,t.length)for(var n=0;n<t.length;n++)e._RegisterForFulfillment(t[n],r,n);else i._resolve([]);return i},e.race=function(t){var i=new e;if(t.length)for(var r=0,n=t;r<n.length;r++){n[r].then(function(e){return i&&(i._resolve(e),i=null),null},function(e){i&&(i._reject(e),i=null)})}return i},e}(),o=function(){function e(){}return e.Apply=function(e){(void 0===e&&(e=!1),e||"undefined"==typeof Promise)&&(window.Promise=a)},e}()},71:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function e(){}return e.Eval=function(t,i){return"true"===(t=t.match(/\([^\(\)]*\)/g)?t.replace(/\([^\(\)]*\)/g,function(t){return t=t.slice(1,t.length-1),e._HandleParenthesisContent(t,i)}):e._HandleParenthesisContent(t,i))||"false"!==t&&e.Eval(t,i)},e._HandleParenthesisContent=function(t,i){var r;i=i||function(e){return"true"===e};var n=t.split("||");for(var s in n)if(n.hasOwnProperty(s)){var a=e._SimplifyNegation(n[s].trim()),o=a.split("&&");if(o.length>1)for(var h=0;h<o.length;++h){var u=e._SimplifyNegation(o[h].trim());if(!(r="true"!==u&&"false"!==u?"!"===u[0]?!i(u.substring(1)):i(u):"true"===u)){a="false";break}}if(r||"true"===a){r=!0;break}r="true"!==a&&"false"!==a?"!"===a[0]?!i(a.substring(1)):i(a):"true"===a}return r?"true":"false"},e._SimplifyNegation=function(e){return"!true"===(e=(e=e.replace(/^[\s!]+/,function(e){return(e=e.replace(/[\s]/g,function(){return""})).length%2?"!":""})).trim())?e="false":"!false"===e&&(e="true"),e},e}()},8:function(e,t,i){"use strict";var r=i(1),n=i(5),s=i(7),a=i(37),o=i(12),h=i(0),u=i(24),c=i(2),l=i(11),d=i(30),f=i(49),p=i(28),g=i(3),m=function(){function e(e,t,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=null),this.delayLoadState=g.a.DELAYLOADSTATE_NONE,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this.id=e,this.uniqueId=t.getUniqueId(),this._engine=t.getEngine(),this._meshes=[],this._scene=t,this._vertexBuffers={},this._indices=[],this._updatable=r,i?this.setAllVerticesData(i,r):(this._totalVertices=0,this._indices=[]),this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),n&&(this.applyToMesh(n),n.computeWorldMatrix(!0))}return Object.defineProperty(e.prototype,"boundingBias",{get:function(){return this._boundingBias},set:function(e){this._boundingBias?this._boundingBias.copyFrom(e):this._boundingBias=e.clone(),this._updateBoundingInfo(!0,null)},enumerable:!0,configurable:!0}),e.CreateGeometryForMesh=function(t){var i=new e(e.RandomId(),t.getScene());return i.applyToMesh(t),i},Object.defineProperty(e.prototype,"extend",{get:function(){return this._extend},enumerable:!0,configurable:!0}),e.prototype.getScene=function(){return this._scene},e.prototype.getEngine=function(){return this._engine},e.prototype.isReady=function(){return this.delayLoadState===g.a.DELAYLOADSTATE_LOADED||this.delayLoadState===g.a.DELAYLOADSTATE_NONE},Object.defineProperty(e.prototype,"doNotSerialize",{get:function(){for(var e=0;e<this._meshes.length;e++)if(!this._meshes[e].doNotSerialize)return!1;return!0},enumerable:!0,configurable:!0}),e.prototype._rebuild=function(){for(var e in this._vertexArrayObjects&&(this._vertexArrayObjects={}),0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._vertexBuffers){this._vertexBuffers[e]._rebuild()}},e.prototype.setAllVerticesData=function(e,t){e.applyToGeometry(this,t),this.notifyUpdate()},e.prototype.setVerticesData=function(e,t,i,r){void 0===i&&(i=!1);var n=new c.b(this._engine,t,e,i,0===this._meshes.length,r);this.setVerticesBuffer(n)},e.prototype.removeVerticesData=function(e){this._vertexBuffers[e]&&(this._vertexBuffers[e].dispose(),delete this._vertexBuffers[e])},e.prototype.setVerticesBuffer=function(e,t){void 0===t&&(t=null);var i=e.getKind();if(this._vertexBuffers[i]&&this._vertexBuffers[i].dispose(),this._vertexBuffers[i]=e,i===c.b.PositionKind){var r=e.getData();null!=t?this._totalVertices=t:null!=r&&(this._totalVertices=r.length/(e.byteStride/4)),this._updateExtend(r),this._resetPointsArrayCache();for(var n=this._meshes,s=n.length,a=0;a<s;a++){var o=n[a];o._boundingInfo=new p.a(this._extend.minimum,this._extend.maximum),o._createGlobalSubMesh(!1),o.computeWorldMatrix(!0)}}this.notifyUpdate(i),this._vertexArrayObjects&&(this._disposeVertexArrayObjects(),this._vertexArrayObjects={})},e.prototype.updateVerticesDataDirectly=function(e,t,i,r){void 0===r&&(r=!1);var n=this.getVertexBuffer(e);n&&(n.updateDirectly(t,i,r),this.notifyUpdate(e))},e.prototype.updateVerticesData=function(e,t,i){void 0===i&&(i=!1);var r=this.getVertexBuffer(e);r&&(r.update(t),e===c.b.PositionKind&&this._updateBoundingInfo(i,t),this.notifyUpdate(e))},e.prototype._updateBoundingInfo=function(e,t){if(e&&this._updateExtend(t),this._resetPointsArrayCache(),e)for(var i=0,r=this._meshes;i<r.length;i++){var n=r[i];n._boundingInfo?n._boundingInfo.reConstruct(this._extend.minimum,this._extend.maximum):n._boundingInfo=new p.a(this._extend.minimum,this._extend.maximum);for(var s=0,a=n.subMeshes;s<a.length;s++){a[s].refreshBoundingInfo()}}},e.prototype._bind=function(e,t){if(e){void 0===t&&(t=this._indexBuffer);var i=this.getVertexBuffers();i&&(t==this._indexBuffer&&this._vertexArrayObjects?(this._vertexArrayObjects[e.key]||(this._vertexArrayObjects[e.key]=this._engine.recordVertexArrayObject(i,t,e)),this._engine.bindVertexArrayObject(this._vertexArrayObjects[e.key],t)):this._engine.bindBuffers(i,t,e))}},e.prototype.getTotalVertices=function(){return this.isReady()?this._totalVertices:0},e.prototype.getVerticesData=function(e,t,i){var r=this.getVertexBuffer(e);if(!r)return null;var n=r.getData();if(!n)return null;var a=r.getSize()*c.b.GetTypeByteLength(r.type),o=this._totalVertices*r.getSize();if(r.type!==c.b.FLOAT||r.byteStride!==a){var h=[];return r.forEach(o,function(e){return h.push(e)}),h}if(!(n instanceof Array||n instanceof Float32Array)||0!==r.byteOffset||n.length!==o){if(n instanceof Array){var u=r.byteOffset/4;return s.c.Slice(n,u,u+o)}if(n instanceof ArrayBuffer)return new Float32Array(n,r.byteOffset,o);u=n.byteOffset+r.byteOffset;if(i||t&&1!==this._meshes.length){var l=new Float32Array(o),d=new Float32Array(n.buffer,u,o);return l.set(d),l}return new Float32Array(n.buffer,u,o)}return i||t&&1!==this._meshes.length?s.c.Slice(n):n},e.prototype.isVertexBufferUpdatable=function(e){var t=this._vertexBuffers[e];return!!t&&t.isUpdatable()},e.prototype.getVertexBuffer=function(e){return this.isReady()?this._vertexBuffers[e]:null},e.prototype.getVertexBuffers=function(){return this.isReady()?this._vertexBuffers:null},e.prototype.isVerticesDataPresent=function(e){return this._vertexBuffers?void 0!==this._vertexBuffers[e]:!!this._delayInfo&&-1!==this._delayInfo.indexOf(e)},e.prototype.getVerticesDataKinds=function(){var e,t=[];if(!this._vertexBuffers&&this._delayInfo)for(e in this._delayInfo)t.push(e);else for(e in this._vertexBuffers)t.push(e);return t},e.prototype.updateIndices=function(e,t){if(this._indexBuffer)if(this._indexBufferIsUpdatable){var i=e.length!==this._indices.length;if(this._indices=e,this._engine.updateDynamicIndexBuffer(this._indexBuffer,e,t),i)for(var r=0,n=this._meshes;r<n.length;r++){n[r]._createGlobalSubMesh(!0)}}else this.setIndices(e,null,!0)},e.prototype.setIndices=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=!1),this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._disposeVertexArrayObjects(),this._indices=e,this._indexBufferIsUpdatable=i,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,i)),null!=t&&(this._totalVertices=t);for(var r=0,n=this._meshes;r<n.length;r++){n[r]._createGlobalSubMesh(!0)}this.notifyUpdate()},e.prototype.getTotalIndices=function(){return this.isReady()?this._indices.length:0},e.prototype.getIndices=function(e,t){if(!this.isReady())return null;var i=this._indices;if(t||e&&1!==this._meshes.length){for(var r=i.length,n=[],s=0;s<r;s++)n.push(i[s]);return n}return i},e.prototype.getIndexBuffer=function(){return this.isReady()?this._indexBuffer:null},e.prototype._releaseVertexArrayObject=function(e){void 0===e&&(e=null),e&&this._vertexArrayObjects&&this._vertexArrayObjects[e.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[e.key]),delete this._vertexArrayObjects[e.key])},e.prototype.releaseForMesh=function(e,t){var i=this._meshes,r=i.indexOf(e);-1!==r&&(i.splice(r,1),e._geometry=null,0===i.length&&t&&this.dispose())},e.prototype.applyToMesh=function(e){if(e._geometry!==this){var t=e._geometry;t&&t.releaseForMesh(e);var i=this._meshes;e._geometry=this,this._scene.pushGeometry(this),i.push(e),this.isReady()?this._applyToMesh(e):e._boundingInfo=this._boundingInfo}},e.prototype._updateExtend=function(e){void 0===e&&(e=null),e||(e=this.getVerticesData(c.b.PositionKind)),this._extend=s.c.ExtractMinAndMax(e,0,this._totalVertices,this.boundingBias,3)},e.prototype._applyToMesh=function(e){var t=this._meshes.length;for(var i in this._vertexBuffers){1===t&&this._vertexBuffers[i].create();var r=this._vertexBuffers[i].getBuffer();r&&(r.references=t),i===c.b.PositionKind&&(this._extend||this._updateExtend(),e._boundingInfo=new p.a(this._extend.minimum,this._extend.maximum),e._createGlobalSubMesh(!1),e._updateBoundingInfo())}1===t&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._indexBuffer&&(this._indexBuffer.references=t),e._syncGeometryWithMorphTargetManager(),e.synchronizeInstances()},e.prototype.notifyUpdate=function(e){this.onGeometryUpdated&&this.onGeometryUpdated(this,e);for(var t=0,i=this._meshes;t<i.length;t++){i[t]._markSubMeshesAsAttributesDirty()}},e.prototype.load=function(e,t){this.delayLoadState!==g.a.DELAYLOADSTATE_LOADING&&(this.isReady()?t&&t():(this.delayLoadState=g.a.DELAYLOADSTATE_LOADING,this._queueLoad(e,t)))},e.prototype._queueLoad=function(e,t){var i=this;this.delayLoadingFile&&(e._addPendingData(this),e._loadFile(this.delayLoadingFile,function(r){if(i._delayLoadingFunction){i._delayLoadingFunction(JSON.parse(r),i),i.delayLoadState=g.a.DELAYLOADSTATE_LOADED,i._delayInfo=[],e._removePendingData(i);for(var n=i._meshes,s=n.length,a=0;a<s;a++)i._applyToMesh(n[a]);t&&t()}},void 0,!0))},e.prototype.toLeftHanded=function(){var e=this.getIndices(!1);if(null!=e&&e.length>0){for(var t=0;t<e.length;t+=3){var i=e[t+0];e[t+0]=e[t+2],e[t+2]=i}this.setIndices(e)}var r=this.getVerticesData(c.b.PositionKind,!1);if(null!=r&&r.length>0){for(t=0;t<r.length;t+=3)r[t+2]=-r[t+2];this.setVerticesData(c.b.PositionKind,r,!1)}var n=this.getVerticesData(c.b.NormalKind,!1);if(null!=n&&n.length>0){for(t=0;t<n.length;t+=3)n[t+2]=-n[t+2];this.setVerticesData(c.b.NormalKind,n,!1)}},e.prototype._resetPointsArrayCache=function(){this._positions=null},e.prototype._generatePointsArray=function(){if(this._positions)return!0;var e=this.getVerticesData(c.b.PositionKind);if(!e||0===e.length)return!1;this._positions=[];for(var t=0;t<e.length;t+=3)this._positions.push(h.Vector3.FromArray(e,t));return!0},e.prototype.isDisposed=function(){return this._isDisposed},e.prototype._disposeVertexArrayObjects=function(){if(this._vertexArrayObjects){for(var e in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[e]);this._vertexArrayObjects={}}},e.prototype.dispose=function(){var e,t=this._meshes,i=t.length;for(e=0;e<i;e++)this.releaseForMesh(t[e]);for(var r in this._meshes=[],this._disposeVertexArrayObjects(),this._vertexBuffers)this._vertexBuffers[r].dispose();this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=g.a.DELAYLOADSTATE_NONE,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._isDisposed=!0},e.prototype.copy=function(t){var i=new l.a;i.indices=[];var r=this.getIndices();if(r)for(var n=0;n<r.length;n++)i.indices.push(r[n]);var s,a=!1,o=!1;for(s in this._vertexBuffers){var h=this.getVerticesData(s);if(h&&(h instanceof Float32Array?i.set(new Float32Array(h),s):i.set(h.slice(0),s),!o)){var u=this.getVertexBuffer(s);u&&(o=!(a=u.isUpdatable()))}}var c=new e(t,this._scene,i,a);for(s in c.delayLoadState=this.delayLoadState,c.delayLoadingFile=this.delayLoadingFile,c._delayLoadingFunction=this._delayLoadingFunction,this._delayInfo)c._delayInfo=c._delayInfo||[],c._delayInfo.push(s);return c._boundingInfo=new p.a(this._extend.minimum,this._extend.maximum),c},e.prototype.serialize=function(){var e={};return e.id=this.id,e.updatable=this._updatable,o.a&&o.a.HasTags(this)&&(e.tags=o.a.GetTags(this)),e},e.prototype.toNumberArray=function(e){return Array.isArray(e)?e:Array.prototype.slice.call(e)},e.prototype.serializeVerticeData=function(){var e=this.serialize();return this.isVerticesDataPresent(c.b.PositionKind)&&(e.positions=this.toNumberArray(this.getVerticesData(c.b.PositionKind)),this.isVertexBufferUpdatable(c.b.PositionKind)&&(e.positions._updatable=!0)),this.isVerticesDataPresent(c.b.NormalKind)&&(e.normals=this.toNumberArray(this.getVerticesData(c.b.NormalKind)),this.isVertexBufferUpdatable(c.b.NormalKind)&&(e.normals._updatable=!0)),this.isVerticesDataPresent(c.b.TangentKind)&&(e.tangets=this.toNumberArray(this.getVerticesData(c.b.TangentKind)),this.isVertexBufferUpdatable(c.b.TangentKind)&&(e.tangets._updatable=!0)),this.isVerticesDataPresent(c.b.UVKind)&&(e.uvs=this.toNumberArray(this.getVerticesData(c.b.UVKind)),this.isVertexBufferUpdatable(c.b.UVKind)&&(e.uvs._updatable=!0)),this.isVerticesDataPresent(c.b.UV2Kind)&&(e.uv2s=this.toNumberArray(this.getVerticesData(c.b.UV2Kind)),this.isVertexBufferUpdatable(c.b.UV2Kind)&&(e.uv2s._updatable=!0)),this.isVerticesDataPresent(c.b.UV3Kind)&&(e.uv3s=this.toNumberArray(this.getVerticesData(c.b.UV3Kind)),this.isVertexBufferUpdatable(c.b.UV3Kind)&&(e.uv3s._updatable=!0)),this.isVerticesDataPresent(c.b.UV4Kind)&&(e.uv4s=this.toNumberArray(this.getVerticesData(c.b.UV4Kind)),this.isVertexBufferUpdatable(c.b.UV4Kind)&&(e.uv4s._updatable=!0)),this.isVerticesDataPresent(c.b.UV5Kind)&&(e.uv5s=this.toNumberArray(this.getVerticesData(c.b.UV5Kind)),this.isVertexBufferUpdatable(c.b.UV5Kind)&&(e.uv5s._updatable=!0)),this.isVerticesDataPresent(c.b.UV6Kind)&&(e.uv6s=this.toNumberArray(this.getVerticesData(c.b.UV6Kind)),this.isVertexBufferUpdatable(c.b.UV6Kind)&&(e.uv6s._updatable=!0)),this.isVerticesDataPresent(c.b.ColorKind)&&(e.colors=this.toNumberArray(this.getVerticesData(c.b.ColorKind)),this.isVertexBufferUpdatable(c.b.ColorKind)&&(e.colors._updatable=!0)),this.isVerticesDataPresent(c.b.MatricesIndicesKind)&&(e.matricesIndices=this.toNumberArray(this.getVerticesData(c.b.MatricesIndicesKind)),e.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(c.b.MatricesIndicesKind)&&(e.matricesIndices._updatable=!0)),this.isVerticesDataPresent(c.b.MatricesWeightsKind)&&(e.matricesWeights=this.toNumberArray(this.getVerticesData(c.b.MatricesWeightsKind)),this.isVertexBufferUpdatable(c.b.MatricesWeightsKind)&&(e.matricesWeights._updatable=!0)),e.indices=this.toNumberArray(this.getIndices()),e},e.ExtractFromMesh=function(e,t){var i=e._geometry;return i?i.copy(t):null},e.RandomId=function(){return s.c.RandomId()},e._ImportGeometry=function(t,i){var r=i.getScene(),n=t.geometryId;if(n){var s=r.getGeometryByID(n);s&&s.applyToMesh(i)}else if(t instanceof ArrayBuffer){var a=i._binaryInfo;if(a.positionsAttrDesc&&a.positionsAttrDesc.count>0){var o=new Float32Array(t,a.positionsAttrDesc.offset,a.positionsAttrDesc.count);i.setVerticesData(c.b.PositionKind,o,!1)}if(a.normalsAttrDesc&&a.normalsAttrDesc.count>0){var u=new Float32Array(t,a.normalsAttrDesc.offset,a.normalsAttrDesc.count);i.setVerticesData(c.b.NormalKind,u,!1)}if(a.tangetsAttrDesc&&a.tangetsAttrDesc.count>0){var l=new Float32Array(t,a.tangetsAttrDesc.offset,a.tangetsAttrDesc.count);i.setVerticesData(c.b.TangentKind,l,!1)}if(a.uvsAttrDesc&&a.uvsAttrDesc.count>0){var f=new Float32Array(t,a.uvsAttrDesc.offset,a.uvsAttrDesc.count);i.setVerticesData(c.b.UVKind,f,!1)}if(a.uvs2AttrDesc&&a.uvs2AttrDesc.count>0){var p=new Float32Array(t,a.uvs2AttrDesc.offset,a.uvs2AttrDesc.count);i.setVerticesData(c.b.UV2Kind,p,!1)}if(a.uvs3AttrDesc&&a.uvs3AttrDesc.count>0){var g=new Float32Array(t,a.uvs3AttrDesc.offset,a.uvs3AttrDesc.count);i.setVerticesData(c.b.UV3Kind,g,!1)}if(a.uvs4AttrDesc&&a.uvs4AttrDesc.count>0){var m=new Float32Array(t,a.uvs4AttrDesc.offset,a.uvs4AttrDesc.count);i.setVerticesData(c.b.UV4Kind,m,!1)}if(a.uvs5AttrDesc&&a.uvs5AttrDesc.count>0){var v=new Float32Array(t,a.uvs5AttrDesc.offset,a.uvs5AttrDesc.count);i.setVerticesData(c.b.UV5Kind,v,!1)}if(a.uvs6AttrDesc&&a.uvs6AttrDesc.count>0){var y=new Float32Array(t,a.uvs6AttrDesc.offset,a.uvs6AttrDesc.count);i.setVerticesData(c.b.UV6Kind,y,!1)}if(a.colorsAttrDesc&&a.colorsAttrDesc.count>0){var b=new Float32Array(t,a.colorsAttrDesc.offset,a.colorsAttrDesc.count);i.setVerticesData(c.b.ColorKind,b,!1,a.colorsAttrDesc.stride)}if(a.matricesIndicesAttrDesc&&a.matricesIndicesAttrDesc.count>0){for(var _=new Int32Array(t,a.matricesIndicesAttrDesc.offset,a.matricesIndicesAttrDesc.count),x=[],M=0;M<_.length;M++){var D=_[M];x.push(255&D),x.push((65280&D)>>8),x.push((16711680&D)>>16),x.push(D>>24)}i.setVerticesData(c.b.MatricesIndicesKind,x,!1)}if(a.matricesWeightsAttrDesc&&a.matricesWeightsAttrDesc.count>0){var V=new Float32Array(t,a.matricesWeightsAttrDesc.offset,a.matricesWeightsAttrDesc.count);i.setVerticesData(c.b.MatricesWeightsKind,V,!1)}if(a.indicesAttrDesc&&a.indicesAttrDesc.count>0){var I=new Int32Array(t,a.indicesAttrDesc.offset,a.indicesAttrDesc.count);i.setIndices(I,null)}if(a.subMeshesAttrDesc&&a.subMeshesAttrDesc.count>0){var A=new Int32Array(t,a.subMeshesAttrDesc.offset,5*a.subMeshesAttrDesc.count);i.subMeshes=[];for(M=0;M<a.subMeshesAttrDesc.count;M++){var w=A[5*M+0],T=A[5*M+1],S=A[5*M+2],O=A[5*M+3],P=A[5*M+4];d.b.AddToMesh(w,T,S,O,P,i)}}}else if(t.positions&&t.normals&&t.indices){if(i.setVerticesData(c.b.PositionKind,t.positions,t.positions._updatable),i.setVerticesData(c.b.NormalKind,t.normals,t.normals._updatable),t.tangents&&i.setVerticesData(c.b.TangentKind,t.tangents,t.tangents._updatable),t.uvs&&i.setVerticesData(c.b.UVKind,t.uvs,t.uvs._updatable),t.uvs2&&i.setVerticesData(c.b.UV2Kind,t.uvs2,t.uvs2._updatable),t.uvs3&&i.setVerticesData(c.b.UV3Kind,t.uvs3,t.uvs3._updatable),t.uvs4&&i.setVerticesData(c.b.UV4Kind,t.uvs4,t.uvs4._updatable),t.uvs5&&i.setVerticesData(c.b.UV5Kind,t.uvs5,t.uvs5._updatable),t.uvs6&&i.setVerticesData(c.b.UV6Kind,t.uvs6,t.uvs6._updatable),t.colors&&i.setVerticesData(c.b.ColorKind,h.Color4.CheckColors4(t.colors,t.positions.length/3),t.colors._updatable),t.matricesIndices)if(t.matricesIndices._isExpanded)delete t.matricesIndices._isExpanded,i.setVerticesData(c.b.MatricesIndicesKind,t.matricesIndices,t.matricesIndices._updatable);else{for(x=[],M=0;M<t.matricesIndices.length;M++){var C=t.matricesIndices[M];x.push(255&C),x.push((65280&C)>>8),x.push((16711680&C)>>16),x.push(C>>24)}i.setVerticesData(c.b.MatricesIndicesKind,x,t.matricesIndices._updatable)}if(t.matricesIndicesExtra)if(t.matricesIndicesExtra._isExpanded)delete t.matricesIndices._isExpanded,i.setVerticesData(c.b.MatricesIndicesExtraKind,t.matricesIndicesExtra,t.matricesIndicesExtra._updatable);else{for(x=[],M=0;M<t.matricesIndicesExtra.length;M++){C=t.matricesIndicesExtra[M];x.push(255&C),x.push((65280&C)>>8),x.push((16711680&C)>>16),x.push(C>>24)}i.setVerticesData(c.b.MatricesIndicesExtraKind,x,t.matricesIndicesExtra._updatable)}t.matricesWeights&&(e._CleanMatricesWeights(t,i),i.setVerticesData(c.b.MatricesWeightsKind,t.matricesWeights,t.matricesWeights._updatable)),t.matricesWeightsExtra&&i.setVerticesData(c.b.MatricesWeightsExtraKind,t.matricesWeightsExtra,t.matricesWeights._updatable),i.setIndices(t.indices,null)}if(t.subMeshes){i.subMeshes=[];for(var E=0;E<t.subMeshes.length;E++){var B=t.subMeshes[E];d.b.AddToMesh(B.materialIndex,B.verticesStart,B.verticesCount,B.indexStart,B.indexCount,i)}}i._shouldGenerateFlatShading&&(i.convertToFlatShadedMesh(),delete i._shouldGenerateFlatShading),i.computeWorldMatrix(!0),r.onMeshImportedObservable.notifyObservers(i)},e._CleanMatricesWeights=function(e,t){if(f.a.CleanBoneMatrixWeights){var i=0;if(e.skeletonId>-1){var r=t.getScene().getLastSkeletonByID(e.skeletonId);if(r){i=r.bones.length;for(var n=t.getVerticesData(c.b.MatricesIndicesKind),s=t.getVerticesData(c.b.MatricesIndicesExtraKind),a=e.matricesWeights,o=e.matricesWeightsExtra,h=e.numBoneInfluencer,u=a.length,l=0;l<u;l+=4){for(var d=0,p=-1,g=0;g<4;g++){d+=m=a[l+g],m<.001&&p<0&&(p=g)}if(o)for(g=0;g<4;g++){var m;d+=m=o[l+g],m<.001&&p<0&&(p=g+4)}if((p<0||p>h-1)&&(p=h-1),d>.001){var v=1/d;for(g=0;g<4;g++)a[l+g]*=v;if(o)for(g=0;g<4;g++)o[l+g]*=v}else p>=4?(o[l+p-4]=1-d,s[l+p-4]=i):(a[l+p]=1-d,n[l+p]=i)}t.setVerticesData(c.b.MatricesIndicesKind,n),e.matricesWeightsExtra&&t.setVerticesData(c.b.MatricesIndicesExtraKind,s)}}}},e.Parse=function(t,i,r){if(i.getGeometryByID(t.id))return null;var n=new e(t.id,i,void 0,t.updatable);return o.a&&o.a.AddTagsTo(n,t.tags),t.delayLoadingFile?(n.delayLoadState=g.a.DELAYLOADSTATE_NOTLOADED,n.delayLoadingFile=r+t.delayLoadingFile,n._boundingInfo=new p.a(h.Vector3.FromArray(t.boundingBoxMinimum),h.Vector3.FromArray(t.boundingBoxMaximum)),n._delayInfo=[],t.hasUVs&&n._delayInfo.push(c.b.UVKind),t.hasUVs2&&n._delayInfo.push(c.b.UV2Kind),t.hasUVs3&&n._delayInfo.push(c.b.UV3Kind),t.hasUVs4&&n._delayInfo.push(c.b.UV4Kind),t.hasUVs5&&n._delayInfo.push(c.b.UV5Kind),t.hasUVs6&&n._delayInfo.push(c.b.UV6Kind),t.hasColors&&n._delayInfo.push(c.b.ColorKind),t.hasMatricesIndices&&n._delayInfo.push(c.b.MatricesIndicesKind),t.hasMatricesWeights&&n._delayInfo.push(c.b.MatricesWeightsKind),n._delayLoadingFunction=l.a.ImportVertexData):l.a.ImportVertexData(t,n),i.pushGeometry(n,!0),n},e}(),v=function(e){function t(t,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=null);var s=e.call(this,t,i,void 0,!1,n)||this;return s._canBeRegenerated=r,s._beingRegenerated=!0,s.regenerate(),s._beingRegenerated=!1,s}return r.c(t,e),t.prototype.canBeRegenerated=function(){return this._canBeRegenerated},t.prototype.regenerate=function(){this._canBeRegenerated&&(this._beingRegenerated=!0,this.setAllVerticesData(this._regenerateVertexData(),!1),this._beingRegenerated=!1)},t.prototype.asNewGeometry=function(t){return e.prototype.copy.call(this,t)},t.prototype.setAllVerticesData=function(t,i){this._beingRegenerated&&e.prototype.setAllVerticesData.call(this,t,!1)},t.prototype.setVerticesData=function(t,i,r){this._beingRegenerated&&e.prototype.setVerticesData.call(this,t,i,!1)},t.prototype._regenerateVertexData=function(){throw new Error("Abstract method")},t.prototype.copy=function(e){throw new Error("Must be overriden in sub-classes.")},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.canBeRegenerated=this.canBeRegenerated(),t},t}(m),y=(function(e){function t(t,i,r,n,s,a,o,h,u){void 0===u&&(u=l.a.DEFAULTSIDE);var c=e.call(this,t,i,o,h)||this;return c.pathArray=r,c.closeArray=n,c.closePath=s,c.offset=a,c.side=u,c}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateRibbon({pathArray:this.pathArray,closeArray:this.closeArray,closePath:this.closePath,offset:this.offset,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.pathArray,this.closeArray,this.closePath,this.offset,this.canBeRegenerated(),void 0,this.side)}}(v),function(e){function t(t,i,r,n,s,a){void 0===s&&(s=null),void 0===a&&(a=l.a.DEFAULTSIDE);var o=e.call(this,t,i,n,s)||this;return o.size=r,o.side=a,o}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateBox({size:this.size,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.size,this.canBeRegenerated(),void 0,this.side)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.size=this.size,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.size,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),function(e){function t(t,i,r,n,s,a,o){void 0===a&&(a=null),void 0===o&&(o=l.a.DEFAULTSIDE);var h=e.call(this,t,i,s,a)||this;return h.segments=r,h.diameter=n,h.side=o,h}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateSphere({segments:this.segments,diameter:this.diameter,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.segments,this.diameter,this.canBeRegenerated(),null,this.side)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.segments=this.segments,t.diameter=this.diameter,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.segments,e.diameter,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),function(e){function t(t,i,r,n,s,a,o){void 0===a&&(a=null),void 0===o&&(o=l.a.DEFAULTSIDE);var h=e.call(this,t,i,s,a)||this;return h.radius=r,h.tessellation=n,h.side=o,h}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateDisc({radius:this.radius,tessellation:this.tessellation,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.radius,this.tessellation,this.canBeRegenerated(),null,this.side)}}(v),function(e){function t(t,i,r,n,s,a,o,h,u,c){void 0===o&&(o=1),void 0===u&&(u=null),void 0===c&&(c=l.a.DEFAULTSIDE);var d=e.call(this,t,i,h,u)||this;return d.height=r,d.diameterTop=n,d.diameterBottom=s,d.tessellation=a,d.subdivisions=o,d.side=c,d}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateCylinder({height:this.height,diameterTop:this.diameterTop,diameterBottom:this.diameterBottom,tessellation:this.tessellation,subdivisions:this.subdivisions,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.height,this.diameterTop,this.diameterBottom,this.tessellation,this.subdivisions,this.canBeRegenerated(),null,this.side)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.height=this.height,t.diameterTop=this.diameterTop,t.diameterBottom=this.diameterBottom,t.tessellation=this.tessellation,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.height,e.diameterTop,e.diameterBottom,e.tessellation,e.subdivisions,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),function(e){function t(t,i,r,n,s,a,o,h){void 0===o&&(o=null),void 0===h&&(h=l.a.DEFAULTSIDE);var u=e.call(this,t,i,a,o)||this;return u.diameter=r,u.thickness=n,u.tessellation=s,u.side=h,u}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateTorus({diameter:this.diameter,thickness:this.thickness,tessellation:this.tessellation,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.diameter,this.thickness,this.tessellation,this.canBeRegenerated(),null,this.side)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.diameter=this.diameter,t.thickness=this.thickness,t.tessellation=this.tessellation,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.diameter,e.thickness,e.tessellation,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),function(e){function t(t,i,r,n,s,a,o){void 0===o&&(o=null);var h=e.call(this,t,i,a,o)||this;return h.width=r,h.height=n,h.subdivisions=s,h}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateGround({width:this.width,height:this.height,subdivisions:this.subdivisions})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.width,this.height,this.subdivisions,this.canBeRegenerated(),null)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.width=this.width,t.height=this.height,t.subdivisions=this.subdivisions,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.width,e.height,e.subdivisions,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),function(e){function t(t,i,r,n,s,a,o,h,u,c){void 0===c&&(c=null);var l=e.call(this,t,i,u,c)||this;return l.xmin=r,l.zmin=n,l.xmax=s,l.zmax=a,l.subdivisions=o,l.precision=h,l}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateTiledGround({xmin:this.xmin,zmin:this.zmin,xmax:this.xmax,zmax:this.zmax,subdivisions:this.subdivisions,precision:this.precision})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.xmin,this.zmin,this.xmax,this.zmax,this.subdivisions,this.precision,this.canBeRegenerated(),null)}}(v),function(e){function t(t,i,r,n,s,a){void 0===s&&(s=null),void 0===a&&(a=l.a.DEFAULTSIDE);var o=e.call(this,t,i,n,s)||this;return o.size=r,o.side=a,o}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreatePlane({size:this.size,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.size,this.canBeRegenerated(),null,this.side)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.size=this.size,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.size,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),function(e){function t(t,i,r,n,s,a,o,h,u,c,d){void 0===c&&(c=null),void 0===d&&(d=l.a.DEFAULTSIDE);var f=e.call(this,t,i,u,c)||this;return f.radius=r,f.tube=n,f.radialSegments=s,f.tubularSegments=a,f.p=o,f.q=h,f.side=d,f}r.c(t,e),t.prototype._regenerateVertexData=function(){return l.a.CreateTorusKnot({radius:this.radius,tube:this.tube,radialSegments:this.radialSegments,tubularSegments:this.tubularSegments,p:this.p,q:this.q,sideOrientation:this.side})},t.prototype.copy=function(e){return new t(e,this.getScene(),this.radius,this.tube,this.radialSegments,this.tubularSegments,this.p,this.q,this.canBeRegenerated(),null,this.side)},t.prototype.serialize=function(){var t=e.prototype.serialize.call(this);return t.radius=this.radius,t.tube=this.tube,t.radialSegments=this.radialSegments,t.tubularSegments=this.tubularSegments,t.p=this.p,t.q=this.q,t},t.Parse=function(e,i){if(i.getGeometryByID(e.id))return null;var r=new t(e.id,i,e.radius,e.tube,e.radialSegments,e.tubularSegments,e.p,e.q,e.canBeRegenerated,null);return o.a&&o.a.AddTagsTo(r,e.tags),i.pushGeometry(r,!0),r}}(v),i(33)),b=i(15),_=i(14),x=i(58),M=i(4),D=i(9);i.d(t,"b",function(){return I}),i.d(t,"a",function(){return T});var V=function(){return function(e,t){this.distance=e,this.mesh=t}}(),I=function(){return function(){}}(),A=function(){return function(){this.visibleInstances={},this.renderIdForInstances=new Array,this.batchCache=new w,this.instancesBufferSize=2048}}(),w=function(){return function(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=new Array}}(),T=function(e){function t(i,r,n,s,h,u){void 0===r&&(r=null),void 0===n&&(n=null),void 0===s&&(s=null),void 0===u&&(u=!0);var c=e.call(this,i,r)||this;if(c.delayLoadState=g.a.DELAYLOADSTATE_NONE,c.instances=new Array,c._LODLevels=new Array,c._instanceDataStorage=new A,c._originalBuilderSideOrientation=t.DEFAULTSIDE,c.overrideMaterialSideOrientation=null,c._areNormalsFrozen=!1,c._source=null,c._isMesh=!0,r=c.getScene(),s){if(s._geometry&&s._geometry.applyToMesh(c),a.a.DeepCopy(s,c,["name","material","skeleton","instances","parent","uniqueId","source","metadata","hasLODLevels","geometry","isBlocked","areNormalsFrozen","onBeforeDrawObservable","onBeforeRenderObservable","onAfterRenderObservable","onBeforeDraw","onAfterWorldMatrixUpdateObservable","onCollideObservable","onCollisionPositionChangeObservable","onRebuildObservable","onDisposeObservable"],["_poseMatrix"]),c._source=s,r.useClonedMeshhMap&&(s.meshMap||(s.meshMap={}),s.meshMap[c.uniqueId]=c),c._originalBuilderSideOrientation=s._originalBuilderSideOrientation,c._creationDataStorage=s._creationDataStorage,c._source._ranges){var l=c._source._ranges;for(var i in l)l.hasOwnProperty(i)&&l[i]&&c.createAnimationRange(i,l[i].from,l[i].to)}var d;if(s.metadata&&s.metadata.clone?c.metadata=s.metadata.clone():c.metadata=s.metadata,o.a&&o.a.HasTags(s)&&o.a.AddTagsTo(c,o.a.GetTags(s,!0)),c.parent=s.parent,c.setPivotMatrix(s.getPivotMatrix()),c.id=i+"."+s.id,c.material=s.material,!h)for(var f=s.getDescendants(!0),p=0;p<f.length;p++){var m=f[p];m.clone&&m.clone(i+"."+m.name,c)}var v=c.getScene().getPhysicsEngine();if(u&&v){var y=v.getImpostorForPhysicsObject(s);y&&(c.physicsImpostor=y.clone(c))}for(d=0;d<r.particleSystems.length;d++){var b=r.particleSystems[d];b.emitter===s&&b.clone(b.name,c)}c.refreshBoundingInfo(),c.computeWorldMatrix(!0)}return null!==n&&(c.parent=n),c}return r.c(t,e),Object.defineProperty(t.prototype,"onBeforeRenderObservable",{get:function(){return this._onBeforeRenderObservable||(this._onBeforeRenderObservable=new n.a),this._onBeforeRenderObservable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAfterRenderObservable",{get:function(){return this._onAfterRenderObservable||(this._onAfterRenderObservable=new n.a),this._onAfterRenderObservable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBeforeDrawObservable",{get:function(){return this._onBeforeDrawObservable||(this._onBeforeDrawObservable=new n.a),this._onBeforeDrawObservable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onBeforeDraw",{set:function(e){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"morphTargetManager",{get:function(){return this._morphTargetManager},set:function(e){this._morphTargetManager!==e&&(this._morphTargetManager=e,this._syncGeometryWithMorphTargetManager())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUnIndexed",{get:function(){return this._unIndexed},set:function(e){this._unIndexed!==e&&(this._unIndexed=e,this._markSubMeshesAsAttributesDirty())},enumerable:!0,configurable:!0}),t.prototype.getClassName=function(){return"Mesh"},t.prototype.toString=function(t){var i=e.prototype.toString.call(this,t);if(i+=", n vertices: "+this.getTotalVertices(),i+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(var r=0;r<this.animations.length;r++)i+=", animation[0]: "+this.animations[r].toString(t);if(t)if(this._geometry){var n=this.getIndices(),s=this.getVerticesData(c.b.PositionKind);s&&n&&(i+=", flat shading: "+(s.length/3===n.length?"YES":"NO"))}else i+=", flat shading: UNKNOWN";return i},t.prototype._unBindEffect=function(){e.prototype._unBindEffect.call(this);for(var t=0,i=this.instances;t<i.length;t++){i[t]._unBindEffect()}},Object.defineProperty(t.prototype,"hasLODLevels",{get:function(){return this._LODLevels.length>0},enumerable:!0,configurable:!0}),t.prototype.getLODLevels=function(){return this._LODLevels},t.prototype._sortLODLevels=function(){this._LODLevels.sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})},t.prototype.addLODLevel=function(e,t){if(t&&t._masterMesh)return D.a.Warn("You cannot use a mesh as LOD level twice"),this;var i=new V(e,t);return this._LODLevels.push(i),t&&(t._masterMesh=this),this._sortLODLevels(),this},t.prototype.getLODLevelAtDistance=function(e){for(var t=0;t<this._LODLevels.length;t++){var i=this._LODLevels[t];if(i.distance===e)return i.mesh}return null},t.prototype.removeLODLevel=function(e){for(var t=0;t<this._LODLevels.length;t++)this._LODLevels[t].mesh===e&&(this._LODLevels.splice(t,1),e&&(e._masterMesh=null));return this._sortLODLevels(),this},t.prototype.getLOD=function(e,t){if(!this._LODLevels||0===this._LODLevels.length)return this;var i;t?i=t:i=this.getBoundingInfo().boundingSphere;var r=i.centerWorld.subtract(e.globalPosition).length();if(this._LODLevels[this._LODLevels.length-1].distance>r)return this.onLODLevelSelection&&this.onLODLevelSelection(r,this,this._LODLevels[this._LODLevels.length-1].mesh),this;for(var n=0;n<this._LODLevels.length;n++){var s=this._LODLevels[n];if(s.distance<r)return s.mesh&&(s.mesh._preActivate(),s.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)),this.onLODLevelSelection&&this.onLODLevelSelection(r,this,s.mesh),s.mesh}return this.onLODLevelSelection&&this.onLODLevelSelection(r,this,this),this},Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!0,configurable:!0}),t.prototype.getTotalVertices=function(){return null===this._geometry||void 0===this._geometry?0:this._geometry.getTotalVertices()},t.prototype.getVerticesData=function(e,t,i){return this._geometry?this._geometry.getVerticesData(e,t,i):null},t.prototype.getVertexBuffer=function(e){return this._geometry?this._geometry.getVertexBuffer(e):null},t.prototype.isVerticesDataPresent=function(e){return this._geometry?this._geometry.isVerticesDataPresent(e):!!this._delayInfo&&-1!==this._delayInfo.indexOf(e)},t.prototype.isVertexBufferUpdatable=function(e){return this._geometry?this._geometry.isVertexBufferUpdatable(e):!!this._delayInfo&&-1!==this._delayInfo.indexOf(e)},t.prototype.getVerticesDataKinds=function(){if(!this._geometry){var e=new Array;return this._delayInfo&&this._delayInfo.forEach(function(t){e.push(t)}),e}return this._geometry.getVerticesDataKinds()},t.prototype.getTotalIndices=function(){return this._geometry?this._geometry.getTotalIndices():0},t.prototype.getIndices=function(e,t){return this._geometry?this._geometry.getIndices(e,t):[]},Object.defineProperty(t.prototype,"isBlocked",{get:function(){return null!==this._masterMesh&&void 0!==this._masterMesh},enumerable:!0,configurable:!0}),t.prototype.isReady=function(t,i){if(void 0===t&&(t=!1),void 0===i&&(i=!1),this.delayLoadState===g.a.DELAYLOADSTATE_LOADING)return!1;if(!e.prototype.isReady.call(this,t))return!1;if(!this.subMeshes||0===this.subMeshes.length)return!0;if(!t)return!0;var r=this.getEngine(),n=this.getScene(),s=i||r.getCaps().instancedArrays&&this.instances.length>0;this.computeWorldMatrix();var a=this.material||n.defaultMaterial;if(a)if(a._storeEffectOnSubMeshes)for(var o=0,h=this.subMeshes;o<h.length;o++){var u=(m=h[o]).getMaterial();if(u)if(u._storeEffectOnSubMeshes){if(!u.isReadyForSubMesh(this,m,s))return!1}else if(!u.isReady(this,s))return!1}else if(!a.isReady(this,s))return!1;for(var c=0,l=this._lightSources;c<l.length;c++){var d=l[c].getShadowGenerator();if(d)for(var f=0,p=this.subMeshes;f<p.length;f++){var m=p[f];if(!d.isReady(m,s))return!1}}for(var v=0,y=this._LODLevels;v<y.length;v++){var b=y[v];if(b.mesh&&!b.mesh.isReady(s))return!1}return!0},Object.defineProperty(t.prototype,"areNormalsFrozen",{get:function(){return this._areNormalsFrozen},enumerable:!0,configurable:!0}),t.prototype.freezeNormals=function(){return this._areNormalsFrozen=!0,this},t.prototype.unfreezeNormals=function(){return this._areNormalsFrozen=!1,this},Object.defineProperty(t.prototype,"overridenInstanceCount",{set:function(e){this._instanceDataStorage.overridenInstanceCount=e},enumerable:!0,configurable:!0}),t.prototype._preActivate=function(){var e=this.getScene().getRenderId();return this._preActivateId===e?this:(this._preActivateId=e,this._instanceDataStorage.visibleInstances=null,this)},t.prototype._preActivateForIntermediateRendering=function(e){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=e),this},t.prototype._registerInstanceForRenderId=function(e,t){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:t,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[t]||(this._instanceDataStorage.visibleInstances[t]=new Array),this._instanceDataStorage.visibleInstances[t].push(e),this},t.prototype.refreshBoundingInfo=function(e){if(void 0===e&&(e=!1),this._boundingInfo&&this._boundingInfo.isLocked)return this;var t=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getPositionData(e),t),this},t.prototype._createGlobalSubMesh=function(e){var t=this.getTotalVertices();if(!t||!this.getIndices())return null;if(this.subMeshes&&this.subMeshes.length>0){var i=this.getIndices();if(!i)return null;var r=i.length,n=!1;if(e)n=!0;else for(var s=0,a=this.subMeshes;s<a.length;s++){var o=a[s];if(o.indexStart+o.indexCount>=r){n=!0;break}if(o.verticesStart+o.verticesCount>=t){n=!0;break}}if(!n)return this.subMeshes[0]}return this.releaseSubMeshes(),new d.b(0,0,t,0,this.getTotalIndices(),this)},t.prototype.subdivide=function(e){if(!(e<1)){for(var t=this.getTotalIndices(),i=t/e|0,r=0;i%3!=0;)i++;this.releaseSubMeshes();for(var n=0;n<e&&!(r>=t);n++)d.b.CreateFromIndices(0,r,Math.min(i,t-r),this),r+=i;this.synchronizeInstances()}},t.prototype.setVerticesData=function(e,t,i,r){if(void 0===i&&(i=!1),this._geometry)this._geometry.setVerticesData(e,t,i,r);else{var n=new l.a;n.set(t,e);var s=this.getScene();new m(m.RandomId(),s,n,i,this)}return this},t.prototype.markVerticesDataAsUpdatable=function(e,t){void 0===t&&(t=!0);var i=this.getVertexBuffer(e);i&&i.isUpdatable()!==t&&this.setVerticesData(e,this.getVerticesData(e),t)},t.prototype.setVerticesBuffer=function(e){return this._geometry||(this._geometry=m.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(e),this},t.prototype.updateVerticesData=function(e,t,i,r){return this._geometry?(r?(this.makeGeometryUnique(),this.updateVerticesData(e,t,i,!1)):this._geometry.updateVerticesData(e,t,i),this):this},t.prototype.updateMeshPositions=function(e,t){void 0===t&&(t=!0);var i=this.getVerticesData(c.b.PositionKind);if(!i)return this;if(e(i),this.updateVerticesData(c.b.PositionKind,i,!1,!1),t){var r=this.getIndices(),n=this.getVerticesData(c.b.NormalKind);if(!n)return this;l.a.ComputeNormals(i,r,n),this.updateVerticesData(c.b.NormalKind,n,!1,!1)}return this},t.prototype.makeGeometryUnique=function(){if(!this._geometry)return this;var e=this._geometry,t=this._geometry.copy(m.RandomId());return e.releaseForMesh(this,!0),t.applyToMesh(this),this},t.prototype.setIndices=function(e,t,i){if(void 0===t&&(t=null),void 0===i&&(i=!1),this._geometry)this._geometry.setIndices(e,t,i);else{var r=new l.a;r.indices=e;var n=this.getScene();new m(m.RandomId(),n,r,i,this)}return this},t.prototype.updateIndices=function(e,t){return this._geometry?(this._geometry.updateIndices(e,t),this):this},t.prototype.toLeftHanded=function(){return this._geometry?(this._geometry.toLeftHanded(),this):this},t.prototype._bind=function(e,t,i){if(!this._geometry)return this;var r,n=this.getScene().getEngine();if(this._unIndexed)r=null;else switch(i){case b.a.PointFillMode:r=null;break;case b.a.WireFrameFillMode:r=e._getLinesIndexBuffer(this.getIndices(),n);break;default:case b.a.TriangleFillMode:r=this._unIndexed?null:this._geometry.getIndexBuffer()}return this._geometry._bind(t,r),this},t.prototype._draw=function(e,t,i,r){if(void 0===r&&(r=!1),!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._onBeforeDrawObservable&&this._onBeforeDrawObservable.notifyObservers(this);var n=this.getScene(),s=n.getEngine();if(this._unIndexed||t==b.a.PointFillMode?s.drawArraysType(t,e.verticesStart,e.verticesCount,i):t==b.a.WireFrameFillMode?s.drawElementsType(t,0,e._linesIndexCount,i):s.drawElementsType(t,e.indexStart,e.indexCount,i),n._isAlternateRenderingEnabled&&!r){var a=e.effect||this._effectiveMaterial.getEffect();if(!a||!n.activeCamera)return this;n._switchToAlternateCameraConfiguration(!0),this._effectiveMaterial.bindView(a),this._effectiveMaterial.bindViewProjection(a),s.setViewport(n.activeCamera._alternateCamera.viewport),this._draw(e,t,i,!0),s.setViewport(n.activeCamera.viewport),n._switchToAlternateCameraConfiguration(!1),this._effectiveMaterial.bindView(a),this._effectiveMaterial.bindViewProjection(a)}return this},t.prototype.registerBeforeRender=function(e){return this.onBeforeRenderObservable.add(e),this},t.prototype.unregisterBeforeRender=function(e){return this.onBeforeRenderObservable.removeCallback(e),this},t.prototype.registerAfterRender=function(e){return this.onAfterRenderObservable.add(e),this},t.prototype.unregisterAfterRender=function(e){return this.onAfterRenderObservable.removeCallback(e),this},t.prototype._getInstancesRenderList=function(e){var t=this.getScene(),i=this._instanceDataStorage.batchCache;if(i.mustReturn=!1,i.renderSelf[e]=this.isEnabled()&&this.isVisible,i.visibleInstances[e]=null,this._instanceDataStorage.visibleInstances){var r=this._instanceDataStorage.visibleInstances,n=t.getRenderId(),s=t._isInIntermediateRendering()?r.intermediateDefaultRenderId:r.defaultRenderId;i.visibleInstances[e]=r[n];var a=this._renderId;!i.visibleInstances[e]&&s&&(i.visibleInstances[e]=r[s],n=Math.max(s,n),a=Math.max(r.selfDefaultRenderId,n));var o=i.visibleInstances[e];if(o&&o.length){if(this._instanceDataStorage.renderIdForInstances[e]===n)return i.mustReturn=!0,i;n!==a&&(i.renderSelf[e]=!1)}this._instanceDataStorage.renderIdForInstances[e]=n}return i},t.prototype._renderWithInstances=function(e,t,i,r,n){var s=i.visibleInstances[e._id];if(!s)return this;for(var a=16*(s.length+1)*4,o=this._instanceDataStorage,h=o.instancesBufferSize,u=o.instancesBuffer;o.instancesBufferSize<a;)o.instancesBufferSize*=2;o.instancesData&&h==o.instancesBufferSize||(o.instancesData=new Float32Array(o.instancesBufferSize/4));var l=0,d=0,f=this.getWorldMatrix();if(i.renderSelf[e._id]&&(f.copyToArray(o.instancesData,l),l+=16,d++),s)for(var p=0;p<s.length;p++){s[p].getWorldMatrix().copyToArray(o.instancesData,l),l+=16,d++}return u&&h==o.instancesBufferSize?u.updateDirectly(o.instancesData,0,d):(u&&u.dispose(),u=new c.a(n,o.instancesData,!0,16,!1,!0),o.instancesBuffer=u,this.setVerticesBuffer(u.createVertexBuffer("world0",0,4)),this.setVerticesBuffer(u.createVertexBuffer("world1",4,4)),this.setVerticesBuffer(u.createVertexBuffer("world2",8,4)),this.setVerticesBuffer(u.createVertexBuffer("world3",12,4))),this._bind(e,r,t),this._draw(e,t,d),n.unbindInstanceAttributes(),this},t.prototype._processRendering=function(e,t,i,r,n,s,a){var o=this.getScene().getEngine();if(n)this._renderWithInstances(e,i,r,t,o);else{r.renderSelf[e._id]&&(s&&s(!1,this.getWorldMatrix(),a),this._draw(e,i,this._instanceDataStorage.overridenInstanceCount));var h=r.visibleInstances[e._id];if(h)for(var u=0;u<h.length;u++){var c=h[u].getWorldMatrix();s&&s(!0,c,a),this._draw(e,i)}}return this},t.prototype.render=function(e,t){if(this._checkOcclusionQuery())return this;var i=this.getScene(),r=this._getInstancesRenderList(e._id);if(r.mustReturn)return this;if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._onBeforeRenderObservable&&this._onBeforeRenderObservable.notifyObservers(this);var n,s=i.getEngine(),a=s.getCaps().instancedArrays&&null!==r.visibleInstances[e._id]&&void 0!==r.visibleInstances[e._id],o=e.getMaterial();if(!o)return this;if(this._effectiveMaterial=o,this._effectiveMaterial._storeEffectOnSubMeshes){if(!this._effectiveMaterial.isReadyForSubMesh(this,e,a))return this}else if(!this._effectiveMaterial.isReady(this,a))return this;t&&s.setAlphaMode(this._effectiveMaterial.alphaMode);for(var h=0,u=i._beforeRenderingMeshStage;h<u.length;h++){u[h].action(this,e,r)}if(!(n=this._effectiveMaterial._storeEffectOnSubMeshes?e.effect:this._effectiveMaterial.getEffect()))return this;var c=this.skeleton&&this.skeleton.overrideMesh||this,l=this.overrideMaterialSideOrientation;null==l&&(l=this._effectiveMaterial.sideOrientation,c._getWorldMatrixDeterminant()<0&&(l=l===b.a.ClockWiseSideOrientation?b.a.CounterClockWiseSideOrientation:b.a.ClockWiseSideOrientation));var d=this._effectiveMaterial._preBind(n,l);this._effectiveMaterial.forceDepthWrite&&s.setDepthWrite(!0);var f=i.forcePointsCloud?b.a.PointFillMode:i.forceWireframe?b.a.WireFrameFillMode:this._effectiveMaterial.fillMode;a||this._bind(e,n,f);var p=c.getWorldMatrix();this._effectiveMaterial._storeEffectOnSubMeshes?this._effectiveMaterial.bindForSubMesh(p,this,e):this._effectiveMaterial.bind(p,this),!this._effectiveMaterial.backFaceCulling&&this._effectiveMaterial.separateCullingPass&&(s.setState(!0,this._effectiveMaterial.zOffset,!1,!d),this._processRendering(e,n,f,r,a,this._onBeforeDraw,this._effectiveMaterial),s.setState(!0,this._effectiveMaterial.zOffset,!1,d)),this._processRendering(e,n,f,r,a,this._onBeforeDraw,this._effectiveMaterial),this._effectiveMaterial.unbind();for(var g=0,m=i._afterRenderingMeshStage;g<m.length;g++){m[g].action(this,e,r)}return this._onAfterRenderObservable&&this._onAfterRenderObservable.notifyObservers(this),this},t.prototype._onBeforeDraw=function(e,t,i){e&&i&&i.bindOnlyWorldMatrix(t)},t.prototype.cleanMatrixWeights=function(){this.isVerticesDataPresent(c.b.MatricesWeightsKind)&&(this.isVerticesDataPresent(c.b.MatricesWeightsExtraKind)?this.normalizeSkinWeightsAndExtra():this.normalizeSkinFourWeights())},t.prototype.normalizeSkinFourWeights=function(){for(var e=this.getVerticesData(c.b.MatricesWeightsKind),t=e.length,i=0;i<t;i+=4){var r=e[i]+e[i+1]+e[i+2]+e[i+3];if(0===r)e[i]=1;else{var n=1/r;e[i]*=n,e[i+1]*=n,e[i+2]*=n,e[i+3]*=n}}this.setVerticesData(c.b.MatricesWeightsKind,e)},t.prototype.normalizeSkinWeightsAndExtra=function(){for(var e=this.getVerticesData(c.b.MatricesWeightsExtraKind),t=this.getVerticesData(c.b.MatricesWeightsKind),i=t.length,r=0;r<i;r+=4){var n=t[r]+t[r+1]+t[r+2]+t[r+3];if(0===(n+=e[r]+e[r+1]+e[r+2]+e[r+3]))t[r]=1;else{var s=1/n;t[r]*=s,t[r+1]*=s,t[r+2]*=s,t[r+3]*=s,e[r]*=s,e[r+1]*=s,e[r+2]*=s,e[r+3]*=s}}this.setVerticesData(c.b.MatricesWeightsKind,t),this.setVerticesData(c.b.MatricesWeightsKind,e)},t.prototype.validateSkinning=function(){var e=this.getVerticesData(c.b.MatricesWeightsExtraKind),t=this.getVerticesData(c.b.MatricesWeightsKind);if(null===t||null==this.skeleton)return{skinned:!1,valid:!0,report:"not skinned"};for(var i=t.length,r=0,n=0,s=0,a=0,o=null===e?4:8,h=new Array,u=0;u<=o;u++)h[u]=0;for(u=0;u<i;u+=4){for(var l=t[u],d=l,f=0===d?0:1,p=1;p<o;p++){var g=p<4?t[u+p]:e[u+p-4];g>l&&r++,0!==g&&f++,d+=g,l=g}if(h[f]++,f>s&&(s=f),0===d)n++;else{var m=1/d,v=0;for(p=0;p<o;p++)v+=p<4?Math.abs(t[u+p]-t[u+p]*m):Math.abs(e[u+p-4]-e[u+p-4]*m);v>.001&&a++}}var y=this.skeleton.bones.length,b=this.getVerticesData(c.b.MatricesIndicesKind),_=this.getVerticesData(c.b.MatricesIndicesExtraKind),x=0;for(u=0;u<i;u++)for(p=0;p<o;p++){var M=p<4?b[p]:_[p-4];(M>=y||M<0)&&x++}return{skinned:!0,valid:0===n&&0===a&&0===x,report:"Number of Weights = "+i/4+"\nMaximum influences = "+s+"\nMissing Weights = "+n+"\nNot Sorted = "+r+"\nNot Normalized = "+a+"\nWeightCounts = ["+h+"]\nNumber of bones = "+y+"\nBad Bone Indices = "+x}},t.prototype._checkDelayState=function(){var e=this.getScene();return this._geometry?this._geometry.load(e):this.delayLoadState===g.a.DELAYLOADSTATE_NOTLOADED&&(this.delayLoadState=g.a.DELAYLOADSTATE_LOADING,this._queueLoad(e)),this},t.prototype._queueLoad=function(e){var t=this;e._addPendingData(this);var i=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata");return s.c.LoadFile(this.delayLoadingFile,function(i){i instanceof ArrayBuffer?t._delayLoadingFunction(i,t):t._delayLoadingFunction(JSON.parse(i),t),t.instances.forEach(function(e){e._syncSubMeshes()}),t.delayLoadState=g.a.DELAYLOADSTATE_LOADED,e._removePendingData(t)},function(){},e.offlineProvider,i),this},t.prototype.isInFrustum=function(t){return this.delayLoadState!==g.a.DELAYLOADSTATE_LOADING&&(!!e.prototype.isInFrustum.call(this,t)&&(this._checkDelayState(),!0))},t.prototype.setMaterialByID=function(e){var t,i=this.getScene().materials;for(t=i.length-1;t>-1;t--)if(i[t].id===e)return this.material=i[t],this;var r=this.getScene().multiMaterials;for(t=r.length-1;t>-1;t--)if(r[t].id===e)return this.material=r[t],this;return this},t.prototype.getAnimatables=function(){var e=new Array;return this.material&&e.push(this.material),this.skeleton&&e.push(this.skeleton),e},t.prototype.bakeTransformIntoVertices=function(e){if(!this.isVerticesDataPresent(c.b.PositionKind))return this;var t=this.subMeshes.splice(0);this._resetPointsArrayCache();var i,r=this.getVerticesData(c.b.PositionKind),n=new Array;for(i=0;i<r.length;i+=3)h.Vector3.TransformCoordinates(h.Vector3.FromArray(r,i),e).toArray(n,i);if(this.setVerticesData(c.b.PositionKind,n,this.getVertexBuffer(c.b.PositionKind).isUpdatable()),this.isVerticesDataPresent(c.b.NormalKind)){for(r=this.getVerticesData(c.b.NormalKind),n=[],i=0;i<r.length;i+=3)h.Vector3.TransformNormal(h.Vector3.FromArray(r,i),e).normalize().toArray(n,i);this.setVerticesData(c.b.NormalKind,n,this.getVertexBuffer(c.b.NormalKind).isUpdatable())}return e.m[0]*e.m[5]*e.m[10]<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=t,this},t.prototype.bakeCurrentTransformIntoVertices=function(){return this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=h.Quaternion.Identity()),this._worldMatrix=h.Matrix.Identity(),this},Object.defineProperty(t.prototype,"_positions",{get:function(){return this._geometry?this._geometry._positions:null},enumerable:!0,configurable:!0}),t.prototype._resetPointsArrayCache=function(){return this._geometry&&this._geometry._resetPointsArrayCache(),this},t.prototype._generatePointsArray=function(){return!!this._geometry&&this._geometry._generatePointsArray()},t.prototype.clone=function(e,i,r,n){return void 0===e&&(e=""),void 0===n&&(n=!0),new t(e,this.getScene(),i,this,r,n)},t.prototype.dispose=function(t,i){if(void 0===i&&(i=!1),this.morphTargetManager=null,this._geometry&&this._geometry.releaseForMesh(this,!0),this._onBeforeDrawObservable&&this._onBeforeDrawObservable.clear(),this._onBeforeRenderObservable&&this._onBeforeRenderObservable.clear(),this._onAfterRenderObservable&&this._onAfterRenderObservable.clear(),this._scene.useClonedMeshhMap){if(this.meshMap)for(var r in this.meshMap){(a=this.meshMap[r])&&(a._source=null,this.meshMap[r]=void 0)}this._source&&this._source.meshMap&&(this._source.meshMap[this.uniqueId]=void 0)}else for(var n=0,s=this.getScene().meshes;n<s.length;n++){var a;(a=s[n])._source&&a._source===this&&(a._source=null)}for(this._source=null,this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();e.prototype.dispose.call(this,t,i)},t.prototype.applyDisplacementMap=function(e,t,i,r,n,a,o){var h=this;void 0===o&&(o=!1);var u=this.getScene();return s.c.LoadImage(e,function(e){var s=document.createElement("canvas"),u=s.getContext("2d"),c=e.width,l=e.height;s.width=c,s.height=l,u.drawImage(e,0,0);var d=u.getImageData(0,0,c,l).data;h.applyDisplacementMapFromBuffer(d,c,l,t,i,n,a,o),r&&r(h)},function(){},u.offlineProvider),this},t.prototype.applyDisplacementMapFromBuffer=function(e,t,i,r,n,s,a,o){if(void 0===o&&(o=!1),!this.isVerticesDataPresent(c.b.PositionKind)||!this.isVerticesDataPresent(c.b.NormalKind)||!this.isVerticesDataPresent(c.b.UVKind))return D.a.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;var u=this.getVerticesData(c.b.PositionKind,!0,!0),d=this.getVerticesData(c.b.NormalKind),f=this.getVerticesData(c.b.UVKind),p=h.Vector3.Zero(),g=h.Vector3.Zero(),m=h.Vector2.Zero();s=s||h.Vector2.Zero(),a=a||new h.Vector2(1,1);for(var v=0;v<u.length;v+=3){h.Vector3.FromArrayToRef(u,v,p),h.Vector3.FromArrayToRef(d,v,g),h.Vector2.FromArrayToRef(f,v/3*2,m);var y=4*((Math.abs(m.x*a.x+s.x)*t%t|0)+(Math.abs(m.y*a.y+s.y)*i%i|0)*t),b=.3*(e[y]/255)+.59*(e[y+1]/255)+.11*(e[y+2]/255);g.normalize(),g.scaleInPlace(r+(n-r)*b),(p=p.add(g)).toArray(u,v)}return l.a.ComputeNormals(u,this.getIndices(),d),o?(this.setVerticesData(c.b.PositionKind,u),this.setVerticesData(c.b.NormalKind,d)):(this.updateVerticesData(c.b.PositionKind,u),this.updateVerticesData(c.b.NormalKind,d)),this},t.prototype.convertToFlatShadedMesh=function(){var e,t,i=this.getVerticesDataKinds(),r={},n={},s={},a=!1;for(e=0;e<i.length;e++){t=i[e];var o=this.getVertexBuffer(t);t!==c.b.NormalKind?(r[t]=o,n[t]=r[t].getData(),s[t]=[]):(a=o.isUpdatable(),i.splice(e,1),e--)}var u,l=this.subMeshes.slice(0),f=this.getIndices(),p=this.getTotalIndices();for(u=0;u<p;u++){var g=f[u];for(e=0;e<i.length;e++)for(var m=r[t=i[e]].getStrideSize(),v=0;v<m;v++)s[t].push(n[t][g*m+v])}var y=[],b=s[c.b.PositionKind];for(u=0;u<p;u+=3){f[u]=u,f[u+1]=u+1,f[u+2]=u+2;for(var _=h.Vector3.FromArray(b,3*u),x=h.Vector3.FromArray(b,3*(u+1)),M=h.Vector3.FromArray(b,3*(u+2)),D=_.subtract(x),V=M.subtract(x),I=h.Vector3.Normalize(h.Vector3.Cross(D,V)),A=0;A<3;A++)y.push(I.x),y.push(I.y),y.push(I.z)}for(this.setIndices(f),this.setVerticesData(c.b.NormalKind,y,a),e=0;e<i.length;e++)t=i[e],this.setVerticesData(t,s[t],r[t].isUpdatable());this.releaseSubMeshes();for(var w=0;w<l.length;w++){var T=l[w];d.b.AddToMesh(T.materialIndex,T.indexStart,T.indexCount,T.indexStart,T.indexCount,this)}return this.synchronizeInstances(),this},t.prototype.convertToUnIndexedMesh=function(){var e,t,i=this.getVerticesDataKinds(),r={},n={},s={};for(e=0;e<i.length;e++){t=i[e];var a=this.getVertexBuffer(t);r[t]=a,n[t]=r[t].getData(),s[t]=[]}var o,h=this.subMeshes.slice(0),u=this.getIndices(),c=this.getTotalIndices();for(o=0;o<c;o++){var l=u[o];for(e=0;e<i.length;e++)for(var f=r[t=i[e]].getStrideSize(),p=0;p<f;p++)s[t].push(n[t][l*f+p])}for(o=0;o<c;o+=3)u[o]=o,u[o+1]=o+1,u[o+2]=o+2;for(this.setIndices(u),e=0;e<i.length;e++)t=i[e],this.setVerticesData(t,s[t],r[t].isUpdatable());this.releaseSubMeshes();for(var g=0;g<h.length;g++){var m=h[g];d.b.AddToMesh(m.materialIndex,m.indexStart,m.indexCount,m.indexStart,m.indexCount,this)}return this._unIndexed=!0,this.synchronizeInstances(),this},t.prototype.flipFaces=function(e){void 0===e&&(e=!1);var t,i,r=l.a.ExtractFromMesh(this);if(e&&this.isVerticesDataPresent(c.b.NormalKind)&&r.normals)for(t=0;t<r.normals.length;t++)r.normals[t]*=-1;if(r.indices)for(t=0;t<r.indices.length;t+=3)i=r.indices[t+1],r.indices[t+1]=r.indices[t+2],r.indices[t+2]=i;return r.applyToMesh(this),this},t.prototype.createInstance=function(e){return t._instancedMeshFactory(e,this)},t.prototype.synchronizeInstances=function(){for(var e=0;e<this.instances.length;e++){this.instances[e]._syncSubMeshes()}return this},t.prototype.optimizeIndices=function(e){var t=this,i=this.getIndices(),r=this.getVerticesData(c.b.PositionKind);if(!r||!i)return this;for(var n=new Array,a=0;a<r.length;a+=3)n.push(h.Vector3.FromArray(r,a));var o=new Array;return s.a.SyncAsyncForLoop(n.length,40,function(e){for(var t=n.length-1-e,i=n[t],r=0;r<t;++r){var s=n[r];if(i.equals(s)){o[t]=r;break}}},function(){for(var r=0;r<i.length;++r)i[r]=o[i[r]]||i[r];var n=t.subMeshes.slice(0);t.setIndices(i),t.subMeshes=n,e&&e(t)}),this},t.prototype.serialize=function(e){e.name=this.name,e.id=this.id,e.type=this.getClassName(),o.a&&o.a.HasTags(this)&&(e.tags=o.a.GetTags(this)),e.position=this.position.asArray(),this.rotationQuaternion?e.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(e.rotation=this.rotation.asArray()),e.scaling=this.scaling.asArray(),this._postMultiplyPivotMatrix?e.pivotMatrix=this.getPivotMatrix().asArray():e.localMatrix=this.getPivotMatrix().asArray(),e.isEnabled=this.isEnabled(!1),e.isVisible=this.isVisible,e.infiniteDistance=this.infiniteDistance,e.pickable=this.isPickable,e.receiveShadows=this.receiveShadows,e.billboardMode=this.billboardMode,e.visibility=this.visibility,e.checkCollisions=this.checkCollisions,e.isBlocker=this.isBlocker,this.parent&&(e.parentId=this.parent.id),e.isUnIndexed=this.isUnIndexed;var t=this._geometry;if(t){var i=t.id;e.geometryId=i,e.subMeshes=[];for(var r=0;r<this.subMeshes.length;r++){var n=this.subMeshes[r];e.subMeshes.push({materialIndex:n.materialIndex,verticesStart:n.verticesStart,verticesCount:n.verticesCount,indexStart:n.indexStart,indexCount:n.indexCount})}}this.material?e.materialId=this.material.id:this.material=null,this.morphTargetManager&&(e.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(e.skeletonId=this.skeleton.id);var s=this.getPhysicsImpostor();s&&(e.physicsMass=s.getParam("mass"),e.physicsFriction=s.getParam("friction"),e.physicsRestitution=s.getParam("mass"),e.physicsImpostor=s.type),this.metadata&&(e.metadata=this.metadata),e.instances=[];for(var a=0;a<this.instances.length;a++){var h=this.instances[a];if(!h.doNotSerialize){var u={name:h.name,id:h.id,position:h.position.asArray(),scaling:h.scaling.asArray()};h.parent&&(u.parentId=h.parent.id),h.rotationQuaternion?u.rotationQuaternion=h.rotationQuaternion.asArray():h.rotation&&(u.rotation=h.rotation.asArray()),e.instances.push(u),M.a.AppendSerializedAnimations(h,u),u.ranges=h.serializeAnimationRanges()}}M.a.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.layerMask=this.layerMask,e.alphaIndex=this.alphaIndex,e.hasVertexAlpha=this.hasVertexAlpha,e.overlayAlpha=this.overlayAlpha,e.overlayColor=this.overlayColor.asArray(),e.renderOverlay=this.renderOverlay,e.applyFog=this.applyFog,this.actionManager&&(e.actions=this.actionManager.serialize(this.name))},t.prototype._syncGeometryWithMorphTargetManager=function(){if(this.geometry){this._markSubMeshesAsAttributesDirty();var e=this._morphTargetManager;if(e&&e.vertexCount){if(e.vertexCount!==this.getTotalVertices())return D.a.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),void(this.morphTargetManager=null);for(var t=0;t<e.numInfluencers;t++){var i=e.getActiveTarget(t),r=i.getPositions();if(!r)return void D.a.Error("Invalid morph target. Target must have positions.");this.geometry.setVerticesData(c.b.PositionKind+t,r,!1,3);var n=i.getNormals();n&&this.geometry.setVerticesData(c.b.NormalKind+t,n,!1,3);var s=i.getTangents();s&&this.geometry.setVerticesData(c.b.TangentKind+t,s,!1,3)}}else for(t=0;this.geometry.isVerticesDataPresent(c.b.PositionKind+t);)this.geometry.removeVerticesData(c.b.PositionKind+t),this.geometry.isVerticesDataPresent(c.b.NormalKind+t)&&this.geometry.removeVerticesData(c.b.NormalKind+t),this.geometry.isVerticesDataPresent(c.b.TangentKind+t)&&this.geometry.removeVerticesData(c.b.TangentKind+t),t++}},t.Parse=function(e,i,r){var n;if((n=e.type&&"GroundMesh"===e.type?t._GroundMeshParser(e,i):new t(e.name,i)).id=e.id,o.a&&o.a.AddTagsTo(n,e.tags),n.position=h.Vector3.FromArray(e.position),void 0!==e.metadata&&(n.metadata=e.metadata),e.rotationQuaternion?n.rotationQuaternion=h.Quaternion.FromArray(e.rotationQuaternion):e.rotation&&(n.rotation=h.Vector3.FromArray(e.rotation)),n.scaling=h.Vector3.FromArray(e.scaling),e.localMatrix?n.setPreTransformMatrix(h.Matrix.FromArray(e.localMatrix)):e.pivotMatrix&&n.setPivotMatrix(h.Matrix.FromArray(e.pivotMatrix)),n.setEnabled(e.isEnabled),n.isVisible=e.isVisible,n.infiniteDistance=e.infiniteDistance,n.showBoundingBox=e.showBoundingBox,n.showSubMeshesBoundingBox=e.showSubMeshesBoundingBox,void 0!==e.applyFog&&(n.applyFog=e.applyFog),void 0!==e.pickable&&(n.isPickable=e.pickable),void 0!==e.alphaIndex&&(n.alphaIndex=e.alphaIndex),n.receiveShadows=e.receiveShadows,n.billboardMode=e.billboardMode,void 0!==e.visibility&&(n.visibility=e.visibility),n.checkCollisions=e.checkCollisions,void 0!==e.isBlocker&&(n.isBlocker=e.isBlocker),n._shouldGenerateFlatShading=e.useFlatShading,e.freezeWorldMatrix&&(n._waitingFreezeWorldMatrix=e.freezeWorldMatrix),e.parentId&&(n._waitingParentId=e.parentId),void 0!==e.actions&&(n._waitingActions=e.actions),void 0!==e.overlayAlpha&&(n.overlayAlpha=e.overlayAlpha),void 0!==e.overlayColor&&(n.overlayColor=h.Color3.FromArray(e.overlayColor)),void 0!==e.renderOverlay&&(n.renderOverlay=e.renderOverlay),n.isUnIndexed=!!e.isUnIndexed,n.hasVertexAlpha=e.hasVertexAlpha,e.delayLoadingFile?(n.delayLoadState=g.a.DELAYLOADSTATE_NOTLOADED,n.delayLoadingFile=r+e.delayLoadingFile,n._boundingInfo=new p.a(h.Vector3.FromArray(e.boundingBoxMinimum),h.Vector3.FromArray(e.boundingBoxMaximum)),e._binaryInfo&&(n._binaryInfo=e._binaryInfo),n._delayInfo=[],e.hasUVs&&n._delayInfo.push(c.b.UVKind),e.hasUVs2&&n._delayInfo.push(c.b.UV2Kind),e.hasUVs3&&n._delayInfo.push(c.b.UV3Kind),e.hasUVs4&&n._delayInfo.push(c.b.UV4Kind),e.hasUVs5&&n._delayInfo.push(c.b.UV5Kind),e.hasUVs6&&n._delayInfo.push(c.b.UV6Kind),e.hasColors&&n._delayInfo.push(c.b.ColorKind),e.hasMatricesIndices&&n._delayInfo.push(c.b.MatricesIndicesKind),e.hasMatricesWeights&&n._delayInfo.push(c.b.MatricesWeightsKind),n._delayLoadingFunction=m._ImportGeometry,f.a.ForceFullSceneLoadingForIncremental&&n._checkDelayState()):m._ImportGeometry(e,n),e.materialId?n.setMaterialByID(e.materialId):n.material=null,e.morphTargetManagerId>-1&&(n.morphTargetManager=i.getMorphTargetManagerById(e.morphTargetManagerId)),e.skeletonId>-1&&(n.skeleton=i.getLastSkeletonByID(e.skeletonId),e.numBoneInfluencers&&(n.numBoneInfluencers=e.numBoneInfluencers)),e.animations){for(var s=0;s<e.animations.length;s++){var a=e.animations[s];n.animations.push(_.a.Parse(a))}u.a.ParseAnimationRanges(n,e,i)}if(e.autoAnimate&&i.beginAnimation(n,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),e.layerMask&&!isNaN(e.layerMask)?n.layerMask=Math.abs(parseInt(e.layerMask)):n.layerMask=268435455,e.physicsImpostor&&(n.physicsImpostor=new x.a(n,e.physicsImpostor,{mass:e.physicsMass,friction:e.physicsFriction,restitution:e.physicsRestitution},i)),e.instances)for(var l=0;l<e.instances.length;l++){var d=e.instances[l],v=n.createInstance(d.name);if(d.id&&(v.id=d.id),o.a&&(d.tags?o.a.AddTagsTo(v,d.tags):o.a.AddTagsTo(v,e.tags)),v.position=h.Vector3.FromArray(d.position),d.parentId&&(v._waitingParentId=d.parentId),d.rotationQuaternion?v.rotationQuaternion=h.Quaternion.FromArray(d.rotationQuaternion):d.rotation&&(v.rotation=h.Vector3.FromArray(d.rotation)),v.scaling=h.Vector3.FromArray(d.scaling),null!=d.checkCollisions&&null!=d.checkCollisions&&(v.checkCollisions=d.checkCollisions),null!=d.pickable&&null!=d.pickable&&(v.isPickable=d.pickable),null!=d.showBoundingBox&&null!=d.showBoundingBox&&(v.showBoundingBox=d.showBoundingBox),null!=d.showSubMeshesBoundingBox&&null!=d.showSubMeshesBoundingBox&&(v.showSubMeshesBoundingBox=d.showSubMeshesBoundingBox),null!=d.alphaIndex&&null!=d.showSubMeshesBoundingBox&&(v.alphaIndex=d.alphaIndex),d.physicsImpostor&&(v.physicsImpostor=new x.a(v,d.physicsImpostor,{mass:d.physicsMass,friction:d.physicsFriction,restitution:d.physicsRestitution},i)),d.animations){for(s=0;s<d.animations.length;s++)a=d.animations[s],v.animations.push(_.a.Parse(a));u.a.ParseAnimationRanges(v,d,i),d.autoAnimate&&i.beginAnimation(v,d.autoAnimateFrom,d.autoAnimateTo,d.autoAnimateLoop,d.autoAnimateSpeed||1)}}return n},t.CreateRibbon=function(e,t,i,r,n,s,a,o,h){throw"Import MeshBuilder before creating meshes."},t.CreateDisc=function(e,t,i,r,n,s){throw void 0===r&&(r=null),"Import MeshBuilder before creating meshes."},t.CreateBox=function(e,t,i,r,n){throw void 0===i&&(i=null),"Import MeshBuilder before creating meshes."},t.CreateSphere=function(e,t,i,r,n,s){throw"Import MeshBuilder before creating meshes."},t.CreateCylinder=function(e,t,i,r,n,s,a,o,h){throw"Import MeshBuilder before creating meshes."},t.CreateTorus=function(e,t,i,r,n,s,a){throw"Import MeshBuilder before creating meshes."},t.CreateTorusKnot=function(e,t,i,r,n,s,a,o,h,u){throw"Import MeshBuilder before creating meshes."},t.CreateLines=function(e,t,i,r,n){throw void 0===i&&(i=null),void 0===r&&(r=!1),void 0===n&&(n=null),"Import MeshBuilder before creating meshes."},t.CreateDashedLines=function(e,t,i,r,n,s,a,o){throw void 0===s&&(s=null),"Import MeshBuilder before creating meshes."},t.CreatePolygon=function(e,t,i,r,n,s){throw"Import MeshBuilder before creating meshes."},t.ExtrudePolygon=function(e,t,i,r,n,s,a){throw"Import MeshBuilder before creating meshes."},t.ExtrudeShape=function(e,t,i,r,n,s,a,o,h,u){throw void 0===a&&(a=null),"Import MeshBuilder before creating meshes."},t.ExtrudeShapeCustom=function(e,t,i,r,n,s,a,o,h,u,c,l){throw"Import MeshBuilder before creating meshes."},t.CreateLathe=function(e,t,i,r,n,s,a){throw"Import MeshBuilder before creating meshes."},t.CreatePlane=function(e,t,i,r,n){throw"Import MeshBuilder before creating meshes."},t.CreateGround=function(e,t,i,r,n,s){throw"Import MeshBuilder before creating meshes."},t.CreateTiledGround=function(e,t,i,r,n,s,a,o,h){throw"Import MeshBuilder before creating meshes."},t.CreateGroundFromHeightMap=function(e,t,i,r,n,s,a,o,h,u,c){throw"Import MeshBuilder before creating meshes."},t.CreateTube=function(e,t,i,r,n,s,a,o,h,u){throw"Import MeshBuilder before creating meshes."},t.CreatePolyhedron=function(e,t,i){throw"Import MeshBuilder before creating meshes."},t.CreateIcoSphere=function(e,t,i){throw"Import MeshBuilder before creating meshes."},t.CreateDecal=function(e,t,i,r,n,s){throw"Import MeshBuilder before creating meshes."},t.prototype.setPositionsForCPUSkinning=function(){if(!this._sourcePositions){var e=this.getVerticesData(c.b.PositionKind);if(!e)return this._sourcePositions;this._sourcePositions=new Float32Array(e),this.isVertexBufferUpdatable(c.b.PositionKind)||this.setVerticesData(c.b.PositionKind,e,!0)}return this._sourcePositions},t.prototype.setNormalsForCPUSkinning=function(){if(!this._sourceNormals){var e=this.getVerticesData(c.b.NormalKind);if(!e)return this._sourceNormals;this._sourceNormals=new Float32Array(e),this.isVertexBufferUpdatable(c.b.NormalKind)||this.setVerticesData(c.b.NormalKind,e,!0)}return this._sourceNormals},t.prototype.applySkeleton=function(e){if(!this.geometry)return this;if(this.geometry._softwareSkinningFrameId==this.getScene().getFrameId())return this;if(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),!this.isVerticesDataPresent(c.b.PositionKind))return this;if(!this.isVerticesDataPresent(c.b.NormalKind))return this;if(!this.isVerticesDataPresent(c.b.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(c.b.MatricesWeightsKind))return this;if(!this._sourcePositions){var t=this.subMeshes.slice();this.setPositionsForCPUSkinning(),this.subMeshes=t}this._sourceNormals||this.setNormalsForCPUSkinning();var i=this.getVerticesData(c.b.PositionKind);if(!i)return this;i instanceof Float32Array||(i=new Float32Array(i));var r=this.getVerticesData(c.b.NormalKind);if(!r)return this;r instanceof Float32Array||(r=new Float32Array(r));var n=this.getVerticesData(c.b.MatricesIndicesKind),s=this.getVerticesData(c.b.MatricesWeightsKind);if(!s||!n)return this;for(var a,o=this.numBoneInfluencers>4,u=o?this.getVerticesData(c.b.MatricesIndicesExtraKind):null,l=o?this.getVerticesData(c.b.MatricesWeightsExtraKind):null,d=e.getTransformMatrices(this),f=h.Vector3.Zero(),p=new h.Matrix,g=new h.Matrix,m=0,v=0;v<i.length;v+=3,m+=4){var y;for(a=0;a<4;a++)(y=s[m+a])>0&&(h.Matrix.FromFloat32ArrayToRefScaled(d,Math.floor(16*n[m+a]),y,g),p.addToSelf(g));if(o)for(a=0;a<4;a++)(y=l[m+a])>0&&(h.Matrix.FromFloat32ArrayToRefScaled(d,Math.floor(16*u[m+a]),y,g),p.addToSelf(g));h.Vector3.TransformCoordinatesFromFloatsToRef(this._sourcePositions[v],this._sourcePositions[v+1],this._sourcePositions[v+2],p,f),f.toArray(i,v),h.Vector3.TransformNormalFromFloatsToRef(this._sourceNormals[v],this._sourceNormals[v+1],this._sourceNormals[v+2],p,f),f.toArray(r,v),p.reset()}return this.updateVerticesData(c.b.PositionKind,i),this.updateVerticesData(c.b.NormalKind,r),this},t.MinMax=function(e){var t=null,i=null;return e.forEach(function(e){var r=e.getBoundingInfo().boundingBox;t&&i?(t.minimizeInPlace(r.minimumWorld),i.maximizeInPlace(r.maximumWorld)):(t=r.minimumWorld,i=r.maximumWorld)}),t&&i?{min:t,max:i}:{min:h.Vector3.Zero(),max:h.Vector3.Zero()}},t.Center=function(e){var i=e instanceof Array?t.MinMax(e):e;return h.Vector3.Center(i.min,i.max)},t.MergeMeshes=function(e,i,r,n,s){var a;if(void 0===i&&(i=!0),!r){var o=0;for(a=0;a<e.length;a++)if(e[a]&&(o+=e[a].getTotalVertices())>65536)return D.a.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}var h,u=null,c=new Array,f=null;for(a=0;a<e.length;a++)if(e[a]){var p=e[a].computeWorldMatrix(!0);(h=l.a.ExtractFromMesh(e[a],!0,!0)).transform(p),u?u.merge(h,r):(u=h,f=e[a]),s&&c.push(e[a].getTotalIndices())}if(f=f,n||(n=new t(f.name+"_merged",f.getScene())),u.applyToMesh(n),n.material=f.material,n.checkCollisions=f.checkCollisions,i)for(a=0;a<e.length;a++)e[a]&&e[a].dispose();if(s){n.releaseSubMeshes(),a=0;for(var g=0;a<c.length;)d.b.CreateFromIndices(0,g,c[a],n),g+=c[a],a++}return n},t.prototype.addInstance=function(e){e._indexInSourceMeshInstanceArray=this.instances.length,this.instances.push(e)},t.prototype.removeInstance=function(e){var t=e._indexInSourceMeshInstanceArray;if(-1!=t){if(t!==this.instances.length-1){var i=this.instances[this.instances.length-1];this.instances[t]=i,i._indexInSourceMeshInstanceArray=t}e._indexInSourceMeshInstanceArray=-1,this.instances.pop()}},t.FRONTSIDE=l.a.FRONTSIDE,t.BACKSIDE=l.a.BACKSIDE,t.DOUBLESIDE=l.a.DOUBLESIDE,t.DEFAULTSIDE=l.a.DEFAULTSIDE,t.NO_CAP=0,t.CAP_START=1,t.CAP_END=2,t.CAP_ALL=3,t._instancedMeshFactory=function(e,t){throw"Import InstancedMesh before creating instances."},t._GroundMeshParser=function(e,t){throw"Import GroundMesh before trying to parse it."},t}(y.a)},83:function(e,t,i){"use strict";i.r(t);var r=i(7),n=i(34),s=i(0),a=i(8),o=i(2),h=i(1),u=i(9),c=i(33),l=i(37);a.a._instancedMeshFactory=function(e,t){return new d(e,t)};var d=function(e){function t(t,i){var r=e.call(this,t,i.getScene())||this;return r._indexInSourceMeshInstanceArray=-1,i.addInstance(r),r._sourceMesh=i,r.position.copyFrom(i.position),r.rotation.copyFrom(i.rotation),r.scaling.copyFrom(i.scaling),i.rotationQuaternion&&(r.rotationQuaternion=i.rotationQuaternion.clone()),r.infiniteDistance=i.infiniteDistance,r.setPivotMatrix(i.getPivotMatrix()),r.refreshBoundingInfo(),r._syncSubMeshes(),r}return h.c(t,e),t.prototype.getClassName=function(){return"InstancedMesh"},Object.defineProperty(t.prototype,"receiveShadows",{get:function(){return this._sourceMesh.receiveShadows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this._sourceMesh.material},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visibility",{get:function(){return this._sourceMesh.visibility},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skeleton",{get:function(){return this._sourceMesh.skeleton},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingGroupId",{get:function(){return this._sourceMesh.renderingGroupId},set:function(e){this._sourceMesh&&e!==this._sourceMesh.renderingGroupId&&u.a.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")},enumerable:!0,configurable:!0}),t.prototype.getTotalVertices=function(){return this._sourceMesh.getTotalVertices()},t.prototype.getTotalIndices=function(){return this._sourceMesh.getTotalIndices()},Object.defineProperty(t.prototype,"sourceMesh",{get:function(){return this._sourceMesh},enumerable:!0,configurable:!0}),t.prototype.isReady=function(e){return void 0===e&&(e=!1),this._sourceMesh.isReady(e,!0)},t.prototype.getVerticesData=function(e,t){return this._sourceMesh.getVerticesData(e,t)},t.prototype.setVerticesData=function(e,t,i,r){return this.sourceMesh&&this.sourceMesh.setVerticesData(e,t,i,r),this.sourceMesh},t.prototype.updateVerticesData=function(e,t,i,r){return this.sourceMesh&&this.sourceMesh.updateVerticesData(e,t,i,r),this.sourceMesh},t.prototype.setIndices=function(e,t){return void 0===t&&(t=null),this.sourceMesh&&this.sourceMesh.setIndices(e,t),this.sourceMesh},t.prototype.isVerticesDataPresent=function(e){return this._sourceMesh.isVerticesDataPresent(e)},t.prototype.getIndices=function(){return this._sourceMesh.getIndices()},Object.defineProperty(t.prototype,"_positions",{get:function(){return this._sourceMesh._positions},enumerable:!0,configurable:!0}),t.prototype.refreshBoundingInfo=function(e){if(void 0===e&&(e=!1),this._boundingInfo&&this._boundingInfo.isLocked)return this;var t=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(e),t),this},t.prototype._preActivate=function(){return this._currentLOD&&this._currentLOD._preActivate(),this},t.prototype._activate=function(e){return this._currentLOD&&this._currentLOD._registerInstanceForRenderId(this,e),this},t.prototype.getLOD=function(e){if(!e)return this;var t=this.getBoundingInfo();return this._currentLOD=this.sourceMesh.getLOD(e,t.boundingSphere),this._currentLOD===this.sourceMesh?this:this._currentLOD},t.prototype._syncSubMeshes=function(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(var e=0;e<this._sourceMesh.subMeshes.length;e++)this._sourceMesh.subMeshes[e].clone(this,this._sourceMesh);return this},t.prototype._generatePointsArray=function(){return this._sourceMesh._generatePointsArray()},t.prototype.clone=function(e,t,i){var r=this._sourceMesh.createInstance(e);if(l.a.DeepCopy(this,r,["name","subMeshes","uniqueId"],[]),this.refreshBoundingInfo(),t&&(r.parent=t),!i)for(var n=0;n<this.getScene().meshes.length;n++){var s=this.getScene().meshes[n];s.parent===this&&s.clone(s.name,r)}return r.computeWorldMatrix(!0),r},t.prototype.dispose=function(t,i){void 0===i&&(i=!1),this._sourceMesh.removeInstance(this),e.prototype.dispose.call(this,t,i)},t}(c.a),f=i(15),p=i(73),g=(i(78),i(79),function(e){function t(t,i,r,n,a,h,u){void 0===i&&(i=null),void 0===r&&(r=null);var c=e.call(this,t,i,r,n,a)||this;c.useVertexColor=h,c.useVertexAlpha=u,c.color=new s.Color3(1,1,1),c.alpha=1,n&&(c.color=n.color.clone(),c.alpha=n.alpha,c.useVertexColor=n.useVertexColor,c.useVertexAlpha=n.useVertexAlpha),c.intersectionThreshold=.1;var l={attributes:[o.b.PositionKind,"world0","world1","world2","world3"],uniforms:["world","viewProjection"],needAlphaBlending:!0,defines:[]};return!1===u&&(l.needAlphaBlending=!1),h?(l.defines.push("#define VERTEXCOLOR"),l.attributes.push(o.b.ColorKind)):l.uniforms.push("color"),c._colorShader=new p.a("colorShader",c.getScene(),"color",l),c}return h.c(t,e),t.prototype.getClassName=function(){return"LinesMesh"},Object.defineProperty(t.prototype,"material",{get:function(){return this._colorShader},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkCollisions",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype._bind=function(e,t,i){return this._geometry?(this._geometry._bind(this._colorShader.getEffect()),this.useVertexColor||this._colorShader.setColor4("color",this.color.toColor4(this.alpha)),this):this},t.prototype._draw=function(e,t,i){return this._geometry&&this._geometry.getVertexBuffers()&&(this._unIndexed||this._geometry.getIndexBuffer())?(this.getScene().getEngine().drawElementsType(f.a.LineListDrawMode,e.indexStart,e.indexCount,i),this):this},t.prototype.dispose=function(t){this._colorShader.dispose(!1,!1,!0),e.prototype.dispose.call(this,t)},t.prototype.clone=function(e,i,r){return new t(e,this.getScene(),i,this,r)},t.prototype.createInstance=function(e){return new m(e,this)},t}(a.a)),m=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.intersectionThreshold=i.intersectionThreshold,r}return h.c(t,e),t.prototype.getClassName=function(){return"InstancedLinesMesh"},t}(d),v=i(11);a.a._GroundMeshParser=function(e,t){return y.Parse(e,t)};var y=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.generateOctree=!1,r}return h.c(t,e),t.prototype.getClassName=function(){return"GroundMesh"},Object.defineProperty(t.prototype,"subdivisions",{get:function(){return Math.min(this._subdivisionsX,this._subdivisionsY)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subdivisionsX",{get:function(){return this._subdivisionsX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subdivisionsY",{get:function(){return this._subdivisionsY},enumerable:!0,configurable:!0}),t.prototype.optimize=function(e,t){void 0===t&&(t=32),this._subdivisionsX=e,this._subdivisionsY=e,this.subdivide(e);this.createOrUpdateSubmeshesOctree&&this.createOrUpdateSubmeshesOctree(t)},t.prototype.getHeightAtCoordinates=function(e,t){var i=this.getWorldMatrix(),r=s.Tmp.Matrix[5];i.invertToRef(r);var n=s.Tmp.Vector3[8];if(s.Vector3.TransformCoordinatesFromFloatsToRef(e,0,t,r,n),e=n.x,t=n.z,e<this._minX||e>this._maxX||t<this._minZ||t>this._maxZ)return this.position.y;this._heightQuads&&0!=this._heightQuads.length||(this._initHeightQuads(),this._computeHeightQuads());var a=this._getFacetAt(e,t),o=-(a.x*e+a.z*t+a.w)/a.y;return s.Vector3.TransformCoordinatesFromFloatsToRef(0,o,0,i,n),n.y},t.prototype.getNormalAtCoordinates=function(e,t){var i=new s.Vector3(0,1,0);return this.getNormalAtCoordinatesToRef(e,t,i),i},t.prototype.getNormalAtCoordinatesToRef=function(e,t,i){var r=this.getWorldMatrix(),n=s.Tmp.Matrix[5];r.invertToRef(n);var a=s.Tmp.Vector3[8];if(s.Vector3.TransformCoordinatesFromFloatsToRef(e,0,t,n,a),e=a.x,t=a.z,e<this._minX||e>this._maxX||t<this._minZ||t>this._maxZ)return this;this._heightQuads&&0!=this._heightQuads.length||(this._initHeightQuads(),this._computeHeightQuads());var o=this._getFacetAt(e,t);return s.Vector3.TransformNormalFromFloatsToRef(o.x,o.y,o.z,r,i),this},t.prototype.updateCoordinateHeights=function(){return this._heightQuads&&0!=this._heightQuads.length||this._initHeightQuads(),this._computeHeightQuads(),this},t.prototype._getFacetAt=function(e,t){var i=Math.floor((e+this._maxX)*this._subdivisionsX/this._width),r=Math.floor(-(t+this._maxZ)*this._subdivisionsY/this._height+this._subdivisionsY),n=this._heightQuads[r*this._subdivisionsX+i];return t<n.slope.x*e+n.slope.y?n.facet1:n.facet2},t.prototype._initHeightQuads=function(){var e=this._subdivisionsX,t=this._subdivisionsY;this._heightQuads=new Array;for(var i=0;i<t;i++)for(var r=0;r<e;r++){var n={slope:s.Vector2.Zero(),facet1:new s.Vector4(0,0,0,0),facet2:new s.Vector4(0,0,0,0)};this._heightQuads[i*e+r]=n}return this},t.prototype._computeHeightQuads=function(){var e=this.getVerticesData(o.b.PositionKind);if(!e)return this;for(var t=s.Tmp.Vector3[3],i=s.Tmp.Vector3[2],r=s.Tmp.Vector3[1],n=s.Tmp.Vector3[0],a=s.Tmp.Vector3[4],h=s.Tmp.Vector3[5],u=s.Tmp.Vector3[6],c=s.Tmp.Vector3[7],l=s.Tmp.Vector3[8],d=0,f=0,p=0,g=0,m=0,v=0,y=0,b=this._subdivisionsX,_=this._subdivisionsY,x=0;x<_;x++)for(var M=0;M<b;M++){d=3*M,f=x*(b+1)*3,p=(x+1)*(b+1)*3,t.x=e[f+d],t.y=e[f+d+1],t.z=e[f+d+2],i.x=e[f+d+3],i.y=e[f+d+4],i.z=e[f+d+5],r.x=e[p+d],r.y=e[p+d+1],r.z=e[p+d+2],n.x=e[p+d+3],n.y=e[p+d+4],n.z=e[p+d+5],g=(n.z-t.z)/(n.x-t.x),m=t.z-g*t.x,i.subtractToRef(t,a),r.subtractToRef(t,h),n.subtractToRef(t,u),s.Vector3.CrossToRef(u,h,c),s.Vector3.CrossToRef(a,u,l),c.normalize(),l.normalize(),v=-(c.x*t.x+c.y*t.y+c.z*t.z),y=-(l.x*i.x+l.y*i.y+l.z*i.z);var D=this._heightQuads[x*b+M];D.slope.copyFromFloats(g,m),D.facet1.copyFromFloats(c.x,c.y,c.z,v),D.facet2.copyFromFloats(l.x,l.y,l.z,y)}return this},t.prototype.serialize=function(t){e.prototype.serialize.call(this,t),t.subdivisionsX=this._subdivisionsX,t.subdivisionsY=this._subdivisionsY,t.minX=this._minX,t.maxX=this._maxX,t.minZ=this._minZ,t.maxZ=this._maxZ,t.width=this._width,t.height=this._height},t.Parse=function(e,i){var r=new t(e.name,i);return r._subdivisionsX=e.subdivisionsX||1,r._subdivisionsY=e.subdivisionsY||1,r._minX=e.minX,r._maxX=e.maxX,r._minZ=e.minZ,r._maxZ=e.maxZ,r._width=e.width,r._height=e.height,r},t}(a.a),b=function(e){function t(t,i){var r=e.call(this,t.x,t.y)||this;return r.index=i,r}return h.c(t,e),t}(s.Vector2),_=function(){function e(){this.elements=new Array}return e.prototype.add=function(e){var t=this,i=new Array;return e.forEach(function(e){if(0===i.length||!e.equalsWithEpsilon(i[0])){var r=new b(e,t.elements.length);i.push(r),t.elements.push(r)}}),i},e.prototype.computeBounds=function(){var e=new s.Vector2(this.elements[0].x,this.elements[0].y),t=new s.Vector2(this.elements[0].x,this.elements[0].y);return this.elements.forEach(function(i){i.x<e.x?e.x=i.x:i.x>t.x&&(t.x=i.x),i.y<e.y?e.y=i.y:i.y>t.y&&(t.y=i.y)}),{min:e,max:t,width:t.x-e.x,height:t.y-e.y}},e}(),x=(function(){function e(){}e.Rectangle=function(e,t,i,r){return[new s.Vector2(e,t),new s.Vector2(i,t),new s.Vector2(i,r),new s.Vector2(e,r)]},e.Circle=function(e,t,i,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=32);for(var n=new Array,a=0,o=2*Math.PI/r,h=0;h<r;h++)n.push(new s.Vector2(t+Math.cos(a)*e,i+Math.sin(a)*e)),a-=o;return n},e.Parse=function(e){var t,i=e.split(/[^-+eE\.\d]+/).map(parseFloat).filter(function(e){return!isNaN(e)}),r=[];for(t=0;t<(2147483646&i.length);t+=2)r.push(new s.Vector2(i[t],i[t+1]));return r},e.StartingAt=function(e,t){return s.Path2.StartingAt(e,t)}}(),function(){function e(e,t,i,r){var n;void 0===r&&(r=earcut),this._points=new _,this._outlinepoints=new _,this._holes=new Array,this._epoints=new Array,this._eholes=new Array,this.bjsEarcut=r,this._name=e,this._scene=i,n=t instanceof s.Path2?t.getPoints():t,this._addToepoint(n),this._points.add(n),this._outlinepoints.add(n),void 0===this.bjsEarcut&&u.a.Warn("Earcut was not found, the polygon will not be built.")}return e.prototype._addToepoint=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._epoints.push(r.x,r.y)}},e.prototype.addHole=function(e){this._points.add(e);var t=new _;return t.add(e),this._holes.push(t),this._eholes.push(this._epoints.length/2),this._addToepoint(e),this},e.prototype.build=function(e,t){var i=this;void 0===e&&(e=!1),void 0===t&&(t=0);var r=new a.a(this._name,this._scene),n=new Array,s=new Array,h=new Array,u=this._points.computeBounds();this._points.elements.forEach(function(e){n.push(0,1,0),s.push(e.x,0,e.y),h.push((e.x-u.min.x)/u.width,(e.y-u.min.y)/u.height)});for(var c=new Array,l=this.bjsEarcut(this._epoints,this._eholes,2),d=0;d<l.length;d++)c.push(l[d]);if(t>0){var f=s.length/3;this._points.elements.forEach(function(e){n.push(0,-1,0),s.push(e.x,-t,e.y),h.push(1-(e.x-u.min.x)/u.width,1-(e.y-u.min.y)/u.height)});var p=c.length;for(d=0;d<p;d+=3){var g=c[d+0],m=c[d+1],v=c[d+2];c.push(v+f),c.push(m+f),c.push(g+f)}this.addSide(s,n,h,c,u,this._outlinepoints,t,!1),this._holes.forEach(function(e){i.addSide(s,n,h,c,u,e,t,!0)})}return r.setVerticesData(o.b.PositionKind,s,e),r.setVerticesData(o.b.NormalKind,n,e),r.setVerticesData(o.b.UVKind,h,e),r.setIndices(c),r},e.prototype.addSide=function(e,t,i,r,n,a,o,h){for(var u=e.length/3,c=0,l=0;l<a.elements.length;l++){var d,f=a.elements[l];d=l+1>a.elements.length-1?a.elements[0]:a.elements[l+1],e.push(f.x,0,f.y),e.push(f.x,-o,f.y),e.push(d.x,0,d.y),e.push(d.x,-o,d.y);var p=new s.Vector3(f.x,0,f.y),g=new s.Vector3(d.x,0,d.y).subtract(p),m=new s.Vector3(0,1,0),v=s.Vector3.Cross(g,m);v=v.normalize(),i.push(c/n.width,0),i.push(c/n.width,1),c+=g.length(),i.push(c/n.width,0),i.push(c/n.width,1),h?(t.push(v.x,v.y,v.z),t.push(v.x,v.y,v.z),t.push(v.x,v.y,v.z),t.push(v.x,v.y,v.z),r.push(u),r.push(u+2),r.push(u+1),r.push(u+1),r.push(u+2),r.push(u+3)):(t.push(-v.x,-v.y,-v.z),t.push(-v.x,-v.y,-v.z),t.push(-v.x,-v.y,-v.z),t.push(-v.x,-v.y,-v.z),r.push(u),r.push(u+1),r.push(u+2),r.push(u+1),r.push(u+3),r.push(u+2)),u+=4}},e}()),M=i(28);i.d(t,"MeshBuilder",function(){return D}),a.a.CreateRibbon=function(e,t,i,r,n,s,a,o,h){return void 0===i&&(i=!1),void 0===a&&(a=!1),D.CreateRibbon(e,{pathArray:t,closeArray:i,closePath:r,offset:n,updatable:a,sideOrientation:o,instance:h},s)},a.a.CreateDisc=function(e,t,i,r,n,s){void 0===r&&(r=null);var a={radius:t,tessellation:i,sideOrientation:s,updatable:n};return D.CreateDisc(e,a,r)},a.a.CreateBox=function(e,t,i,r,n){void 0===i&&(i=null);var s={size:t,sideOrientation:n,updatable:r};return D.CreateBox(e,s,i)},a.a.CreateSphere=function(e,t,i,r,n,s){var a={segments:t,diameterX:i,diameterY:i,diameterZ:i,sideOrientation:s,updatable:n};return D.CreateSphere(e,a,r)},a.a.CreateCylinder=function(e,t,i,r,s,o,h,u,c){void 0!==h&&h instanceof n.Scene||(void 0!==h&&(c=u||a.a.DEFAULTSIDE,u=h),h=o,o=1);var l={height:t,diameterTop:i,diameterBottom:r,tessellation:s,subdivisions:o,sideOrientation:c,updatable:u};return D.CreateCylinder(e,l,h)},a.a.CreateTorus=function(e,t,i,r,n,s,a){var o={diameter:t,thickness:i,tessellation:r,sideOrientation:a,updatable:s};return D.CreateTorus(e,o,n)},a.a.CreateTorusKnot=function(e,t,i,r,n,s,a,o,h,u){var c={radius:t,tube:i,radialSegments:r,tubularSegments:n,p:s,q:a,sideOrientation:u,updatable:h};return D.CreateTorusKnot(e,c,o)},a.a.CreateLines=function(e,t,i,r,n){void 0===i&&(i=null),void 0===r&&(r=!1),void 0===n&&(n=null);var s={points:t,updatable:r,instance:n};return D.CreateLines(e,s,i)},a.a.CreateDashedLines=function(e,t,i,r,n,s,a,o){void 0===s&&(s=null);var h={points:t,dashSize:i,gapSize:r,dashNb:n,updatable:a,instance:o};return D.CreateDashedLines(e,h,s)},a.a.CreatePolygon=function(e,t,i,r,n,s){var a={shape:t,holes:r,updatable:n,sideOrientation:s};return D.CreatePolygon(e,a,i)},a.a.ExtrudePolygon=function(e,t,i,r,n,s,a){var o={shape:t,holes:n,depth:i,updatable:s,sideOrientation:a};return D.ExtrudePolygon(e,o,r)},a.a.ExtrudeShape=function(e,t,i,r,n,s,o,h,u,c){void 0===o&&(o=null);var l={shape:t,path:i,scale:r,rotation:n,cap:0===s?0:s||a.a.NO_CAP,sideOrientation:u,instance:c,updatable:h};return D.ExtrudeShape(e,l,o)},a.a.ExtrudeShapeCustom=function(e,t,i,r,n,s,o,h,u,c,l,d){var f={shape:t,path:i,scaleFunction:r,rotationFunction:n,ribbonCloseArray:s,ribbonClosePath:o,cap:0===h?0:h||a.a.NO_CAP,sideOrientation:l,instance:d,updatable:c};return D.ExtrudeShapeCustom(e,f,u)},a.a.CreateLathe=function(e,t,i,r,n,s,a){var o={shape:t,radius:i,tessellation:r,sideOrientation:a,updatable:s};return D.CreateLathe(e,o,n)},a.a.CreatePlane=function(e,t,i,r,n){var s={size:t,width:t,height:t,sideOrientation:n,updatable:r};return D.CreatePlane(e,s,i)},a.a.CreateGround=function(e,t,i,r,n,s){var a={width:t,height:i,subdivisions:r,updatable:s};return D.CreateGround(e,a,n)},a.a.CreateTiledGround=function(e,t,i,r,n,s,a,o,h){var u={xmin:t,zmin:i,xmax:r,zmax:n,subdivisions:s,precision:a,updatable:h};return D.CreateTiledGround(e,u,o)},a.a.CreateGroundFromHeightMap=function(e,t,i,r,n,s,a,o,h,u,c){var l={width:i,height:r,subdivisions:n,minHeight:s,maxHeight:a,updatable:h,onReady:u,alphaFilter:c};return D.CreateGroundFromHeightMap(e,t,l,o)},a.a.CreateTube=function(e,t,i,r,n,s,a,o,h,u){var c={path:t,radius:i,tessellation:r,radiusFunction:n,arc:1,cap:s,updatable:o,sideOrientation:h,instance:u};return D.CreateTube(e,c,a)},a.a.CreatePolyhedron=function(e,t,i){return D.CreatePolyhedron(e,t,i)},a.a.CreateIcoSphere=function(e,t,i){return D.CreateIcoSphere(e,t,i)},a.a.CreateDecal=function(e,t,i,r,n,s){var a={position:i,normal:r,size:n,angle:s};return D.CreateDecal(e,t,a)};var D=function(){function e(){}return e._UpdateSideOrientation=function(e){return e==a.a.DOUBLESIDE?a.a.DOUBLESIDE:null==e?a.a.FRONTSIDE:e},e.CreateBox=function(t,i,r){void 0===r&&(r=null);var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateBox(i).applyToMesh(n,i.updatable),n},e.CreateSphere=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateSphere(i).applyToMesh(n,i.updatable),n},e.CreateDisc=function(t,i,r){void 0===r&&(r=null);var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateDisc(i).applyToMesh(n,i.updatable),n},e.CreateIcoSphere=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateIcoSphere(i).applyToMesh(n,i.updatable),n},e.CreateRibbon=function(t,i,r){void 0===r&&(r=null);var n=i.pathArray,h=i.closeArray,u=i.closePath,c=e._UpdateSideOrientation(i.sideOrientation),l=i.instance,d=i.updatable;if(l){var f=s.Tmp.Vector3[0].setAll(Number.MAX_VALUE),p=s.Tmp.Vector3[1].setAll(-Number.MAX_VALUE),g=l.getVerticesData(o.b.PositionKind);if(function(e){for(var t=n[0].length,i=l,r=0,s=i._originalBuilderSideOrientation===a.a.DOUBLESIDE?2:1,o=1;o<=s;++o)for(var h=0;h<n.length;++h){var u=n[h],c=u.length;t=t<c?t:c;for(var d=0;d<t;++d){var g=u[d];e[r]=g.x,e[r+1]=g.y,e[r+2]=g.z,f.minimizeInPlaceFromFloats(g.x,g.y,g.z),p.maximizeInPlaceFromFloats(g.x,g.y,g.z),r+=3}i._creationDataStorage&&i._creationDataStorage.closePath&&(g=u[0],e[r]=g.x,e[r+1]=g.y,e[r+2]=g.z,r+=3)}}(g),l._boundingInfo?l._boundingInfo.reConstruct(f,p,l._worldMatrix):l._boundingInfo=new M.a(f,p,l._worldMatrix),l.updateVerticesData(o.b.PositionKind,g,!1,!1),i.colors){for(var m=l.getVerticesData(o.b.ColorKind),y=0,b=0;y<i.colors.length;y++,b+=4){var _=i.colors[y];m[b]=_.r,m[b+1]=_.g,m[b+2]=_.b,m[b+3]=_.a}l.updateVerticesData(o.b.ColorKind,m,!1,!1)}if(i.uvs){for(var x=l.getVerticesData(o.b.UVKind),D=0;D<i.uvs.length;D++)x[2*D]=i.uvs[D].x,x[2*D+1]=i.uvs[D].y;l.updateVerticesData(o.b.UVKind,x,!1,!1)}if(!l.areNormalsFrozen||l.isFacetDataEnabled){var V=l.getIndices(),I=l.getVerticesData(o.b.NormalKind),A=l.isFacetDataEnabled?l.getFacetDataParameters():null;if(v.a.ComputeNormals(g,V,I,A),l._creationDataStorage&&l._creationDataStorage.closePath)for(var w=0,T=0,S=0;S<n.length;S++)w=3*l._creationDataStorage.idx[S],T=S+1<n.length?3*(l._creationDataStorage.idx[S+1]-1):I.length-3,I[w]=.5*(I[w]+I[T]),I[w+1]=.5*(I[w+1]+I[T+1]),I[w+2]=.5*(I[w+2]+I[T+2]),I[T]=I[w],I[T+1]=I[w+1],I[T+2]=I[w+2];l.areNormalsFrozen||l.updateVerticesData(o.b.NormalKind,I,!1,!1)}return l}var O=new a.a(t,r);O._originalBuilderSideOrientation=c,O._creationDataStorage=new a.b;var P=v.a.CreateRibbon(i);return u&&(O._creationDataStorage.idx=P._idx),O._creationDataStorage.closePath=u,O._creationDataStorage.closeArray=h,P.applyToMesh(O,d),O},e.CreateCylinder=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateCylinder(i).applyToMesh(n,i.updatable),n},e.CreateTorus=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateTorus(i).applyToMesh(n,i.updatable),n},e.CreateTorusKnot=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreateTorusKnot(i).applyToMesh(n,i.updatable),n},e.CreateLineSystem=function(e,t,i){var r=t.instance,n=t.lines,s=t.colors;if(r){var a,h,u=r.getVerticesData(o.b.PositionKind);s&&(a=r.getVerticesData(o.b.ColorKind));for(var c=0,l=0,d=0;d<n.length;d++)for(var f=n[d],p=0;p<f.length;p++)u[c]=f[p].x,u[c+1]=f[p].y,u[c+2]=f[p].z,s&&a&&(h=s[d],a[l]=h[p].r,a[l+1]=h[p].g,a[l+2]=h[p].b,a[l+3]=h[p].a,l+=4),c+=3;return r.updateVerticesData(o.b.PositionKind,u,!1,!1),s&&a&&r.updateVerticesData(o.b.ColorKind,a,!1,!1),r}var m=new g(e,i,null,void 0,void 0,!!s,t.useVertexAlpha);return v.a.CreateLineSystem(t).applyToMesh(m,t.updatable),m},e.CreateLines=function(t,i,r){void 0===r&&(r=null);var n=i.colors?[i.colors]:null;return e.CreateLineSystem(t,{lines:[i.points],updatable:i.updatable,instance:i.instance,colors:n,useVertexAlpha:i.useVertexAlpha},r)},e.CreateDashedLines=function(e,t,i){void 0===i&&(i=null);var r=t.points,n=t.instance,o=t.gapSize||1,h=t.dashSize||3;if(n){return n.updateMeshPositions(function(e){var t,i,a=s.Vector3.Zero(),o=e.length/6,h=0,u=0,c=0,l=0,d=0,f=0;for(d=0;d<r.length-1;d++)r[d+1].subtractToRef(r[d],a),h+=a.length();t=h/o;var p=n._creationDataStorage.dashSize;for(i=p*t/(p+n._creationDataStorage.gapSize),d=0;d<r.length-1;d++)for(r[d+1].subtractToRef(r[d],a),u=Math.floor(a.length()/t),a.normalize(),f=0;f<u&&l<e.length;)c=t*f,e[l]=r[d].x+c*a.x,e[l+1]=r[d].y+c*a.y,e[l+2]=r[d].z+c*a.z,e[l+3]=r[d].x+(c+i)*a.x,e[l+4]=r[d].y+(c+i)*a.y,e[l+5]=r[d].z+(c+i)*a.z,l+=6,f++;for(;l<e.length;)e[l]=r[d].x,e[l+1]=r[d].y,e[l+2]=r[d].z,l+=3},!1),n}var u=new g(e,i);return v.a.CreateDashedLines(t).applyToMesh(u,t.updatable),u._creationDataStorage=new a.b,u._creationDataStorage.dashSize=h,u._creationDataStorage.gapSize=o,u},e.ExtrudeShape=function(t,i,r){void 0===r&&(r=null);var n=i.path,s=i.shape,o=i.scale||1,h=i.rotation||0,u=0===i.cap?0:i.cap||a.a.NO_CAP,c=i.updatable,l=e._UpdateSideOrientation(i.sideOrientation),d=i.instance||null,f=i.invertUV||!1;return e._ExtrudeShapeGeneric(t,s,n,o,h,null,null,!1,!1,u,!1,r,!!c,l,d,f,i.frontUVs||null,i.backUVs||null)},e.ExtrudeShapeCustom=function(t,i,r){var n=i.path,s=i.shape,o=i.scaleFunction||function(){return 1},h=i.rotationFunction||function(){return 0},u=i.ribbonCloseArray||!1,c=i.ribbonClosePath||!1,l=0===i.cap?0:i.cap||a.a.NO_CAP,d=i.updatable,f=e._UpdateSideOrientation(i.sideOrientation),p=i.instance,g=i.invertUV||!1;return e._ExtrudeShapeGeneric(t,s,n,null,null,o,h,u,c,l,!0,r,!!d,f,p||null,g,i.frontUVs||null,i.backUVs||null)},e.CreateLathe=function(t,i,r){var n,o=i.arc?i.arc<=0||i.arc>1?1:i.arc:1,h=void 0===i.closed||i.closed,u=i.shape,c=i.radius||1,l=i.tessellation||64,d=i.clip||0,f=i.updatable,p=e._UpdateSideOrientation(i.sideOrientation),g=i.cap||a.a.NO_CAP,m=2*Math.PI,v=new Array,y=i.invertUV||!1,b=0,_=0,x=m/l*o,M=new Array;for(b=0;b<=l-d;b++){M=[];for(g!=a.a.CAP_START&&g!=a.a.CAP_ALL||(M.push(new s.Vector3(0,u[0].y,0)),M.push(new s.Vector3(Math.cos(b*x)*u[0].x*c,u[0].y,Math.sin(b*x)*u[0].x*c))),_=0;_<u.length;_++)n=new s.Vector3(Math.cos(b*x)*u[_].x*c,u[_].y,Math.sin(b*x)*u[_].x*c),M.push(n);g!=a.a.CAP_END&&g!=a.a.CAP_ALL||(M.push(new s.Vector3(Math.cos(b*x)*u[u.length-1].x*c,u[u.length-1].y,Math.sin(b*x)*u[u.length-1].x*c)),M.push(new s.Vector3(0,u[u.length-1].y,0))),v.push(M)}return e.CreateRibbon(t,{pathArray:v,closeArray:h,sideOrientation:p,updatable:f,invertUV:y,frontUVs:i.frontUVs,backUVs:i.backUVs},r)},e.CreatePlane=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreatePlane(i).applyToMesh(n,i.updatable),i.sourcePlane&&(n.translate(i.sourcePlane.normal,-i.sourcePlane.d),n.setDirection(i.sourcePlane.normal.scale(-1))),n},e.CreateGround=function(e,t,i){var r=new y(e,i);return r._setReady(!1),r._subdivisionsX=t.subdivisionsX||t.subdivisions||1,r._subdivisionsY=t.subdivisionsY||t.subdivisions||1,r._width=t.width||1,r._height=t.height||1,r._maxX=r._width/2,r._maxZ=r._height/2,r._minX=-r._maxX,r._minZ=-r._maxZ,v.a.CreateGround(t).applyToMesh(r,t.updatable),r._setReady(!0),r},e.CreateTiledGround=function(e,t,i){var r=new a.a(e,i);return v.a.CreateTiledGround(t).applyToMesh(r,t.updatable),r},e.CreateGroundFromHeightMap=function(e,t,i,n){var a=i.width||10,o=i.height||10,h=i.subdivisions||1,u=i.minHeight||0,c=i.maxHeight||1,l=i.colorFilter||new s.Color3(.3,.59,.11),d=i.alphaFilter||0,f=i.updatable,p=i.onReady,g=new y(e,n);g._subdivisionsX=h,g._subdivisionsY=h,g._width=a,g._height=o,g._maxX=g._width/2,g._maxZ=g._height/2,g._minX=-g._maxX,g._minZ=-g._maxZ,g._setReady(!1);return r.c.LoadImage(t,function(e){var t=document.createElement("canvas"),i=t.getContext("2d");if(!i)throw new Error("Unable to get 2d context for CreateGroundFromHeightMap");if(!n.isDisposed){var r=e.width,s=e.height;t.width=r,t.height=s,i.drawImage(e,0,0);var m=i.getImageData(0,0,r,s).data;v.a.CreateGroundFromHeightMap({width:a,height:o,subdivisions:h,minHeight:u,maxHeight:c,colorFilter:l,buffer:m,bufferWidth:r,bufferHeight:s,alphaFilter:d}).applyToMesh(g,f),p&&p(g),g._setReady(!0)}},function(){},n.offlineProvider),g},e.CreatePolygon=function(t,i,r){i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation);for(var n=i.shape,a=i.holes||[],o=i.depth||0,h=[],u=[],c=0;c<n.length;c++)h[c]=new s.Vector2(n[c].x,n[c].z);h[0].equalsWithEpsilon(h[h.length-1],1e-8)&&h.pop();for(var l=new x(t,h,r),d=0;d<a.length;d++){u=[];for(var f=0;f<a[d].length;f++)u.push(new s.Vector2(a[d][f].x,a[d][f].z));l.addHole(u)}var p=l.build(i.updatable,o);return p._originalBuilderSideOrientation=i.sideOrientation,v.a.CreatePolygon(p,i.sideOrientation,i.faceUV,i.faceColors,i.frontUVs,i.backUVs).applyToMesh(p,i.updatable),p},e.ExtrudePolygon=function(t,i,r){return e.CreatePolygon(t,i,r)},e.CreateTube=function(t,i,r){var n=i.path,o=i.instance,h=1;void 0!==i.radius?h=i.radius:o&&(h=o._creationDataStorage.radius);var u=i.tessellation||64,c=i.radiusFunction||null,l=i.cap||a.a.NO_CAP,d=i.invertUV||!1,f=i.updatable,p=e._UpdateSideOrientation(i.sideOrientation);i.arc=i.arc&&(i.arc<=0||i.arc>1)?1:i.arc||1;var g,m,v=function(e,t,i,r,n,o,h,u){for(var c,l,d,f,p=t.getTangents(),g=t.getNormals(),m=t.getDistances(),v=2*Math.PI/n*u,y=o||function(){return r},b=s.Tmp.Matrix[0],_=h===a.a.NO_CAP||h===a.a.CAP_END?0:2,x=0;x<e.length;x++){l=y(x,m[x]),c=Array(),d=g[x];for(var M=0;M<n;M++)s.Matrix.RotationAxisToRef(p[x],v*M,b),f=c[M]?c[M]:s.Vector3.Zero(),s.Vector3.TransformCoordinatesToRef(d,b,f),f.scaleInPlace(l).addInPlace(e[x]),c[M]=f;i[_]=c,_++}var D=function(t,i){for(var r=Array(),n=0;n<t;n++)r.push(e[i]);return r};switch(h){case a.a.NO_CAP:break;case a.a.CAP_START:i[0]=D(n,0),i[1]=i[2].slice(0);break;case a.a.CAP_END:i[_]=i[_-1].slice(0),i[_+1]=D(n,e.length-1);break;case a.a.CAP_ALL:i[0]=D(n,0),i[1]=i[2].slice(0),i[_]=i[_-1].slice(0),i[_+1]=D(n,e.length-1)}return i};if(o){var y=o._creationDataStorage,b=i.arc||y.arc;return m=v(n,g=y.path3D.update(n),y.pathArray,h,y.tessellation,c,y.cap,b),o=e.CreateRibbon("",{pathArray:m,instance:o}),y.path3D=g,y.pathArray=m,y.arc=b,y.radius=h,o}m=v(n,g=new s.Path3D(n),new Array,h,u,c,l=l<0||l>3?0:l,i.arc);var _=e.CreateRibbon(t,{pathArray:m,closePath:!0,closeArray:!1,updatable:f,sideOrientation:p,invertUV:d,frontUVs:i.frontUVs,backUVs:i.backUVs},r);return _._creationDataStorage.pathArray=m,_._creationDataStorage.path3D=g,_._creationDataStorage.tessellation=u,_._creationDataStorage.cap=l,_._creationDataStorage.arc=i.arc,_._creationDataStorage.radius=h,_},e.CreatePolyhedron=function(t,i,r){var n=new a.a(t,r);return i.sideOrientation=e._UpdateSideOrientation(i.sideOrientation),n._originalBuilderSideOrientation=i.sideOrientation,v.a.CreatePolyhedron(i).applyToMesh(n,i.updatable),n},e.CreateDecal=function(e,t,i){var r=t.getIndices(),n=t.getVerticesData(o.b.PositionKind),h=t.getVerticesData(o.b.NormalKind),u=i.position||s.Vector3.Zero(),c=i.normal||s.Vector3.Up(),l=i.size||s.Vector3.One(),d=i.angle||0;if(!c){var f=new s.Vector3(0,0,1),p=t.getScene().activeCamera,g=s.Vector3.TransformCoordinates(f,p.getWorldMatrix());c=p.globalPosition.subtract(g)}var m=-Math.atan2(c.z,c.x)-Math.PI/2,y=Math.sqrt(c.x*c.x+c.z*c.z),b=Math.atan2(c.y,y),_=s.Matrix.RotationYawPitchRoll(m,b,d).multiply(s.Matrix.Translation(u.x,u.y,u.z)),x=s.Matrix.Invert(_),M=t.getWorldMatrix().multiply(x),D=new v.a;D.indices=[],D.positions=[],D.normals=[],D.uvs=[];for(var V=0,I=function(e){var t=new s.PositionNormalVertex;if(!r||!n||!h)return t;var i=r[e];return t.position=new s.Vector3(n[3*i],n[3*i+1],n[3*i+2]),t.position=s.Vector3.TransformCoordinates(t.position,M),t.normal=new s.Vector3(h[3*i],h[3*i+1],h[3*i+2]),t.normal=s.Vector3.TransformNormal(t.normal,M),t},A=function(e,t){if(0===e.length)return e;for(var i=.5*Math.abs(s.Vector3.Dot(l,t)),r=function(e,r){var n=s.Vector3.GetClipFactor(e.position,r.position,t,i);return new s.PositionNormalVertex(s.Vector3.Lerp(e.position,r.position,n),s.Vector3.Lerp(e.normal,r.normal,n))},n=new Array,a=0;a<e.length;a+=3){var o,h,u,c=null,d=null,f=null,p=null;switch(((o=s.Vector3.Dot(e[a].position,t)-i>0)?1:0)+((h=s.Vector3.Dot(e[a+1].position,t)-i>0)?1:0)+((u=s.Vector3.Dot(e[a+2].position,t)-i>0)?1:0)){case 0:n.push(e[a]),n.push(e[a+1]),n.push(e[a+2]);break;case 1:if(o&&(c=e[a+1],d=e[a+2],f=r(e[a],c),p=r(e[a],d)),h){c=e[a],d=e[a+2],f=r(e[a+1],c),p=r(e[a+1],d),n.push(f),n.push(d.clone()),n.push(c.clone()),n.push(d.clone()),n.push(f.clone()),n.push(p);break}u&&(c=e[a],d=e[a+1],f=r(e[a+2],c),p=r(e[a+2],d)),c&&d&&f&&p&&(n.push(c.clone()),n.push(d.clone()),n.push(f),n.push(p),n.push(f.clone()),n.push(d.clone()));break;case 2:o||(d=r(c=e[a].clone(),e[a+1]),f=r(c,e[a+2]),n.push(c),n.push(d),n.push(f)),h||(d=r(c=e[a+1].clone(),e[a+2]),f=r(c,e[a]),n.push(c),n.push(d),n.push(f)),u||(d=r(c=e[a+2].clone(),e[a]),f=r(c,e[a+1]),n.push(c),n.push(d),n.push(f))}}return n},w=0;w<r.length;w+=3){var T=new Array;if(T.push(I(w)),T.push(I(w+1)),T.push(I(w+2)),T=A(T,new s.Vector3(1,0,0)),T=A(T,new s.Vector3(-1,0,0)),T=A(T,new s.Vector3(0,1,0)),T=A(T,new s.Vector3(0,-1,0)),T=A(T,new s.Vector3(0,0,1)),0!==(T=A(T,new s.Vector3(0,0,-1))).length)for(var S=0;S<T.length;S++){var O=T[S];D.indices.push(V),O.position.toArray(D.positions,3*V),O.normal.toArray(D.normals,3*V),D.uvs.push(.5+O.position.x/l.x),D.uvs.push(.5+O.position.y/l.y),V++}}var P=new a.a(e,t.getScene());return D.applyToMesh(P),P.position=u.clone(),P.rotation=new s.Vector3(b,m,d),P},e._ExtrudeShapeGeneric=function(t,i,r,n,o,h,u,c,l,d,f,p,g,m,v,y,b,_){var x,M,D=function(e,t,i,r,n,o,h,u,c,l){for(var d=i.getTangents(),f=i.getNormals(),p=i.getBinormals(),g=i.getDistances(),m=0,v=l&&u?u:function(){return null!==o?o:0},y=l&&h?h:function(){return null!==n?n:1},b=c===a.a.NO_CAP||c===a.a.CAP_END?0:2,_=s.Tmp.Matrix[0],x=0;x<t.length;x++){for(var M=new Array,D=v(x,g[x]),V=y(x,g[x]),I=0;I<e.length;I++){s.Matrix.RotationAxisToRef(d[x],m,_);var A=d[x].scale(e[I].z).add(f[x].scale(e[I].x)).add(p[x].scale(e[I].y)),w=M[I]?M[I]:s.Vector3.Zero();s.Vector3.TransformCoordinatesToRef(A,_,w),w.scaleInPlace(V).addInPlace(t[x]),M[I]=w}r[b]=M,m+=D,b++}var T=function(e){var t,i=Array(),r=s.Vector3.Zero();for(t=0;t<e.length;t++)r.addInPlace(e[t]);for(r.scaleInPlace(1/e.length),t=0;t<e.length;t++)i.push(r);return i};switch(c){case a.a.NO_CAP:break;case a.a.CAP_START:r[0]=T(r[2]),r[1]=r[2];break;case a.a.CAP_END:r[b]=r[b-1],r[b+1]=T(r[b-1]);break;case a.a.CAP_ALL:r[0]=T(r[2]),r[1]=r[2],r[b]=r[b-1],r[b+1]=T(r[b-1])}return r};if(v){var V=v._creationDataStorage;return x=V.path3D.update(r),M=D(i,r,V.path3D,V.pathArray,n,o,h,u,V.cap,f),v=a.a.CreateRibbon("",M,!1,!1,0,p||void 0,!1,0,v)}M=D(i,r,x=new s.Path3D(r),new Array,n,o,h,u,d=d<0||d>3?0:d,f);var I=e.CreateRibbon(t,{pathArray:M,closeArray:c,closePath:l,updatable:g,sideOrientation:m,invertUV:y,frontUVs:b||void 0,backUVs:_||void 0},p);return I._creationDataStorage.pathArray=M,I._creationDataStorage.path3D=x,I._creationDataStorage.cap=d,I},e}()},9:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function e(){}return e._AddLogEntry=function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)},e._FormatMessage=function(e){var t=function(e){return e<10?"0"+e:""+e},i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+e},e._LogDisabled=function(e){},e._LogEnabled=function(t){var i=e._FormatMessage(t);console.log("BJS - "+i);var r="<div style='color:white'>"+i+"</div><br>";e._AddLogEntry(r)},e._WarnDisabled=function(e){},e._WarnEnabled=function(t){var i=e._FormatMessage(t);console.warn("BJS - "+i);var r="<div style='color:orange'>"+i+"</div><br>";e._AddLogEntry(r)},e._ErrorDisabled=function(e){},e._ErrorEnabled=function(t){e.errorsCount++;var i=e._FormatMessage(t);console.error("BJS - "+i);var r="<div style='color:red'>"+i+"</div><br>";e._AddLogEntry(r)},Object.defineProperty(e,"LogCache",{get:function(){return e._LogCache},enumerable:!0,configurable:!0}),e.ClearLogCache=function(){e._LogCache="",e.errorsCount=0},Object.defineProperty(e,"LogLevels",{set:function(t){(t&e.MessageLogLevel)===e.MessageLogLevel?e.Log=e._LogEnabled:e.Log=e._LogDisabled,(t&e.WarningLogLevel)===e.WarningLogLevel?e.Warn=e._WarnEnabled:e.Warn=e._WarnDisabled,(t&e.ErrorLogLevel)===e.ErrorLogLevel?e.Error=e._ErrorEnabled:e.Error=e._ErrorDisabled},enumerable:!0,configurable:!0}),e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e._LogCache="",e.errorsCount=0,e.Log=e._LogEnabled,e.Warn=e._WarnEnabled,e.Error=e._ErrorEnabled,e}()}});